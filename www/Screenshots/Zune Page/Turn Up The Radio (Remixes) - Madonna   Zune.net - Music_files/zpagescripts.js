(function(c){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var d=function(g){var f="";for(var j=0;j<g.length;j++){var h=g.charCodeAt(j);if(h<128){f+=String.fromCharCode(h)}else{if((h>127)&&(h<2048)){f+=String.fromCharCode((h>>6)|192);f+=String.fromCharCode((h&63)|128)}else{f+=String.fromCharCode((h>>12)|224);f+=String.fromCharCode(((h>>6)&63)|128);f+=String.fromCharCode((h&63)|128)}}}return f};var a=function(f){var g="";var h=0;var j=c1=c2=0;while(h<f.length){j=f.charCodeAt(h);if(j<128){g+=String.fromCharCode(j);h++}else{if((j>191)&&(j<224)){c2=f.charCodeAt(h+1);g+=String.fromCharCode(((j&31)<<6)|(c2&63));h+=2}else{c2=f.charCodeAt(h+1);c3=f.charCodeAt(h+2);g+=String.fromCharCode(((j&15)<<12)|((c2&63)<<6)|(c3&63));h+=3}}}return g};c.extend({base64Encode:function(h){var f="";var q,o,l,p,m,k,j;var g=0;h=d(h);while(g<h.length){q=h.charCodeAt(g++);o=h.charCodeAt(g++);l=h.charCodeAt(g++);p=q>>2;m=((q&3)<<4)|(o>>4);k=((o&15)<<2)|(l>>6);j=l&63;if(isNaN(o)){k=j=64}else{if(isNaN(l)){j=64}}f=f+b.charAt(p)+b.charAt(m)+b.charAt(k)+b.charAt(j)}return f},base64Decode:function(h){var f="";var q,o,l;var p,m,k,j;var g=0;h=h.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(g<h.length){p=b.indexOf(h.charAt(g++));m=b.indexOf(h.charAt(g++));k=b.indexOf(h.charAt(g++));j=b.indexOf(h.charAt(g++));q=(p<<2)|(m>>4);o=((m&15)<<4)|(k>>2);l=((k&3)<<6)|j;f=f+String.fromCharCode(q);if(k!=64){f=f+String.fromCharCode(o)}if(j!=64){f=f+String.fromCharCode(l)}}f=a(f);return f}})})(jQuery);var __ap=Array.prototype;__ap.add=__ap.queue=function(a){this.push(a)};__ap.addRange=function(a){if(a){this.push.apply(this,a)}return this};__ap.clear=function(){if(this.length>0){this.splice(0,this.length)}};__ap.clone=function(){return[].addRange(this)};__ap.contains=__ap.exists=function(b){var a=this.indexOf(b);return(a>=0)};__ap.dequeue=Array.prototype.shift;if(!__ap.indexOf){__ap.indexOf=function(c,d){var b=this.length;if(b!=0){d=d||0;if(d<0){d=Math.max(0,b+d)}for(var a=d;a<b;a++){if(this[a]==c){return a}}}return -1}}if(!__ap.forEach){__ap.forEach=function(b,d){var c=this.length;for(var a=0;a<c;a++){b.call(d,this[a],a,this)}}}__ap.insert=function(a,b){this.splice(a,0,b)};__ap.remove=function(b){var a=this.indexOf(b);if(a>=0){this.splice(a,1)}return(a>=0)};__ap.removeAt=function(a){return this.splice(a,1)[0]};__ap.trim=function(){if(this.length>0){while(this[0]==""){this.shift()}while(this[this.length-1]==""){this.pop()}}};var __sp=String.prototype;__sp.endsWith=function(a){return(this.substr(this.length-a.length)==a)};__sp.startsWith=function(a){return(this.substr(0,a.length)==a)};__sp.lTrim=__sp.trimStart=function(){return this.replace(/^\s*/,"")};__sp.rTrim=__sp.trimEnd=function(){return this.replace(/\s*$/,"")};__sp.trim=function(){return this.trimStart().trimEnd()};__sp.removeLastSentence=function(){return this.replace(/([.,?!]) [^.,?!]*$/,"$1")};__sp.format=function(){var c=this;var a=__sp.format.aRegExp;var d=arguments.length;for(var b=0;b<d;b++){if(!a[b]){a[b]=new RegExp("\\{"+b+"\\}","g")}c=c.replace(a[b],arguments[b])}return(c)};__sp.format.aRegExp=[];__sp.expandTokens=function(b){function a(d,c){return b[c]}return this.replace(/\{([A-Za-z]\w*)\}/g,a)};String.isEmpty=function(a){return Object.isNull(a)||""==a};__sp.removeSpaces=function(){return this.replace(/ /gi,"")};__sp.removeExtraSpaces=function(){return(this.replace(__sp.removeExtraSpaces.re," "))};__sp.removeExtraSpaces.re=new RegExp("\\s+","g");__sp.removeSpaceDelimitedString=function(b){var a=" "+this.trim()+" ";return a.replace(" "+b+" "," ").trim()};__sp.addSpaceDelimitedString=function(a){return this.removeSpaceDelimitedString(a)+" "+a};__sp.encodeURI=function(){return encodeURIComponent(this)};__sp.encodeHtml=function(){return this.replace(/\&/g,"&amp;").replace(/\>/g,"&gt;").replace(/\</g,"&lt;").replace(/\'/g,"&#039;").replace(/\"/g,"&quot;")};__sp.encodeHtml2=function(){return this.replace(/\&/g,"&amp;").replace(/\>/g,"&gt;").replace(/\</g,"&lt;")};__sp.decodeURI=function(){return unescape(this)};String._typeName="String";function trim(b){var a="";if(!(undefined==b)){a=b.toString().replace(/^\s*|\s*$/g,"")}return a}var debug=false;function lxtrace(){}function traceline(){}function Ajax(g,f,d){var b=(window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"));var c=this;this.httpRequest=b;this.callback=g;this.div=f;this.xkey=d;b.onreadystatechange=function(){Ajax.OnReceiveResponse.call(c)};function a(){c.timerid=null;if(c.div.LxOnAjaxStart){c.div.LxOnAjaxStart()}else{Ajax.ShowStockBusyMessage(c.div)}}if(this.div){this.timerid=window.setTimeout(a,500)}}Ajax.protocol={sourceUrl:"lx-ajax-source",authUrl:"lx-ajax-auth-url",status:"lx-ajax-status",redirection:"lx-ajax-location",errInline:"error/inline"};Ajax.PendingFragments=[];Ajax.GetAsync=function(b,f,a,j,d){var h=new Ajax(j,a,d);var c=h.httpRequest;var k=(/\?/.test(b))?"&":"?";var g=b+k+(((typeof f)=="string")?f:Ajax.FormEncode(f));if(!h.ConcurrencyCheck()){window.clearTimeout(h.timerid);h.timerid=null;return null}c.open("GET",g,true);h.AddSourceUrl();c.send(null);return h};Ajax.PostAsyncWithSilentLoad=function(a,b,f,d,c){if(f){f.LxOnAjaxStart=function(){}}Ajax.PostAsync(a,b,f,d,c)};Ajax.PostAsync=function(c,d,j,h,g){var f=new Ajax(h,j,g);var b=f.httpRequest;var a=((typeof d)=="string")?d:Ajax.FormEncode(d);if(!f.ConcurrencyCheck()){window.clearTimeout(f.timerid);f.timerid=null;return null}b.open("POST",c,true);b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");f.AddSourceUrl();b.send(a);return f};Ajax.prototype.ConcurrencyCheck=function(){return Ajax.DoConcurrencyCheck(this.xkey,this.div)};Ajax.DoConcurrencyCheck=function(a,b){if(!a){return true}if(Ajax.PendingFragments.contains(a)){Ajax.ShowErrorString(LocStr.lxUtilResources.AjaxAlreadyInProgress,b);return false}Ajax.PendingFragments.push(a);return true};Ajax.prototype.AddSourceUrl=function(){this.httpRequest.setRequestHeader(Ajax.protocol.sourceUrl,window.location.href)};Ajax.OnReceiveResponse=function(){var c=this.httpRequest;if(c.readyState==4){if(this.timerid){window.clearTimeout(this.timerid);this.timerid=null}try{var f=c.getResponseHeader("Content-Type");var b=c.getResponseHeader(Ajax.protocol.status);var d=c.getResponseHeader(Ajax.protocol.redirection);if(b){b=b.decodeURI()}var a=c.responseText;Ajax.PendingFragments.remove(this.xkey);if(this.div&&this.div.LxOnAjaxFinish){this.div.LxOnAjaxFinish(b,this)}switch(c.status){case 401:case 441:window.location=c.getResponseHeader(Ajax.protocol.authUrl);return;case 200:if(d!=null&&d!=""){window.location=d;return}if(!b||!/error/.test(b)){Ajax.DismissError(this.div);break}default:if(b==Ajax.protocol.errInline){if(f.indexOf("html")>=0){Ajax.ShowErrorPage(a,this.div)}else{Ajax.ShowErrorString(LocStr.lxUtilResources.AjaxInternalError,this.div)}}else{Ajax.ShowStockError(this.div)}return}if(f&&f.indexOf("application/json")>=0){a=a.parseJSON()}if(this.callback){this.callback(b,a)}}finally{c.onreadystatechange=function(){};this.httpRequest=null;this.div=null;this.xkey=null;this.callback=null}}};Ajax.FormEncode=function(c){var f;for(var b in c){var d=c[b];if(d){var a=b+"="+d.encodeURI();if(f){f+="&"+a}else{f=a}}}return f};Ajax.PostToIframe=function(b,f,c){var a=document.getElementsByName(b.target)[0];if(!Ajax.DoConcurrencyCheck(c,b)){return}a.lxCallback=f;a.lxXkey=c;try{b.submit()}catch(d){Ajax.PendingFragments.remove(c);throw d}if(a.LxOnAjaxStart){a.LxOnAjaxStart()}else{Ajax.ShowStockBusyMessage(a)}};Ajax.OnCompleteIframe=function(c){Ajax.PendingFragments.remove(c.lxXkey);var h=c.lxCallback;c.lxCallback=null;if(!h){return}if(c.LxOnAjaxFinish){c.LxOnAjaxFinish()}var g;try{g=c.contentWindow.document}catch(f){Ajax.ShowStockError(c);return}var a=g.forms;if(a.length==0||a[0].id!="LxAjaxResult"){if(g.body.innerHTML.indexOf("LxAjaxInlineError")>=0){Ajax.ShowErrorPage(g.body.innerHTML,c)}else{Ajax.ShowStockError(c)}return}var d={};for(var b=0;b<a[0].elements.length;b++){var f=a[0].elements[b];if(f.tagName=="INPUT"){d[f.name]=f.value}}Ajax.DismissError(c);h(d)};Ajax.ShowStockBusyMessage=function(b){var a='<div id="LxAjaxBusyMessage">';a+=LocStr.lxUtilResources.AjaxBusyMessage;a+="</div>";Ajax.ShowErrorPage(a,b)};Ajax.ShowStockError=function(a){Ajax.ShowErrorString(LocStr.lxUtilResources.AjaxGeneralError,a)};Ajax.ShowErrorString=function(b,c){var a='<div id="LxAjaxInlineError">';a+=b;a+="</div>";Ajax.ShowErrorPage(a,c)};Ajax.ShowErrorPage=function(c,g){var a;var f=g;if(g==null){return}if(f){var d=f.getElementsByTagName("DIV");for(var b=0;b<d.length;b++){if(d[b].id=="ajaxErr"){a=d[b];break}}f=f.parentNode}while(f&&!a){var d=f.childNodes;for(var b=0;b<d.length;b++){if(d[b].id=="ajaxErr"){a=d[b];break}}f=f.parentNode}if(a){a.style.display="";a.innerHTML=getHtmlInsideBody(c)}else{alert("The request has failed but error message could not be displayed.");return}};Ajax.DismissError=function(a){var d=a;while(d){var c=d.childNodes;for(var b=0;b<c.length;b++){if(c[b].id=="ajaxErr"){c[b].style.display="none";return}}d=d.parentNode}};function getHtmlInsideBody(d){if(!/<html\b/.test(d)){return d}var b=d.split("\n");var g=false;var f="";for(var c=0;c<b.length;c++){var a=b[c];if(g){if(/<\/body\b/.test(a)){g=false}else{f+=a}}else{if(!g&&/<body\b/.test(a)){g=true}}}return f}Ajax.RefreshOnTrigger=function(b,a,c,d){b.subscribe(function(){Ajax.FragmentHttpGet(a,c,d)})};Ajax.FragmentHttpGet=function(a,b,f){var d=getEl(f);var c={baseid:b};return Ajax.MakeRequest(a,d,c,d,false)};Ajax.FragmentPostBack=function(b,h,l,d,j){var a=getEl(l);var c=getOwnerForm(l);var g={};g.__EVENTTARGET=d;g.__EVENTARGUMENT="null";g.baseId=h;for(var f=0;f<c.elements.length;f++){var k=c.elements[f];if(k.value&&k.id&&k.type!="button"&&k.type!="submit"&&!k.disabled&&k.name.startsWith(h)){if(k.id.match(/_viewstate/i)){}else{if(k.id.match(/valid/i)){}else{if(k.type=="checkbox"&&!k.checked){}else{g[k.name]=k.value}}}}}return Ajax.MakeRequest(b,a,g,j,true)};Ajax.MakeRequest=function(url,div,body,actionObj,isPost){function callback(status,result){div.innerHTML=result;evalJS(div);if("undefined"!=typeof $Bindings){$Bindings.reinitall($(div))}}function startAnimation(){var script=actionObj.attributes.OnAjaxStart;if(script){if(script.value){eval(script.value)}else{Ajax.ShowStockBusyMessage(actionObj)}}}function endAnimation(){div.LxOnAjaxStart=null;div.LxOnAjaxFinish=null;var script=actionObj.attributes.OnAjaxFinish;if(script){if(script.value){eval(script.value)}else{Ajax.DismissError(actionObj)}}}if(actionObj&&!div.LxOnAjaxStart){actionObj=getEl(actionObj);div.LxOnAjaxStart=startAnimation;div.LxOnAjaxFinish=endAnimation}if(isPost){return Ajax.PostAsync(url,body,div,callback,div)}else{return Ajax.GetAsync(url,body,div,callback,div)}};function evalJS(element){var scriptList=element.getElementsByTagName("SCRIPT");var x;for(x=0;x<scriptList.length;x++){eval(removeJSComments(scriptList[x].innerHTML))}}function removeJSComments(a){return a.replace("<!--","").replace("-->","")}(function(s){var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};s.parseJSON=function(filter){var j;function walk(k,v){var i;if(v&&typeof v==="object"){for(i in v){if(Object.prototype.hasOwnProperty.apply(v,[i])){v[i]=walk(i,v[i])}}}return filter(k,v)}if(/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/.test(this.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,""))){j=eval("("+this+")");return typeof filter==="function"?walk("",j):j}throw new SyntaxError("parseJSON")}})(String.prototype);function isMozilla(){return(window.addEventListener!=null)}function isIE(){return(window.attachEvent!=null)}var Event={add:function(d,b,c,a){a=a||false;if(isMozilla()){d.addEventListener(b,c,a)}else{if(isIE()){d.attachEvent("on"+b,c)}else{return false}}},remove:function(d,b,c,a){a=a||false;if(isMozilla()){d.removeEventListener(b,c,a)}else{if(isIE()){d.detachEvent("on"+b,c)}else{return false}}},unify:function(a){a=a?a:window.event;if(a.srcElement){a.target=a.srcElement}if(!a.preventDefault){a.preventDefault=function(){this.returnValue=false}}if(!a.stopPropagation){a.stopPropagation=function(){if(window.event){window.event.cancelBubble=true}}}return a}};function doNothing(){}function getOwnerForm(b){var a=getEl(b);while(a&&a.tagName!="FORM"){a=a.parentNode}return a}function getEl(a){if(typeof a=="object"){return a}else{return document.getElementById(a)}}function getFlashObj(a){var b=window[a];if(!b){b=document[a]}return b}function setFlashObj(){if(isIE()){var a=document.getElementsByTagName("object");for(i=0;i<a.length;i++){if(a[i].classid=="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"){window[a[i].id]=a[i]}}}}function checkMaxLength(d,f){var a=d.getAttribute?parseInt(d.getAttribute("max")):-1;var c=d.value.length;if(-1<a&&c>a){d.value=d.value.substring(0,a);c=a}var b=getEl(f);if(b){if(b.innerText){b.innerText=c}else{b.innerHTML=c}}}function setFocus(b,a){setTimeout(function(){var c=getEl("popupTextArea");if(c){c.focus()}},a)}function reloadPage(){window.location.reload()}function refreshPage(){window.location=window.location}function toggleEl(c,b){var a=getEl(c);if(b==undefined){b="hide"}if(a!=null){css.toggle(a,b)}}function getWindowSize(){var c={};var b=0;var a=0;if(typeof(window.innerWidth)=="number"){b=window.innerWidth;a=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){b=document.documentElement.clientWidth;a=document.documentElement.clientHeight}else{b=document.body.clientWidth;a=document.body.clientHeight}}c={x:b,y:a};return c}function centerElement(c){var a={};var f=10;var g=10;var b=document.body.clientWidth;var j=document.body.clientHeight;var k=c.offsetHeight;var d=c.offsetWidth;var l=(b/2)-(d/2);var h=(j/2)-(k/2);l=(l<g)?g:l;h=(h<f)?f:h;a={x:l,y:h};return a}function urlEncode(a){return(a)?escape(a).replace("+","%2b"):""}function getOpacityCSS(a){var b="";if(isMozilla()){b="opacity:"+a/100+";"}else{b="filter:alpha(opacity:"+a+");"}return b}function element(c){if(c&&c.tagName){var k=function(){try{var m;for(m=0;m<f.length;m++){try{a[f[m]]=null}catch(l){}}}catch(l){}};var a=document.createElement(c.tagName);var f=[];var j="".constructor;var d=9;var b=d.constructor;for(var g in c){if(g!="src"&&c[g].constructor!=j&&c[g].constructor!=b){f.push(g)}try{a[g]=c[g]}catch(h){}}return a}}function getPageOffsets(a){a=getEl(a);var c=a.offsetLeft;var b=a.offsetTop;if(a.offsetParent&&a.offsetParent.clientLeft||a.offsetParent.clientTop){c+=a.offsetParent.clientLeft;b+=a.offsetParent.clientTop}while(a=a.offsetParent){c+=a.offsetLeft;b+=a.offsetTop}return{x:c,y:b}}function getViewAreaHeight(){var b=document.getElementsByTagName("BODY")[0];var a=getViewportHeight();return(a>b.scrollHeight)?a:b.scrollHeight}function getViewAreaWidth(){var a=document.getElementsByTagName("BODY")[0];var b=getViewportWidth();return maskWidth=(b>a.scrollWidth)?b:a.scrollWidth}function getViewportHeight(){if(window.innerHeight!=window.undefined){return window.innerHeight}if(document.compatMode=="CSS1Compat"){return document.documentElement.clientHeight}if(document.body){return document.body.clientHeight}return window.undefined}function getViewportWidth(){if(window.innerWidth!=window.undefined){return window.innerWidth}if(document.compatMode=="CSS1Compat"){return document.documentElement.clientWidth}if(document.body){return document.body.clientWidth}return window.undefined}function getScrollTop(){if(self.pageYOffset){return self.pageYOffset}else{if(document.documentElement&&document.documentElement.scrollTop){return document.documentElement.scrollTop}else{if(document.body){return document.body.scrollTop}}}}function getScrollLeft(){if(self.pageXOffset){return self.pageXOffset}else{if(document.documentElement&&document.documentElement.scrollLeft){return document.documentElement.scrollLeft}else{if(document.body){return document.body.scrollLeft}}}}function findElementInCollection(b,a){for(i=0;i<b.length;i++){if(b[i].id==a){return b[i]}}return null}function SetElementValue(b,a){var c=document.getElementById(b);if(null!=c){c.value=a}else{alert("Element "+b+" not found.")}}function GetElementValue(b){var a="";var c=document.getElementById(b);if(null!=c){a=c.value}return a}function setElementHTML(c,b){var a=document.getElementById(c);if(null!=a){a.innerHTML=b}}function clickElement(b){elToClick=getEl(b);if(elToClick){if(isIE()){elToClick.fireEvent("onclick")}else{var a=window.document.createEvent("MouseEvent");a.initEvent("click",false,true);elToClick.dispatchEvent(a)}}}function hideElement(a){document.getElementById(a).style.display="none"}function showElement(a){document.getElementById(a).style.display=""}window.lxonload=function(a){Event.add(window,"load",a)};function registerFocusOnLoad(b){var a=getEl(b);if(a){window.lxonload(function(){a.focus()})}}function showNextSibling(b){var a=b.nextSibling;if(a&&!a.style){a=a.nextSibling}if(a&&a.style){a.style.display="";b.style.display="none"}return false}function showPreviousSibling(b){var a=b.previousSibling;if(a&&!a.style){a=a.previousSibling}if(a&&a.style){a.style.display="";b.style.display="none"}return false}function findPosition(d){var g=0;var f=0;var a=0;var c=0;g=d.offsetTop;f=d.offsetLeft;c=d.offsetWidth;a=d.offsetHeight;try{while(d=d.offsetParent){g+=d.offsetTop;f+=d.offsetLeft}}catch(b){}return{top:g,left:f,width:c,height:a}}function copyToClipboard(a){if(window.clipboardData&&clipboardData.setData){clipboardData.setData("Text",getEl(a).value)}}var browser={classify:function(b){var a=b.match(/MSIE (\d+)\./);if(a){this.ver=parseInt(a[1]);if(this.ver>=7){return"ie7"}else{if(this.ver==6){return"ie6"}else{return"ie0"}}}a=b.match(/Firefox\/(\d+)\.(\d+)/);if(a){this.ver=parseInt(a[1]);if(this.ver>=2){return"ff2"}else{return"ff0"}}this.ver=0;return"other"},init:function(b){var a=this.classify(b);this.type=a;this.isIE=(a.substr(0,2)=="ie");this.isFF=(a.substr(0,2)=="ff");this.isIE6above=(this.isIE&&this.ver>=6);this.isIE7above=(this.isIE&&this.ver>=7);this.isFF2above=(this.isFF&&this.ver>=2);this.slideAnimation=(this.isIE6above||this.isFF2above);this.richEditor=(this.isIE6above||this.isFF2above);this.useClipboard=this.isIE6above;this.loseCaret=this.isIE6above}};browser.init(navigator.userAgent);function ImagePreloader(a,c){this.callback=c;this.numLoaded=0;this.numProcessed=0;this.imageList=new Array;this.numImages=a.length;for(var b=0;b<a.length;b++){this.preload(a[b])}}ImagePreloader.prototype.preload=function(b){var a=new Image;this.imageList.push(a);a.onload=ImagePreloader.prototype.onload;a.onerror=ImagePreloader.prototype.onerror;a.onabort=ImagePreloader.prototype.onabort;a.imgPreloader=this;a.isLoaded=false;a.src=b};ImagePreloader.prototype.onComplete=function(){this.numProcessed++;if(this.numProcessed==this.numImages&&this.callback){this.callback(this.imageList,this.numLoaded)}};ImagePreloader.prototype.onload=function(){this.isLoaded=true;this.imgPreloader.numLoaded++;this.imgPreloader.onComplete()};ImagePreloader.prototype.onerror=function(){this.isError=true;this.imgPreloader.onComplete()};ImagePreloader.prototype.onabort=function(){this.isAbort=true;this.imgPreloader.onComplete()};var more={default_limit:300,default_maxLines:5,default_minCharsPerLine:30,default_moreLiteral:LocStr.lxUtilResources.MoreLiteral,default_lessLiteral:LocStr.lxUtilResources.LessLiteral,truncateLength:function(h,g,d){if(!g){g=more.default_limit}if(!d){if(g<=more.default_limit){d=more.default_maxLines}else{d=g/more.default_minCharsPerLine}}if(h.tagName.toLowerCase()=="a"){h=h.parentNode}var j=h.temp;if(j==null){j=h.innerHTML;j=j.replace(/\s+$/,"");j=j.replace(/\s+/g," ");if(j.length<=g){return}h.temp=j}var f=j.match(/<[^<>]+>/g);var b=j.replace(/<[^>]+>/g,"<>");if(b.length<=g){return}b=b.substring(0,g).removeLastSentence();b=b.replace(/<$/,"");var c=0;var a=[];b=b.replace(/<>/g,function(p,o,m,k){var l=f.shift();if(l.match(/^<br\s*\/?>$/i)){c++;if(c>d){l="#ZZZ!"}}else{if(l.match(/^<\/.*>$/)){l=a.pop().replace("<","</")}else{if(!l.match(/\/>$/)){a.push(l)}}}return l});while(a.length>0){b+=a.pop().replace("<","</")}b=b.replace(/#ZZZ!.*/,"");h.innerHTML=b+this.restore_link(g,d)},truncate:function(c,b,a){this.truncateLength(c,b,a)},restore:function(c,b,a){if(c.tagName.toLowerCase()=="a"){c=c.parentNode}c.innerHTML=c.temp+this.truncate_link(b,a)},truncate_link:function(b,a,c){if(!c){c=more.default_lessLiteral}return' <a class="MoreLess" href="javascript:" onclick="more.truncateLength(this, '+b+", "+a+');">'+c+"</a>"},restore_link:function(b,a,c){if(!c){c=more.default_moreLiteral}return' <a class="MoreLess" href="javascript:" onclick="more.restore(this, '+b+", "+a+');">'+c+"</a>"}};function ProcessTimes(b){if(!b){b=dateFormat}var f=document.getElementsByName("timeFormat");for(x=0;x<f.length;x++){var c=f[x];var a=GetUtcDate(c);var d=GetDateFormat(c);c.innerHTML=b(a,d)}}function GetUtcDate(a){var c=new Date(a.getAttribute("utcDateTime"));var b=new Date();b.setUTCFullYear(c.getFullYear());b.setUTCMonth(c.getMonth());b.setUTCDate(c.getDate());b.setUTCHours(c.getHours());b.setUTCMinutes(c.getMinutes());b.setUTCSeconds(c.getSeconds());return b}function GetDate(a){var b=new Date();b.setUTCFullYear(a.getAttribute("utcYear"));b.setUTCMonth(a.getAttribute("utcMonth"));b.setUTCDate(a.getAttribute("utcDay"));if(a.getAttribute("utcHours")){b.setUTCHours(a.getAttribute("utcHours"));if(a.getAttribute("utcMinutes")){b.setUTCMinutes(a.getAttribute("utcMinutes"))}if(a.getAttribute("utcSeconds")){b.setUTCSeconds(a.getAttribute("utcSeconds"))}}return b}function GetDateFormat(a){return a.getAttribute("format")}function CommentTimeFormatter(a){return DateTimeFormatter(a,LocStr.lxUtilResources.CommentDateFormat)}function MessageTimeFormatter(a){return DateTimeFormatter(a,LocStr.lxUtilResources.MessageDateFormat)}function DateTimeFormatter(c,d){var a=c.getHours();var b=LocStr.lxUtilResources.DateAM;if(a==0){a=12}else{if(a==12){b=LocStr.lxUtilResources.DatePM}else{if(a>12){a=a-12;b=LocStr.lxUtilResources.DatePM}}}return d.replace(/ /g,"&nbsp;").format(c.getFullYear(),(c.getMonth()+1),c.getDate(),c.getHours(),a,appendLeadingZero(c.getMinutes(),2),appendLeadingZero(c.getSeconds(),2),b)}function appendLeadingZero(d,c){d=String(d);var b="";var a;for(a=d.length;a<c;a++){b+="0"}return b+d}var dateFormat=function(){var a=/bbbb|d{1,4}|M{1,4}|yy(?:yy)?|([HhmsTt])\1?|"[^"]*"|'[^']*'/g,b=function(d,c){d=String(d);c=parseInt(c)||2;while(d.length<c){d="0"+d}return d};today=function(d){var c=new Date();if(c.getFullYear()==d.getFullYear()&&c.getMonth()==d.getMonth()&&c.getDate()==d.getDate()){return LocStr.lxUtilResources.TodayAt}if(c.getFullYear()==d.getFullYear()&&c.getMonth()==d.getMonth()&&c.getDate()==d.getDate()+1){return LocStr.lxUtilResources.YesterdayAt}return""};return function(j,r){var f=dateFormat;r=r||LocStr.lxUtilResources.DefaultDateTimeFormat;if(r.indexOf("bbbb")>=0){var t=r.split("|");if(today(j)==""){r=t[0]}else{r=t[1]}}var l=j.getDate(),c=j.getDay(),k=j.getMonth(),o=j.getFullYear(),p=j.getHours(),h=j.getMinutes(),q=j.getSeconds(),g={d:l,dd:b(l),ddd:f.i18n.dayNames[c],dddd:f.i18n.dayNames[c+7],M:k+1,MM:b(k+1),MMM:f.i18n.monthNames[k],MMMM:f.i18n.monthNames[k+12],yy:String(o).slice(2),yyyy:o,h:p%12||12,hh:b(p%12||12),H:p,HH:b(p),m:h,mm:b(h),s:q,ss:b(q),tt:p<12?LocStr.lxUtilResources.DateAM:LocStr.lxUtilResources.DatePM,TT:p<12?LocStr.lxUtilResources.DateAM:LocStr.lxUtilResources.DatePM,bbbb:today(j)};return r.replace(a,function(d){return(d in g)?g[d]:d.slice(1,d.length-1)})}}();dateFormat.i18n={dayNames:LocStr.lxUtilResources.DayNames.split(","),monthNames:LocStr.lxUtilResources.MonthNames.split(",")};var ns=document.layers;var ie=document.all;var ns6=document.getElementById&&!document.all;var isMenu=false;var menuSelObj=null;var overpopupmenu=false;var LxCurrentPopup=null;if(ns){document.captureEvents(Event.MOUSEMOVE);document.onmousemove=captureMousePosition}else{if(ns6||ie){document.onmousemove=captureMousePosition}}xMousePos=0;yMousePos=0;xMousePosMax=0;yMousePosMax=0;function captureMousePosition(a){if(ns){xMousePos=a.pageX;yMousePos=a.pageY;xMousePosMax=window.innerWidth+window.pageXOffset;yMousePosMax=window.innerHeight+window.pageYOffset}else{if(ie){xMousePos=event.clientX+document.documentElement.scrollLeft;yMousePos=event.clientY+document.documentElement.scrollTop;xMousePosMax=document.documentElement.clientWidth+document.documentElement.scrollLeft;yMousePosMax=document.documentElement.clientHeight+document.documentElement.scrollTop}else{if(ns6){xMousePos=a.clientX+document.documentElement.scrollLeft;yMousePos=a.clientY+document.documentElement.scrollTop;xMousePosMax=window.innerWidth+window.pageXOffset;yMousePosMax=window.innerHeight+window.pageYOffset}}}}function showElementAtMouse(c,d,f){var a=xMousePos+d;var g=yMousePos+f;if(ns6){var b=getEl("XbcShell");if(b){a-=b.offsetLeft;g-=b.offsetTop}document.getElementById(c).style.left=a+"px";document.getElementById(c).style.top=g+"px"}else{document.getElementById(c).style.pixelLeft=a;document.getElementById(c).style.pixelTop=g}document.getElementById(c).style.display="";LxCurrentPopup=c}function mouseSelect(a){if(null!=LxCurrentPopup){if(overpopupmenu==false){document.getElementById(LxCurrentPopup).style.display="none";LxCurrentPopup=null;return true}}return true}var g_ImageCropSelection;function ImageCropReset(b,a){if(g_ImageCropSelection!=null){g_ImageCropSelection.image.src="/xweb/lx/pic/white1x1.gif";g_ImageCropSelection.image.style.width=b+"px";g_ImageCropSelection.image.style.height=a+"px";ImageCropCancel()}}function ImageCropCancel(){if(g_ImageCropSelection!=null){Event.remove(document,"mousedown",onMouseDown,false);Event.remove(document,"mousemove",onMouseMove,false);Event.remove(document,"mouseup",onMouseUp,false);if(g_ImageCropSelection.parentNode!=null){g_ImageCropSelection.parentNode.removeChild(g_ImageCropSelection.maskTop);g_ImageCropSelection.parentNode.removeChild(g_ImageCropSelection.maskBottom);g_ImageCropSelection.parentNode.removeChild(g_ImageCropSelection.maskLeft);g_ImageCropSelection.parentNode.removeChild(g_ImageCropSelection.maskRight);g_ImageCropSelection.parentNode.removeChild(g_ImageCropSelection)}g_ImageCropSelection=null}}function ImageCropChanged(){if(g_ImageCropSelection!=null){if(g_ImageCropSelection.maskTop==null){g_ImageCropSelection.maskTop=document.createElement("DIV");g_ImageCropSelection.image.parentNode.appendChild(g_ImageCropSelection.maskTop);g_ImageCropSelection.maskBottom=document.createElement("DIV");g_ImageCropSelection.image.parentNode.appendChild(g_ImageCropSelection.maskBottom);g_ImageCropSelection.maskLeft=document.createElement("DIV");g_ImageCropSelection.image.parentNode.appendChild(g_ImageCropSelection.maskLeft);g_ImageCropSelection.maskRight=document.createElement("DIV");g_ImageCropSelection.image.parentNode.appendChild(g_ImageCropSelection.maskRight);g_ImageCropSelection.maskTop.className="LxCropMask";g_ImageCropSelection.maskBottom.className="LxCropMask";g_ImageCropSelection.maskLeft.className="LxCropMask";g_ImageCropSelection.maskRight.className="LxCropMask"}var a=getImagePos(g_ImageCropSelection.image);g_ImageCropSelection.maskTop.style.top=a.top+"px";g_ImageCropSelection.maskTop.style.left=a.left+"px";g_ImageCropSelection.maskTop.style.width=a.width+"px";g_ImageCropSelection.maskTop.style.height=(g_ImageCropSelection.offsetTop-a.top)+"px";g_ImageCropSelection.maskBottom.style.top=(g_ImageCropSelection.offsetTop+g_ImageCropSelection.offsetHeight)+"px";g_ImageCropSelection.maskBottom.style.left=a.left+"px";g_ImageCropSelection.maskBottom.style.width=a.width+"px";g_ImageCropSelection.maskBottom.style.height=(a.top+a.height)-(g_ImageCropSelection.offsetTop+g_ImageCropSelection.offsetHeight)+"px";g_ImageCropSelection.maskLeft.style.top=g_ImageCropSelection.offsetTop+"px";g_ImageCropSelection.maskLeft.style.left=a.left+"px";g_ImageCropSelection.maskLeft.style.width=(g_ImageCropSelection.offsetLeft-a.left)+"px";g_ImageCropSelection.maskLeft.style.height=g_ImageCropSelection.offsetHeight+"px";g_ImageCropSelection.maskRight.style.top=g_ImageCropSelection.offsetTop+"px";g_ImageCropSelection.maskRight.style.left=(g_ImageCropSelection.offsetLeft+g_ImageCropSelection.offsetWidth)+"px";g_ImageCropSelection.maskRight.style.width=(a.left+a.width)-(g_ImageCropSelection.offsetLeft+g_ImageCropSelection.offsetWidth)+"px";g_ImageCropSelection.maskRight.style.height=g_ImageCropSelection.offsetHeight+"px"}}function ImageCropShow(){if(g_ImageCropSelection){g_ImageCropSelection.style.display=""}}function ImageCropHide(){if(g_ImageCropSelection){g_ImageCropSelection.style.display="none"}}function ImageCropInit(c,j,f){ImageCropCancel();var g=document.getElementById(c);g.style.width="";g.style.height="";g.style.position="absolute";g.style.top="10000px";g.style.left="10000px";var b=false;if(g.readyState){b=g.readyState=="complete"}else{if(g.isLoading){var h=findPosition(g);b=g.complete&&h.width>1&&h.height>1}else{g.isLoading=true}}if(b){g.isLoading=false;var h=findPosition(g);g.ratio=h.width/h.height;if(h.width>h.height){g.maxSizeRatio=h.width/j;g.style.width=j+"px";g.style.height=j/g.ratio+"px"}else{g.maxSizeRatio=h.height/j;g.style.height=j+"px";g.style.width=j*g.ratio+"px"}g.style.position="";h=getImagePos(g);var d=j;var a=d/f;if(h.width<d){d=h.width;a=d/f}if(h.height<a){a=h.height;d=a*f}g_ImageCropSelection=document.createElement("DIV");g.parentNode.appendChild(g_ImageCropSelection);g_ImageCropSelection.className="LxSelection";g_ImageCropSelection.image=g;g_ImageCropSelection.dragging=false;g_ImageCropSelection.offsetX=0;g_ImageCropSelection.offsetY=0;g_ImageCropSelection.ratio=d/a;if(d>h.width-6){d=h.width-6;a=d/g_ImageCropSelection.ratio}if(a>h.height-6){a=h.height-6;d=a*g_ImageCropSelection.ratio}g_ImageCropSelection.style.width=d+"px";g_ImageCropSelection.style.height=a+"px";g_ImageCropSelection.style.top=h.top+"px";g_ImageCropSelection.style.left=h.left+"px";ImageCropChanged();Event.add(document,"mousedown",onMouseDown,false);Event.add(document,"mousemove",onMouseMove,false);Event.add(document,"mouseup",onMouseUp,false)}else{setTimeout(function(){ImageCropInit(c,j,f)},100)}}function getImagePos(d){var g=0;var f=0;var b=0;var c=0;g=d.offsetTop;f=d.offsetLeft;c=d.offsetWidth;b=d.offsetHeight;var a=d.offsetParent;while(a&&!$(a).hasClass("dialogWrapper")){g+=a.offsetTop;f+=a.offsetLeft;a=a.offsetParent}return{top:g,left:f,width:c,height:b}}function onMouseUp(a){g_ImageCropSelection.dragging=false}function onMouseDown(a){if(a==null){a=window.event}var b=a.target!=null?a.target:a.srcElement;if(b.className=="LxSelection"){var c=findPosition(g_ImageCropSelection);g_ImageCropSelection.offsetX=a.clientX-c.left;g_ImageCropSelection.offsetY=a.clientY-c.top;g_ImageCropSelection.dragging=true;return false}}function onMouseMove(b){if(b==null){b=window.event}if(g_ImageCropSelection.dragging==true){if(g_ImageCropSelection.action=="resize"){var d=findPosition(g_ImageCropSelection);var f=b.clientX-d.left;var c=f/g_ImageCropSelection.ratio;var g=findPosition(g_ImageCropSelection.image);if(d.left+f>g.left+g.width-6){f=g.left+g.width-d.left-6;c=f/g_ImageCropSelection.ratio}if(d.top+c>g.top+g.height-6){c=g.top+g.height-d.top-6;f=c*g_ImageCropSelection.ratio}if(f<30){f=30;c=f/g_ImageCropSelection.ratio}if(c<30){c=30;f=c*g_ImageCropSelection.ratio}g_ImageCropSelection.style.width=f+"px";g_ImageCropSelection.style.height=c+"px";ImageCropChanged()}else{var a=findPosition(g_ImageCropSelection.parentNode);var g=getImagePos(g_ImageCropSelection.image);var f=b.clientX-g_ImageCropSelection.offsetX-a.left+g.left;var c=b.clientY-g_ImageCropSelection.offsetY-a.top+g.top;if(c<g.top){c=g.top}if(f<g.left){f=g.left}if(c+g_ImageCropSelection.offsetHeight>g.top+g.height){c=g.top+g.height-g_ImageCropSelection.offsetHeight}if(f+g_ImageCropSelection.offsetWidth>g.left+g.width){f=g.left+g.width-g_ImageCropSelection.offsetWidth}g_ImageCropSelection.style.top=c+"px";g_ImageCropSelection.style.left=f+"px";ImageCropChanged()}return false}else{var g=findPosition(g_ImageCropSelection);captureMousePosition(b);if(g.top+g.height-8<yMousePos&&g.left+g.width-8<xMousePos){g_ImageCropSelection.style.cursor="se-resize";g_ImageCropSelection.action="resize"}else{g_ImageCropSelection.style.cursor="move";g_ImageCropSelection.action="move"}return false}}function GetCrop(){if(g_ImageCropSelection==null){return""}var f=findPosition(g_ImageCropSelection);var g=findPosition(g_ImageCropSelection.image);var d=f.top-g.top;var c=f.left-g.left;var b=f.width;var a=f.height;return parseInt(d*g_ImageCropSelection.image.maxSizeRatio)+","+parseInt(c*g_ImageCropSelection.image.maxSizeRatio)+","+parseInt(b*g_ImageCropSelection.image.maxSizeRatio)+","+parseInt(a*g_ImageCropSelection.image.maxSizeRatio)}function Trigger(){this.subscribers=[]}Trigger.prototype={subscribe:function(a){if(!this.subscribers.contains(a)){this.subscribers.push(a)}},unsubscribe:function(a){if(this.subscribers.contains(a)){this.subscribers.remove(a)}},update:function(){for(var a=0;a<this.subscribers.length;a++){var b=this.subscribers[a];b.apply(this,arguments)}}};Trigger.myTile=new Trigger();Trigger.myNewMsgCount=new Trigger();Trigger.myFav=new Trigger();Trigger.ZInfo=new Trigger();Trigger.LeaveFanClub=new Trigger();function setupMyTileTrigger(a){Trigger.myTile.subscribe(function(c){var d=document.getElementsByTagName("IMG");for(var b=0;b<d.length;b++){if(d[b].title==a||d[b].getAttribute("zunetag")==a){d[b].src=c}}})}function setupZInfoTrigger(){Trigger.ZInfo.subscribe(function(c){if(c){var f="<br/>";var a=true;var d=["bio","name","location"];for(var h=0;h<d.length;h++){var b=getEl("my_"+d[h]);if(b){if(c[d[h]]){b.innerHTML=c[d[h]].encodeHtml().replace(/\n/g,f);b.style.display=""}else{b.style.display="none"}}}if(c.bio&&c.bio!=""){a=false}var g=getEl("my_infohint");if(g){g.style.display=(a)?"":"none"}}})}var PlayerVersion=function(a){this.major=a[0]!=null?parseInt(a[0]):0;this.minor=a[1]!=null?parseInt(a[1]):0;this.revision=a[2]!=null?parseInt(a[2]):0};PlayerVersion.prototype.versionIsValid=function(a){if(this.major<a.major){return false}if(this.major>a.major){return true}if(this.minor<a.minor){return false}if(this.minor>a.minor){return true}if(this.revision<a.revision){return false}return true};var Flash=function(d,b,c,j,g,k,h,a){this.params=new Object();this.variables=new Object();this.attributes=new Array();if(d){this.setAttribute("swf",d)}if(b){this.setAttribute("id",b)}if(c){this.setAttribute("width",c)}if(j){this.setAttribute("height",j)}if(g){this.setAttribute("version",new PlayerVersion(g.toString().split(".,")))}this.installedVer=FlashUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){try{window.attachEvent("onbeforeunload",FlashUtil.prepUnload)}catch(f){}}this.addParam("bgcolor",(k)?k:"#FFF");this.setAttribute("MMredirectURL",(a)?a:window.location)};Flash.prototype={setAttribute:function(a,b){this.attributes[a]=b},getAttribute:function(a){return this.attributes[a]},addParam:function(a,b){this.params[a]=b},getParams:function(){return this.params},addVariable:function(a,b){this.variables[a]=b},getVariable:function(a){return this.variables[a]},getVariables:function(){return this.variables},getVariablePairs:function(){var b=new Array();var a;var c=this.getVariables();for(a in c){b[b.length]=a+"="+c[a]}return b},getHtml:function(){var b="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){this.addVariable("MMplayerType","PlugIn");b='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'"';b+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var d=this.getParams();for(var a in d){b+=[a]+'="'+d[a]+'" '}var c=this.getVariablePairs().join("&");if(c.length>0){b+='flashvars="'+c+'"'}b+="/>"}else{this.addVariable("MMplayerType","ActiveX");b='<object codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,115,0" id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'">';b+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var d=this.getParams();for(var a in d){b+='<param name="'+a+'" value="'+d[a]+'" />'}var c=this.getVariablePairs().join("&");if(c.length>0){b+='<param name="flashvars" value="'+c+'" />'}b+="</object>"}return b},write:function(a){var b=new PlayerVersion([9,0,115]);if(this.installedVer.versionIsValid(b)&&!this.installedVer.versionIsValid(this.getAttribute("version"))){this.setAttribute("swf","/xweb/lx/swf/inlineinstall.swf");this.addVariable("MMredirectURL",escape(this.getAttribute("MMredirectURL")))}var a=(typeof a=="string")?document.getElementById(a):a;this.saveTitle();a.innerHTML=this.getHtml();this.restoreTitle();return true},saveTitle:function(){if(isIE()&&document&&document.title){document.lxSaveTitle=document.title}},restoreTitle:function(){if(isIE()&&document&&document.lxSaveTitle){document.title=document.lxSaveTitle}}};if(typeof FlashUtil=="undefined"){var FlashUtil={}}FlashUtil.getPlayerVersion=function(){var b=new PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var a=navigator.plugins["Shockwave Flash"];if(a&&a.description){b=new PlayerVersion(a.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."))}}else{b=FlashUtil.getActiveXPlayerVersion()}return b};FlashUtil.getActiveXPlayerVersion=function(){var c=new PlayerVersion([0,0,0]);var a=null;try{var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(b){try{var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");c=new PlayerVersion([6,0,21]);a.AllowScriptAccess="always"}catch(b){if(c.major==6){return c}}try{a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(b){}}if(a!=null){c=new PlayerVersion(a.GetVariable("$version").split(" ")[1].split(","))}return c};FlashUtil.cleanup=function(){try{var c=document.getElementsByTagName("OBJECT");for(var b=c.length-1;b>=0;b--){c[b].style.display="none";for(var a in c[b]){if(typeof c[b][a]=="function"){c[b][a]=function(){}}}}}catch(d){}};FlashUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",FlashUtil.cleanup)};Cookie=function(){var g=this;var a={};var f=document.cookie.split(";");var b=null;var c=function(h,l,p,k,o,m){p=(p?new Date(new Date().getTime()+p*1000).toGMTString():null);var j={key:h||null,value:typeof l!="undefined"?l:null,expires:p||null,domain:k||null,path:o||null,secure:m||null,unsafekey:function(){},unserializable:function(r){var q={unsafekey:true,unserializable:true,toString:true,key:true,value:true};return q[r]},toString:function(){var q=[this.key+"="+this.value+"; "];for(var s in this){if(this[s]&&!this.unserializable(s)){q.push(s+((s=="expire")?"s=":"=")+this[s]+"; ")}}return q.join("")}};return j};function d(){a={};var h,k;var o=f=document.cookie.split(";");var j=o.length;for(var m=0;m<j;m++){h=o[m].split("=");k=trim(h[0]);a[k]=c();a[k].key=k;a[k].value=unescape(trim(h[1]))}}Cookie.get=function(h){d();var j=null;h=trim(h)||h;if(h&&a[h]){j=a[h].value}else{if(!h){j=f}}return j};Cookie.set=function(h,k,o,j,m,l){if(h&&typeof k!="undefined"&&trim(h)!=""){var p=c(h,k,o,j,m,l);this.lastcookie=p;document.cookie=p.toString()}};Cookie.del=function(h){document.cookie=trim(h)+"=; expires=Wed Dec 31 16:00:02 PST 1969;"}};Cookie();var langset={data:{title:"",buttons:[{name:LocStr.lxUtilResources.Yes,behavior:"popup.hide();"},{name:LocStr.lxUtilResources.No,behavior:"popup.hide();"}],getHeader:function(){var a=[];a.push('<div class="dialogWrapper">');a.push('<a onclick="popup.hide();" href="#" class="closeIcon"><img height="16" width="16" alt="Close Icon" src="/xweb/lx/pic/ico_circ_remove.png"/></a>');return a.join("")},getBody:function(){var a=[];a.push('<div id="popBody" class="dialogBody">');a.push('<p style="text-align:left;">{0}</p>'.format(this.title));a.push("</div>");return a.join("")},getFooter:function(){var b=[];b.push('<div id="popFooter" class="ButtonWrapper" style="border:0;">');for(var a=0;a<this.buttons.length;a++){b.push('<a href="#" class="btn pink {0}" onclick="{1}" id="{3}"><span class="btntip"></span><span class="btntext">{2}</span></a>'.format((a==0)?"popupButtonFirst":"popupButton",this.buttons[a].behavior,this.buttons[a].name,this.buttons[a].id))}b.push("</div>");return b.join("")}}};function SpringLoader(o,m,j,c,l,d){var b=getEl(o);var g=getEl(m);var p=document.createElement("DIV");p.style.cssFloat="left";p.style.clear="both";var k=document.createElement("DIV");if(g){g.parentNode.insertBefore(k,g);k.appendChild(p);p.appendChild(g);p.style.display="none";g.style.display=""}g=p;this.target=g;this.trigger=b;this.eventHandler=c;this.timerid=0;g.$spring=this;b.$spring=this;b.href="javascript:";b.onclick=this.activate;if(d){var h=d.split(",");for(var f=0;f<h.length;f++){h[f]=getEl(h[f]);h[f].onclick=function(){clickElement(b);return false}}this.hasTriggers=true;this.triggers=h}var a=b;while(a){if(a.tagName=="FORM"){this.indicator=document.createElement("INPUT");this.indicator.type="hidden";this.indicator.name=j;a.appendChild(this.indicator);break}a=a.parentNode}if(l){this.setOpenState()}else{this.setClosedState()}}SpringLoader.SetFocusOnThis=function(){this.focus()};SpringLoader.FocusOnReveal=function(a){SpringLoader.RegisterOnReveal(a,SpringLoader.SetFocusOnThis)};SpringLoader.RegisterOnReveal=function(c,a){var b=getEl(c);if(b){if(!b.onreveal){b.onreveal=[]}b.onreveal.push(a)}};SpringLoader.ClearOnHide=function(a){SpringLoader.RegisterOnHide(a,SpringLoader.ClearValue)};SpringLoader.ClearValue=function(){this.value=""};SpringLoader.RegisterOnHide=function(c,a){var b=getEl(c);if(b){if(!b.onhide){b.onhide=[]}b.onhide.push(a)}};SpringLoader.CloseAndSubmit=function(d,b){var a=getEl(d);if(a){var c=a.$spring.target;c.onhide=[b];a.$spring.slideClose()}};SpringLoader.prototype={activate:function(){var b=findPosition(this).top;var a=getScrollTop();if(a>b){window.scrollTo(getScrollLeft(),b-20)}this.$spring.slideOpen();return false},reload:function(){this.slideClose();return false},setReloadButton:function(b){var a=getEl(b);if(a){a.$spring=this;a.onclick=function(){return this.$spring.reload()}}},setOpenState:function(){this.state="open";this.trigger.style.display="none";if(this.hasTriggers){for(var a=0;a<this.triggers.length;a++){this.triggers[a].style.display="none"}}this.target.style.display="";if(this.indicator){this.indicator.value="open"}},setClosedState:function(){this.state="closed";this.trigger.style.display="";if(this.hasTriggers){for(var a=0;a<this.triggers.length;a++){this.triggers[a].style.display=""}}if(this.timerid==0){this.target.style.display="none"}if(this.indicator){this.indicator.value="closed"}},fireRevealEvent:function(h){if(h.onreveal){for(var g=0;g<h.onreveal.length;g++){var a=h.onreveal[g];a.call(h)}}var d=h.childNodes;var b;for(b=d.length-1;b>=0;b--){var j=d[b];this.fireRevealEvent(j)}},fireHideEvent:function(h){if(h.onhide){for(var g=0;g<h.onhide.length;g++){var a=h.onhide[g];a.call(h)}}var d=h.childNodes;var b;for(b=0;b<d.length;b++){var j=d[b];this.fireHideEvent(j)}},slideOpen:function(){if(this.state=="open"){return}if(this.timerid!=0){return}if(this.eventHandler){if(!this.eventHandler()){return}}this.slideAnimation(1);this.setOpenState()},slideClose:function(){if(this.state=="closed"){return}if(this.timerid!=0){return}this.slideAnimation(-1);this.setClosedState()},slideAnimation:function(c){var b=this.trigger;var j=this.target;var m=this;if(this.timerid!=0){window.clearTimeout(this.timerid);j.firstChild.style.width=this.sw;j.firstChild.style.top=this.st;j.firstChild.style.position=this.sp}j.style.position="relative";j.style.overflow="hidden";j.style.left="-5000px";j.style.display="";if(c>=0){this.fireRevealEvent(this.target)}if(!browser.slideAnimation){j.style.left="";if(c==-1){this.fireHideEvent(this.target)}return}var l=j.offsetWidth;var g=j.offsetHeight;var p=Math.round(l/9);if(p<5){p=5}var o=Math.round(g/9);if(o<5){o=5}var a=10;var k=1;var f=1;if(c<0){k=l;f=g;p=-p;o=-o}this.sw=j.firstChild.style.width;this.st=j.firstChild.style.top;this.sp=j.firstChild.style.position;function d(){k+=p;f+=o;if(k>=l||k<=0){j.firstChild.style.width=m.sw;j.firstChild.style.top=m.st;j.firstChild.style.position=m.sp;j.style.width="";j.style.height="";j.style.overflow="";j.style.position="";if(c<0){j.style.display="none";m.fireHideEvent(j)}m.timerid=0}else{j.firstChild.style.top=f-g+"px";m.timerid=window.setTimeout(d,a)}}d();j.style.width="1000px";j.firstChild.style.position="relative";j.style.left="";j.style.width=l;j.style.height=g}};var __thumbUpPrefix="rrtu",__thumbDownPrefix="rrtd";function MediaReviewRatingPostBack(c,g,d,b,a,f){if(!Auth.validateTicket()){return false}Ajax.PostAsync(c,a,getEl(g),f,c);return false}function DeleteReview(c,d,h,g,b,a){if(!Auth.validateTicket()){return false}var f=getEl(g);f.value=b;Ajax.FragmentPostBack(c,d,h,d,a);return false}function rateCallback(d,a,b){function c(h,g){var k=getEl(d);k.innerHTML=g;k.nextSibling.style.display="";var j=$("#"+__thumbUpPrefix+"_"+a);var f=$("#"+__thumbDownPrefix+"_"+a);if(b){j.attr("class","UpSelected");f.attr("class","Down")}else{j.attr("class","Up");f.attr("class","DownSelected")}}return c}function checkReview(h,g,c,f,b){var a=true;h=getEl(h);c=getEl(c);f=getEl(f);if(h.value.trim().length==0){a=false;c.className="LxInputValidator";h.focus()}else{c.className="Validator"}var d=g.validate();switch(d){case Zed.ValidateResult.Empty:a=false;if(b==0){f.innerHTML=LocStr.lxUtilResources.PleaseEnterContentForYourComment}else{f.innerHTML=LocStr.lxUtilResources.PleaseEnterContentForYourReview}f.className="LxInputValidator";g.focus();break;case Zed.ValidateResult.OutOfRange:a=false;if(b==0){f.innerHTML=LocStr.lxUtilResources.CommentLengthOutOfRange.format(g.maxchars)}else{f.innerHTML=LocStr.lxUtilResources.ReviewLengthOutOfRange.format(g.maxchars)}f.className="LxInputValidator";g.focus();break;case Zed.ValidateResult.Success:f.className="Validator";break;default:break}return a}function saveReview(h,a,k,g,b,f,j){var d=getEl(a).zed;d.collect();if(checkReview(g,d,b,f,j)){var c=getEl(g);c.value=c.value.encodeHtml2();c.focus();SpringLoader.CloseAndSubmit(h,k)}}function fixScrollForReview(){var c=$(this).offset().top;if(!document.getElementById("zuneDashTopShadow")){var a=document.innerHeight||document.documentElement.clientHeight;var b=window.pageXOffset||document.documentElement.scrollTop;if(c-b>a){window.scrollBy(0,c-b-a+30)}}else{var d=$("#zuneDashTopShadow").offset().top;if(c>d){window.scrollBy(0,c-d+20)}}}function SaveArtistFeeds(d){var o=function(r){Ajax.ShowErrorString(r,l)};var l=getEl("messageContainer");var c=getEl("ArtistFeedEditControls");if(null==l||null==c){return}var m=c.getElementsByTagName("input");var b="/artists/ManageArtistFeeds.ashx?aid="+d;var q=new Array();var a=new Array();var g=new RegExp("http(s)?://([\\w-]+\\.)+[\\w-]+(/[\\w-./?%&=]*)?");for(i=0;i<m.length;i++){var k=m[i].value.trim();var j=(k.length==0)?true:false;if(j){q[i]=""}else{if(k.match(g)&&null==a[k]){a[k]=true;q[i]=k}else{o(LocStr.lxUtilResources.InvalidUrl);return}}}var f=function(){return{feeds:q.join("|")}};var h=function(){Ajax.DismissError(l)};var p=function(r,s){h();popup.hide()};o(LocStr.lxUtilResources.Sending);Ajax.PostAsync(b,f(),l,p,b)}var linkPopup={containerClass:"LxWikiSearchWrapper",idPrefix:"",mid:"",mtype:"",searchAll:"false",switchPivot:"true",linkClickHandler:function(b,a,c){},header:"",win:{w:570},data:{getHeader:function(){var a=[];a.push('<div class="PopUpHeaderWrapper">');a.push('<a href="#" class="ClosePopup" onclick="popup.hide();return false;">&nbsp;</a>');a.push("<h2>");a.push(linkPopup.header);a.push("</h2>");a.push("</div>");return a.join("")},getBody:function(){var a=[];a.push('<div id="popBody" class="LxWikiSearchBody">');a.push('<form onsubmit="linkPopup.submitPopupSearch(); return false;">');a.push("<h3>");a.push(LocStr.lxUtilResources.LookingFor);a.push("</h3>");a.push('<div class="LxWikiSearchInputs">');a.push('<input id="{0}_input" type="text" class="LxWikiSearchBox" maxlength="40" />'.format(linkPopup.idPrefix));a.push('<a id="{0}_submit" class="btn pink" onclick="linkPopup.submitPopupSearch();return false;" title="{1}"><span class="btntip"></span><span class="btntext">{1}</span></a>'.format(linkPopup.idPrefix,LocStr.lxUtilResources.Find));a.push("</div>");a.push("<div>");a.push('<div id="ajaxErr" style="display:none"></div>');a.push('<div id="{0}_resultDiv" style="display:none"></div>'.format(linkPopup.idPrefix));a.push("</div>");a.push("</form>");a.push("</div>");return a.join("")},getFooter:function(){return""}}};linkPopup.initLinkPopup=function(a,g,b,c,f,d){linkPopup.idPrefix=b;linkPopup.mid=a;linkPopup.mtype=g;linkPopup.searchAll=c;if(typeof f=="function"){linkPopup.linkClickHandler=f}linkPopup.header=d};linkPopup.submitPopupSearch=function(){var b=getEl(linkPopup.idPrefix+"_resultDiv");var a=getEl(linkPopup.idPrefix+"_input").value.trim();if(a.length<=0){return false}a=a.encodeURI();var c=linkPopup.idPrefix+"_resultDiv";b.innerHTML="";b.style.display="";Ajax.FragmentPostBack("/xweb/lx/frags/wikisearch.aspx?keyword={0}&type={1}&id={2}&sa={3}&sp={4}".format(a,linkPopup.mtype,linkPopup.mid,linkPopup.searchAll,linkPopup.switchPivot),c,c,c);return false};function ZedSearchBar(c,d,b,f,a){this.zed=c.zed;this.doc=c.zed.doc;this.mediaType=b;this.mediaId=f;this.resultDiv=d+"_resultDiv";this.inputBox=d+"_input"}ZedSearchBar.prototype={submitSearch:function(){var b=getEl(this.resultDiv);var a=getEl(this.inputBox).value.trim();if(a.length<=0){return false}a=a.encodeURI();var c=this.resultDiv;b.innerHTML="";b.style.display="";Ajax.FragmentPostBack("/xweb/lx/frags/wikisearch.aspx?keyword="+a+"&type="+this.mediaType+"&id="+this.mediaId,c,c,c);return false}};function ZedToolbar(d){this.zed=d.zed;this.doc=d.zed.doc;this.buttons={};var j=document.createElement("DIV");j.className="LxToolbar";var k=document.createElement("DIV");k.className="LxTitleBar";k.innerHTML=d.zed.title;var g=ZedToolbar.tools;for(var f=0;f<g.length;f++){var h=g[f];var c=document.createElement("IMG");c.tbar=this;c.iframe=d;var b=h[0];c.id=b;c.className="LxImageButton";c.src="/xweb/lx/pic/"+b+".gif";c.title=h[1];c.setstate=ZedToolbar.setstate;c.onmouseover=ZedToolbar.mouseover;c.onmouseout=ZedToolbar.mouseout;c.onmousedown=ZedToolbar.mousedown;c.onmouseup=ZedToolbar.mouseup;c.onclick=h[2];j.appendChild(c);this.buttons[b]=c}this.node=j;var a=d.parentNode;a.parentNode.insertBefore(j,a);a.parentNode.insertBefore(k,j)}ZedToolbar.mousedown=function(a){this.ismousedown=true;this.setstate();a=Event.unify(a);a.preventDefault();return false};ZedToolbar.mouseup=function(){this.ismousedown=false;this.setstate()};ZedToolbar.mouseout=function(){this.ismouseover=false;this.setstate()};ZedToolbar.mouseover=function(){this.ismouseover=true;this.setstate()};ZedToolbar.simpleClick=function(){var a=this.iframe;a.focus();a.zed.doc.execCommand(this.id,false,null);a.zed.setstate()};ZedToolbar.embedLinkClick=function(){var a=this.tbar.zed;var b=a.sbar;if(!b){a.sbar=new ZedSearchBar(a.iframe,a.idPrefix,a.mediaType,a.mediaId,a.container)}linkPopup.zed=a;linkPopup.initLinkPopup(a.mediaId,a.mediaType,a.idPrefix,false,ZedToolbar.mediaLinkClick,LocStr.lxUtilResources.EmbedMediaLink);popup.show(linkPopup)};ZedToolbar.mediaLinkClick=function(b,a,d){popup.hide();var c=linkPopup.zed;switch(b){case"artist":c.insertLink("/artistdetails.aspx?aid="+d,a);break;case"album":c.insertLink("/albumdetails.aspx?aid="+d,a);break;case"track":c.insertLink("/trackdetails.aspx?aid="+d,a);break;default:break}return false};ZedToolbar.setstate=function(){if(this.ismouseover||this.ison){this.src="/xweb/lx/pic/"+this.id+"_over.gif"}else{this.src="/xweb/lx/pic/"+this.id+".gif"}};ZedToolbar.tools=[["bold",LocStr.lxUtilResources.ZedBold,ZedToolbar.simpleClick],["italic",LocStr.lxUtilResources.ZedItalic,ZedToolbar.simpleClick]];function Zed(j,f,l,a,h,p,d,k,o,b,m){this.hiddenText=getEl(j);this.originalText=h;this.iframe=getEl(f);this.maxchars=l;this.hiddenText.style.display="none";this.hiddenText.form.zed=this;this.onsubmitChain=this.hiddenText.form.onsubmit;this.hiddenText.form.onsubmit=this.onsubmit;this.iframe.zed=this;this.iframe.onreveal=[function(){this.zed.onreveal()}];this.iframe.focus=function(){this.zed.focus()};this.iframe.onhide=[function(){this.zed.hide()}];if(p=="Artist"||p=="Album"){var c=false;for(var g=ZedToolbar.tools.length-1;g>=0;g--){if(ZedToolbar.tools[g][0]=="embedMedia"){c=true;break}}if(!c){ZedToolbar.tools.push(["embedMedia",LocStr.lxUtilResources.ZedLink,ZedToolbar.embedLinkClick])}this.idPrefix=a;this.mediaType=p;this.mediaId=d;this.container=b}this.title=m;this.tbar=new ZedToolbar(this.iframe);this.saveBtnId=k;this.cancelBtnId=o;Zed.list.push(this)}Zed.list=[];Zed.onPageLoad=function(){for(var a=0;a<Zed.list.length;a++){Zed.list[a].onreveal()}Zed.list=[]};Zed.ValidateResult={Success:0,Empty:1,OutOfRange:2};Zed.prototype={createEditor:function(){if(!this.doc){var d;try{d=this.iframe.contentWindow.document;d.designMode="on"}catch(c){return}if(!this.hiddenText.value){this.hiddenText.value=""}d.open();d.write('<html><head><link rel="stylesheet" type="text/css" href="/xweb/lx/RichEditorIframe.css" /></head>');d.write('<body class="LxWikiBodyStyleBase">');d.write(this.ztextToHtml(this.hiddenText.value));d.write("</body></html>");d.close();d.zed=this;var b=function(){if(browser.loseCaret){this.zed.bookmark=this.selection.createRange().getBookmark()}this.zed.setstate()};function a(f){f=f||this.zed.iframe.contentWindow.event;if(f.keyCode==9){var h=getEl(this.zed.saveBtnId);var g=getEl(this.zed.cancelBtnId);if(h){if(g){g.focus()}h.focus();if(f.returnValue){f.returnValue=false}else{if(f.preventDefault){f.preventDefault()}else{return false}}}}b.call(this)}d.onkeydown=a;d.onkeyup=b;d.onmousedown=b;d.onmouseup=b;if(window.addEventListener){d.addEventListener("keydown",a,false);d.addEventListener("keyup",b,false);d.addEventListener("mouseup",b,false);d.addEventListener("mousedown",b,false)}this.doc=d}},onreveal:function(){this.createEditor();if(this.iframe.isFocus){this.focus()}},focus:function(){this.iframe.isFocus=true;if(this.doc){this.iframe.contentWindow.focus();this.doc.body.focus()}},hide:function(){this.iframe.isFocus=false;if(this.doc){this.doc.body.innerHTML=this.ztextToHtml(this.originalText)}this.hiddenText.value=this.originalText},onsubmit:function(){this.zed.collect();if(this.zed.onsubmitChain){this.zed.onsubmitChain()}},collect:function(){this.hasText=false;var a=this.domToZtext(this.doc.body);this.hiddenText.value=a.encodeHtml()},validate:function(){if(!this.hasText){return Zed.ValidateResult.Empty}else{if(this.hiddenText.value.length>this.maxchars){return Zed.ValidateResult.OutOfRange}else{return Zed.ValidateResult.Success}}},domToZtext:function(g){if(g.nodeType!=1&&g.nodeType!=3){return""}if(g.nodeName=="META"||g.nodeName=="LINK"||g.nodeName=="STYLE"){return""}if(g.tagName==null){var s=g.nodeValue;if(s.match(/[^ \f\n\r\t\v\xA0]+/)){this.hasText=true}return s.encodeHtml()}var l=[];var r="";if(g.tagName=="BLOCKQUOTE"||g.tagName=="DIV"){if(g.style.marginLeft){var t=parseInt(g.style.marginLeft)/40;for(var o=0;o<t;o++){r+="<q>";l.push("</q>")}}else{if(g.tagName=="BLOCKQUOTE"){r+="<q>";l.push("</q>")}}}if(g.style.fontStyle=="italic"||g.tagName=="I"||g.tagName=="EM"){r+="<i>";l.push("</i>")}if(g.style.fontWeight=="bold"||g.tagName=="B"||g.tagName=="STRONG"){r+="<b>";l.push("</b>")}if(g.style.textDecoration=="underline"||g.tagName=="U"){r+="<u>";l.push("</u>")}if(g.tagName=="UL"){r+="<ul>";l.push("</ul>")}if(g.tagName=="OL"){r+="<ol>";l.push("</ol>")}if(g.tagName=="LI"){r+="<li>";l.push("</li>")}if(g.tagName=="A"){var c="";var p=g.childNodes;for(var k=0;k<p.length;k++){c+=this.domToZtext(p[k])}if(c==""){return""}var b;try{b=g.href}catch(h){}if(b){var f=b.match(/http:\/\/[\w.]*\/(\w+)details\.aspx\?aid=([a-f0-9-]+)$/i);if(f){var q=f[1];var d=f[2];switch(q.toLowerCase()){case"artist":q="Contributor";break;case"album":q="Album";break;case"track":q="Track";break;case"puid":q="Puid";break;default:q=null;break}if(q){r+='<link type="'+q+'" id="'+d+'">'+c+"</link>"}}else{r+=c}}else{r+=c}}else{if(g.tagName=="BR"){r+="\n"}else{var a=g.childNodes;var o;for(o=0;o<a.length;o++){r+=this.domToZtext(a[o])}if(g.tagName=="P"){r+="\n"}}}for(var o=0;o<l.length;o++){r+=l[o]}return r},ztextToHtml:function(b){var a=b.replace(/<link\s+type=\x22(\w+)\x22\s+id=\x22([a-f0-9-]+)\x22>(.+?)<\/link>/ig,'<a href="/$1details.aspx?aid=$2">$3</a>');a=a.replace(/Contributordetails.aspx/g,"artistdetails.aspx");a=a.replace(/<(\/?)q>/g,"<$1BLOCKQUOTE>");if(browser.isFF){a=a.replace(/<\/a>$/ig,"</a>&nbsp;");a=a.replace(/<\/a></ig,"</a>&nbsp;<")}a=a.replace(/\n/g,"<br>");return a},setstate:function(){var f=this.doc;var a=["bold","italic"];var d;for(d=0;d<a.length;d++){var b=a[d];var c=this.tbar.buttons[b];if(f.queryCommandState(b)){c.ison=true}else{c.ison=false}c.setstate()}},insertLink:function(b,c){this.iframe.focus();if(browser.loseCaret){if(this.bookmark){var g=this.doc.selection.createRange();g.moveToBookmark(this.bookmark);g.select()}}var k="<a href='"+b+"'>"+c.encodeHtml()+"</a>";if(browser.isIE){var d=this.doc.selection.createRange();d.pasteHTML(k)}else{if(browser.isFF){this.doc.execCommand("insertHTML",false,k)}else{var g;var l=this.iframe.contentWindow.getSelection();if(l){g=l.getRangeAt(0)}else{g=this.doc.createRange()}l.removeAllRanges();g.deleteContents();var f=g.startContainer;var h=g.startOffset;var j=this.doc.createElement("A");j.href=b;j.appendChild(this.doc.createTextNode(c));if(f.nodeType==3){f=f.splitText(h)}else{if(f.nodeType==1){f=f.childNodes[h]}}f.parentNode.insertBefore(j,f);g.setEnd(f,h+j.length);g.setStart(f,h+j.length);l.addRange(g);this.doc.execCommand("removeformat",false,null)}}}};var videoPath;var videoPlayerPath="/xweb/lx/xap/SL2VideoPlayer.xap";var signinRequired=false;var isExplicitAndIsChild=false;var zAdsVideoPopup={data:{title:"",buttons:[{name:LocStr.lxUtilResources.Close,behavior:"popup.hide();return false;"}],getHeader:function(){return""},getBody:function(){var a=[];a.push('<div id="popBody" class="LxPopupBody">');a.push('<div style="text-align:center;">');a.push('<div id="silverlightControlHost">');a.push('<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" width="500" height="313">');a.push('<param name="source" value="'+videoPlayerPath+'"/>');a.push('<param name="onerror" value="onSilverlightError" />');a.push('<param name="background" value="transparent" />');a.push('<param name="minRuntimeVersion" value="3.0.40624.0" />');a.push('<param name="initParams" name="initParams" value="autostart=false,muted=False,captions=True,markers=True,isexplicitandischild='+isExplicitAndIsChild+",signinrequired="+signinRequired+",m="+videoPath+'" />');a.push('<a href="http://go.microsoft.com/fwlink/?LinkID=149156&v=3.0.40624.0" style="text-decoration: none; display: block; background: #fff; width: 500px; height: 292px; text-align: center;">');a.push('<img src="http://social.'+ZunePageData.BaseDomain+'/xweb/lx/pic/video_silverlight.png" alt="Get Microsoft Silverlight" style="border-style: none; margin-top: 39px;"/>');a.push("</a>");a.push("</object>");a.push('<iframe style="visibility:hidden;height:0;width:0;border:0px"></iframe>');a.push("</div>");a.push("</div>");a.push("</div>");return a.join("")},getFooter:function(){var b=[];b.push('<div style="display:none;" id="Div1"></div>');b.push('<div id="popFooter" class="LxPopupFooter LxPopupButtons">');for(var a=0;a<this.buttons.length;a++){b.push('<input type="button" class="LxButtonCommon {0}" onclick="{1}" value="{2}" />'.format((a==0)?"popupButtonFirst":"popupButton",this.buttons[a].behavior,this.buttons[a].name))}b.push("</div>");return b.join("")}}};function EncodeInitParams(c,b){b=b||"";c=c||{};for(var a in c){if(b.length>0){b=b+","}b=b+a+"="+encodeURIComponent(c[a])}return b}var videoPopup={data:{title:"",getHeader:function(){var a=LocStr.lxUtilResources.Close;var b=[];b.push('<div style="display:none;" id="Div1"></div>');b.push('<div id="popHeader" class="LxVideoPopupHeader">');b.push('<a class="LxCloseVideoPopup" href="#" onclick="popup.hide();return false;">'+a+"</a>");b.push("</div>");return b.join("")},getBody:function(){if(audioPlayerControl!=null){try{audioPlayerControl.PauseMedia()}catch(c){}}var g=versionStampUrl("http://social."+ZunePageData.BaseDomain+"/xweb/lx/xap/Elive.Player.xap");var a=[];a.push('<div id="popBody" class="LxVideoPopupBody">');a.push('<div style="text-align:center;">');a.push('<div id="silverlightControlHost">');a.push('<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" width="660" height="421" onError="onSilverlightError" onLoad="onPlayerLoad">');a.push('<param name="source" value="'+g+'"/>');a.push('<param name="enablehtmlaccess" value="true" />');a.push('<param name="onerror" value="onSilverlightError" />');a.push('<param name="background" value="transparent" />');a.push('<param name="minRuntimeVersion" value="3.0.40624.0" />');a.push('<param name="culture" value="'+ZunePageData.Culture+'" />');a.push('<param name="uiculture" value="'+ZunePageData.UICulture+'" />');var b={name:"eLivePlayerControl",hostname:"silverlightControlHost",culture:ZunePageData.Culture,uiculture:ZunePageData.UICulture,basedomain:ZunePageData.BaseDomain,zunetag:"ZuneUser",isplaying:true,muted:false,captions:true,markers:true};var d=EncodeInitParams(b);var f=this.startupArgs;if(!f){f={mediaid:videoPath,mediatype:"cmsVideo",title:"",mediainfoex1:null}}else{this.startupArgs=null}d=EncodeInitParams(f,d);a.push('<param name="initParams" name="initParams" value="'+d+'" />');a.push('<a href="http://go.microsoft.com/fwlink/?LinkID=149156&v=3.0.40624.0" style="text-decoration: none; display: block; background: #fff; width: 660px; height: 400px; text-align: center;">');a.push('<img src="http://social.'+ZunePageData.BaseDomain+'/xweb/lx/pic/video_silverlight.png" alt="Get Microsoft Silverlight" style="border-style: none; margin-top: 93px;"/>');a.push("</a>");a.push("</object>");a.push('<iframe style="visibility:hidden;height:0;width:0;border:0px"></iframe>');a.push("</div>");a.push("</div>");a.push("</div>");return a.join("")},getFooter:function(){return""},startupArgs:null},win:{className:"lxVideoPopupTrim"},containerClass:"lxVideoPopupContainer",shieldClass:"lxVideoPopupShield",show:function(a){this.data.startupArgs=a;popup.show(this)}};function VideoPlayerPlayMedia(f){var c=f.split("#");var h=c[0];var b=c[1];var d=c[2];var a=f.slice((c[0]+"#"+c[1]+"#"+c[2]+"#").length);var g={mediaid:h,mediatype:b,title:a,mediainfoex1:d};videoPopup.show(g)}function PopoutVideoPlayer(c,k,h,g,a){try{popup.hide()}catch(b){}g=g||"";var j={ispopout:true,mediaid:c,mediatype:k,mediainfoex1:g,currentposition:a};var f=EncodeInitParams(j);var d="http://social."+ZunePageData.BaseDomain+"/zpage.aspx?c=SilverlightPageController&mediatype=video&startupArgs="+encodeURIComponent(f);videoPlayerPopoutWindow=window.open(d,"ZuneVideoPlayer","height=421,width=660,status=no,toolbar=no,directories=no,menubar=no,location=no,resizable=no,scrollbars=no,titlebar=no,channelmode=no",false)}var genericStreamingErrorPopupTitle="";var genericStreamingErrorPopupBodyText1="";var genericStreamingErrorPopupBodyText2="";var genericStreamingErrorPopupNoButtonText="";if(LocStr&&LocStr.lxUtilResources){if(LocStr.lxUtilResources.StreamingErrorPopupTitle){genericStreamingErrorPopupTitle=LocStr.lxUtilResources.StreamingErrorPopupTitle}if(LocStr.lxUtilResources.StreamingGenericErrorPopupText1){genericStreamingErrorPopupBodyText1=LocStr.lxUtilResources.StreamingGenericErrorPopupText1}if(LocStr.lxUtilResources.StreamingGenericErrorPopupText2){genericStreamingErrorPopupBodyText2=LocStr.lxUtilResources.StreamingGenericErrorPopupText2}if(LocStr.lxUtilResources.StreamingErrorPopupNoButtonText){genericStreamingErrorPopupNoButtonText=LocStr.lxUtilResources.StreamingErrorPopupNoButtonText}}var genericStreamingErrorPopup={data:{title:genericStreamingErrorPopupTitle,buttons:[{name:genericStreamingErrorPopupNoButtonText,behavior:"popup.hide();"}],getHeader:function(){return'<div id="popTitle" class="LxPopupHeader">{0}</div>'.format(this.title)},getBody:function(){var a=[];a.push('<div id="popBody" class="LxPopupBody">');a.push('<div class="LxStreamingErrorPopupBodyLine1">{0}</div>'.format(genericStreamingErrorPopupBodyText1));a.push('<div class="LxStreamingErrorPopupBodyLine2">{0}</div>'.format(genericStreamingErrorPopupBodyText2));a.push("</div>");return a.join("")},getFooter:function(){var b=[];b.push('<div style="display:none;" id="Div1"></div>');b.push('<div id="popFooter" class="LxPopupFooter LxPopupButtons">');for(var a=0;a<this.buttons.length;a++){b.push('<input type="button" class="LxButtonCommon {0}" onclick="{1}" value="{2}" />'.format((a==0)?"popupButtonFirst":"popupButton",this.buttons[a].behavior,this.buttons[a].name))}b.push("</div>");return b.join("")}}};var streamingErrorPopupTitle="";var streamingErrorPopupBodyText1="";var streamingErrorPopupBodyText2="";var streamingErrorPopupBodyText3="";var streamingErrorPopupYesButtonText="";var streamingErrorPopupNoButtonText="";if(LocStr&&LocStr.lxUtilResources){if(LocStr.lxUtilResources.StreamingErrorPopupTitle){streamingErrorPopupTitle=LocStr.lxUtilResources.StreamingErrorPopupTitle}if(LocStr.lxUtilResources.StreamingErrorPopupBodyText1){streamingErrorPopupBodyText1=LocStr.lxUtilResources.StreamingErrorPopupBodyText1}if(LocStr.lxUtilResources.StreamingErrorPopupBodyText2){streamingErrorPopupBodyText2=LocStr.lxUtilResources.StreamingErrorPopupBodyText2}if(LocStr.lxUtilResources.StreamingErrorPopupBodyText3){streamingErrorPopupBodyText3=LocStr.lxUtilResources.StreamingErrorPopupBodyText3}if(LocStr.lxUtilResources.StreamingErrorPopupYesButtonText){streamingErrorPopupYesButtonText=LocStr.lxUtilResources.StreamingErrorPopupYesButtonText}if(LocStr.lxUtilResources.StreamingErrorPopupNoButtonText){streamingErrorPopupNoButtonText=LocStr.lxUtilResources.StreamingErrorPopupNoButtonText}}var streamingErrorPopup={data:{title:streamingErrorPopupTitle,buttons:[{name:streamingErrorPopupYesButtonText,behavior:"AudioPlayerPlayMediaForceLogin(); popup.hide();"},{name:streamingErrorPopupNoButtonText,behavior:"popup.hide();"}],getHeader:function(){return'<div id="popTitle" class="LxPopupHeader">{0}</div>'.format(this.title)},getBody:function(){var a=[];a.push('<div id="popBody" class="LxPopupBody">');a.push('<div class="LxStreamingErrorPopupBodyLine1">{0}</div>'.format(streamingErrorPopupBodyText1));a.push('<div class="LxStreamingErrorPopupBodyLine2">');a.push('<span class="LxStreamingErrorPopupBodyLine2Sentence1">{0}</span>'.format(streamingErrorPopupBodyText3));a.push("<span>{0}</span>".format(streamingErrorPopupBodyText2));a.push("</div>");a.push("</div>");return a.join("")},getFooter:function(){var b=[];b.push('<div style="display:none;" id="Div1"></div>');b.push('<div id="popFooter" class="LxPopupFooter LxPopupButtons">');for(var a=0;a<this.buttons.length;a++){b.push('<input type="button" class="LxButtonCommon {0}" onclick="{1}" value="{2}" />'.format((a==0)?"popupButtonFirst":"popupButton",this.buttons[a].behavior,this.buttons[a].name))}b.push("</div>");return b.join("")}}};uri=function(c){var b=this;this.validParts=new Array("page","path","protocol","domain","qs");var f=c.indexOf("://")+3;var g=c.indexOf("/",f);if(g==(-1)){g=c.length}var j=c.indexOf("?");var h=c.lastIndexOf("/");var d=[];d.page="";d.path="";if(h>=g){d.path=(g!=h?c.substring(g,h+1):"/");d.page=c.substring((h+1),(j==-1?c.length:j));if(d.page.indexOf(".")==-1&&j<0){d.path+=d.page;d.page=""}}d.protocol=c.substring(0,c.indexOf("://"));d.domain=c.substring(f,g);d.qs=(j!=-1)?c.substr(j+1):"";function a(m){b.protocol=m.protocol;b.domain=m.domain;b.page=m.page;b.qs=m.qs;var o=m.path;if(o.substr(o.length-1)!="/"&&b.page!=""){o+="/"}var k=[];if(o=="/"){k.push(o)}else{if(o!=""){k=o.split("/");k.trim()}}b.path=o;b.paths=k;b.domainParts=b.domain.split(".");b.serverRoot=(b.protocol+"://"+b.domain);b.serverPath=b.serverRoot+b.path;b.noQS=b.serverPath+b.page;b.url=b.noQS+(b.qs?("?"+b.qs):"");b.uriparts=m;var p=[];if(b.qs!=""){p=b.qs.split("&");for(var l=0;l<p.length;l++){p[l]=p[l].split("=")}}b.qsParts=p}this.setValue=function(k,m){var l=false;for(n in this.validParts){if(k==this.validParts[n]){this.uriparts[k]=m;a(this.uriparts);return true}}return false};this.queryString=function(l){if(undef(l)||l==""){return this.qs}var k=[];for(n in this.qsParts){if(this.qsParts[n][0]==l){k.push(this.qsParts[n][1])}}return k.toString()};a(d)};var URI;try{URI=new uri(location.href)}catch(e){URI={}}versionStampUrl=function(a){var b=ZunePageData.AppVersionQueryString||"ver=unknown";if(a.indexOf("?")>=0){a=a+"&"+b}else{a=a+"?"+b}return a};var videoCookieExpiration=10*60;function PlayEpisodePreview(a){window.open(a,null,"height=200,width=400,status=yes,toolbar=no,menubar=no,location=no")}function NavigateToNetwork(b,a,c){return NavigateToSeriesGallery("network",b,a,c)}function NavigateToGenre(a,b,c){return NavigateToSeriesGallery("genre",a,b,c)}function NavigateToSeriesGallery(c,d,b,f){var a="SeriesGallery.aspx";if(c=="network"){a+="?Network="}else{a+="?Genre="}a+=d;if(b!=null){if(b==""){b="TopShows"}a+="&SortBy="+b}if(f!=null){if(f!=""){a+="&Availability="+f}}window.location=a}function NavigateToSeriesDetailPage(a){window.location="/video/Series.aspx?serid="+a.getAttribute("itemId")}function NavigateToEpisodeDetails(b,a){a=a||"";window.location="/video/Episode.aspx?vid="+b.getAttribute("itemId")+a}function setMyTvUI(){if(Auth.isSignedIn){var b=function(d,c){if(c&&c.mytvlist){for(var f=0;f<c.mytvlist.length;f++){var g=document.getElementsByName(c.mytvlist[f].episodeId);if(g.length>0){toggleMyTvButton(true,g[0])}}}};var a=function(d,c){if(c&&c.mytvlist){SetMyTvVersion(c.mytvlistversion);MakeGetMyTvAjaxCall(null,b,null)}};MakeGetMyTvAjaxCall(null,a,true)}}function toggleMyTvButton(a,b){if(b!=null){if(a){var d=b.getAttribute("itemId");b.onclick=function(){return NavigateToMyTv()};b.src="/xweb/lx/pic/video/fav-check.gif";b.onmouseover=function(){return pagerButtonImageSwap(b,"/xweb/lx/pic/video/fav-check_over.gif")};b.onmouseout=function(){return pagerButtonImageSwap(b,"/xweb/lx/pic/video/fav-check.gif")};var c=b.getAttribute("ToggleText");b.setAttribute("ToggleText",b.title);b.title=c}else{b.onclick=function(){return AddToMyTv(this,"TVEpisode")};b.src="/xweb/lx/pic/video/add_episode.gif";b.onmouseover=function(){return pagerButtonImageSwap(b,"/xweb/lx/pic/video/addto_over.gif")};b.onmouseout=function(){return pagerButtonImageSwap(b,"/xweb/lx/pic/video/add_episode.gif")};var c=b.getAttribute("ToggleText");b.setAttribute("ToggleText",b.title);b.title=c}}}function NavigateToMyTv(){window.location="/Profile/mytv.aspx"}function UpdateSeasonListControlAddToMyTv(a,c){var b=document.getElementsByName(c);if(b!=null&&b.length>0){toggleMyTvButton(a,b[0])}}function checkRedirectAddToMyTv(){if(!Auth.isSignedIn){return false}var a=getRedirectAddToMyTvElementIdCookie();if(a!=null){var b=document.getElementsByName(a);if(b!=null&&b.length>0&&!isCurrentEpisodeAndHasBeenAdded()){AddToMyTv(b[0],"TVEpisode");setRedirectAddToMyTvElementIdCookie("")}}}function isCurrentEpisodeAndHasBeenAdded(){var b=false;var a=document.getElementById("EpisodeVideoCurrentEpisodeIsOnMyTv");if(a!=null){b=Boolean(a.value)}return b}function AddToMyTv(c,a){var f=c.getAttribute("itemId");if(!Auth.validateTicket()){setRedirectAddToMyTvElementIdCookie(c.name);return false}if(!TryAddToMyTvEpisodeVideo(c)){ResetMyTvVersion();toggleMyTvButton(true,c);var b="/profile/AddToMyTv.ashx";var d={mediaId:f,mediaType:a};Ajax.PostAsyncWithSilentLoad(b,d,getEl(f),null)}return false}function getRedirectAddToMyTvElementIdCookie(){return Cookie.get("RedirectAddToMyTvElementId")}function setRedirectAddToMyTvElementIdCookie(a){Cookie.set("RedirectAddToMyTvElementId",a,videoCookieExpiration,null,"/",null)}function TryAddToMyTvEpisodeVideo(c){var b=document.getElementById("EpisodeVideoAddToMyTvButton");var a=document.getElementById("EpisodeVideoCurrentEpisodeId");var h=c.getAttribute("itemId");if(b!=null&&a!=null){var g=b.value;var f=a.value;if(h==f){var d=document.getElementById(g);d.onclick();return true}else{return false}}}function GenerateMyTvGallery(){if(Auth.isSignedIn){var b=function(d,c){if(c&&c.mytvlist){if(c.mytvlist.length>0){myTvPager.InitializePager(c.mytvlist);IsShowEmptyResults(true)}else{IsShowEmptyResults(false)}}};var a=function(d,c){if(c&&c.mytvlist){SetMyTvVersion(c.mytvlistversion);MakeGetMyTvAjaxCall(null,b,null)}};MakeGetMyTvAjaxCall(null,a,true);SetMyTvSortByUI(GetCurrentMyTvSortOrder())}}function MakeGetMyTvAjaxCall(d,c,a){a=(a==null||a==false)?"":"&check=true";var b="/profile/GetMyTv.ashx"+GetMyTvPostBackUrlSuffix()+a;Ajax.GetAsync(b,null,d,c,b)}function RenderMyTvPage(f,d,c){var g=document.getElementById("divGalleryContainer");while(g.childNodes.length>0){g.removeChild(g.childNodes[0])}for(var b=f;b<d+1;b++){var a=returnGalleryItem(c[b]);g.appendChild(a)}if(c.length>0){IsShowEmptyResults(true)}else{IsShowEmptyResults(false)}}function IsShowEmptyResults(a){var b=document.getElementById("_pagerDiv");var c=document.getElementById("_emptyResultsDiv");if(a){if(c!=null){c.style.display="none"}if(b!=null){b.style.display="block"}}else{if(c!=null){c.style.display="block"}if(b!=null){b.style.display="none"}}}function returnGalleryItem(l){var s=document.getElementById("MyTvGalleryMetadataLineLength");var b=(s!=null)?s.value:0;var h=document.getElementById("seasonEpisodeFormat").value;var m=document.getElementById("MyTvGalleryRemoveItem").value;var t=document.getElementById("MyTvGalleryRemoveItemTitle").value;var a;var f;var p;var g=document.createElement("div");g.setAttribute("id","gallery_item_"+l.episodeId);g.setAttribute("itemId",l.episodeId);g.className="MyTvGalleryContainerItem";var r=document.createElement("img");r.className="MyTvGalleryImage";r.src=l.itemUrl;r.title=l.episodeTitle;r.alt=l.episodeTitle;r.setAttribute("itemId",l.episodeId);r.onclick=function(u){if(window.event){u=window.event}NavigateToEpisodeDetails(r)};r.onerror=function(){r.src="/xweb/lx/pic/video/no-art_150x150.gif"};g.appendChild(r);var c=document.createElement("div");c.className="MyTvGalleryItemDataContainer";var k=document.createElement("A");p=TruncateString(l.seriesTitle,2*b);f=document.createTextNode(p);k.appendChild(f);k.setAttribute("itemId",l.seriesId);k.setAttribute("href","#");k.className="MyTvGalleryItemSeriesTitle";k.onclick=function(u){if(window.event){u=window.event}NavigateToSeriesDetailPage(k)};a=document.createElement("div");a.className="MyTvItem";a.appendChild(k);c.appendChild(a);var o=document.createElement("A");p=TruncateEpisodeTitle(l.seriesTitle,l.episodeTitle,b);f=document.createTextNode(p);o.appendChild(f);o.setAttribute("itemId",l.episodeId);o.setAttribute("href","#");o.className="GalleryItemNameLabel";o.onclick=function(u){if(window.event){u=window.event}NavigateToEpisodeDetails(o)};a=document.createElement("div");a.className="MyTvItem";a.appendChild(o);c.appendChild(a);h=h.replace("{0}",l.seasonNumber);h=h.replace("{1}",l.episodeNumber);var d=document.createElement("SPAN");f=document.createTextNode(h);d.appendChild(f);d.className="MyTvSeasonAndEpisode";a=document.createElement("div");a.className="MyTvItem";a.appendChild(d);c.appendChild(a);g.appendChild(c);var q=document.createElement("div");q.className="MyTvGalleryItemRemoveItem";var j=document.createElement("img");j.src="/xweb/lx/pic/delete.gif";j.onmouseover=function(u){j.src="/xweb/lx/pic/remove_over.gif"};j.onmouseout=function(u){j.src="/xweb/lx/pic/delete.gif"};t=t.replace("{0}",l.episodeTitle);j.setAttribute("title",t);j.className="MyTvGalleryItemRemoveItem";j.onclick=function(u){if(window.event){u=window.event}var v=u.srcElement?u.srcElement:u.target;RemoveFromMyTv(v.parentNode.parentNode.parentNode.getAttribute("itemId"),v.parentNode.parentNode.parentNode.getAttribute("id"))};q.appendChild(j);c.appendChild(q);g.appendChild(c);return g}function TruncateEpisodeTitle(d,c,b){var a=(d.length>b)?1:2;return TruncateString(c,a*b)}function TruncateString(f,b){var d=f;if(f.length>b){var a=f.substring(0,b-1);if(a!=null){var c=a.lastIndexOf(" ");if(c>0){d=a.substring(0,c);d=d+" ..."}}}return d}function RemoveFromMyTv(d,a){var b="/profile/AddToMyTv.ashx";var c={mediaId:d,action:"remove"};ResetMyTvVersion();Ajax.PostAsyncWithSilentLoad(b,c,getEl(a),null);RemoveMyTvItemFromClientJson(d)}function RemoveMyTvItemFromClientJson(b){for(var a=0;a<myTvPager.objArray.length;a++){if(myTvPager.objArray[a].episodeId==b){myTvPager.objArray.splice(a,1);myTvPager.UpdateUI();break}}}function JavascriptPager(b,c,k){this.pagerId=b;this.renderPageCallback=c;this.pageSize=k;this.currentItemIndex=0;this.InitializePager=a;this.NextPage=g;this.GetEndIndex=f;this.PreviousPage=l;this.UpdateUI=j;this.ParametersAreValid=d;this.VerifyAndSetCurrentIndex=h;function a(m){this.objArray=m;this.UpdateUI()}function g(o){if(this.ParametersAreValid()){var m=this.currentItemIndex+this.pageSize;if(m<=this.objArray.length-1){this.currentItemIndex=m}this.UpdateUI()}}function l(){if(this.ParametersAreValid()){var m=this.currentItemIndex-this.pageSize;this.currentItemIndex=(m<0)?0:m;this.UpdateUI()}}function f(){return(this.objArray.length<(this.currentItemIndex+this.pageSize))?this.objArray.length-1:this.currentItemIndex+this.pageSize-1}function j(){if(this.ParametersAreValid()){this.VerifyAndSetCurrentIndex();this.renderPageCallback(this.currentItemIndex,this.GetEndIndex(),this.objArray);var o=document.getElementById("_pageInfo_"+this.pagerId);if(o!=null){var p=this.GetEndIndex()+1;var m=this.currentItemIndex+1;o.innerHTML=m+"-"+p+"/"+this.objArray.length}}}function h(){if(this.currentItemIndex>=this.objArray.length&&this.objArray.length>0){this.currentItemIndex=this.currentItemIndex-this.pageSize}}function d(){return(this.objArray!=null&&this.renderPageCallback!=null&&this.pageSize!=null)?true:false}}function ResetMyTvVersion(){SetMyTvVersion("-1")}function SetMyTvVersion(a){Cookie.set("myTvListVer",a,videoCookieExpiration,null,"/",null)}function GetZuneTag(){return GetInputValue("ZuneTag")}function GetMyTvClientListVersion(){var a=Cookie.get("myTvListVer");return a}function GetMyTvPostBackUrlSuffix(){return"?sortBy="+GetCurrentMyTvSortOrder()+"&zunetag="+GetZuneTag()+"&version="+GetMyTvClientListVersion()}function GetInputValue(b){var a=document.getElementById(b);if(a!=null&&a.value!=""){return a.value}return null}function SortMyTvItems(a){if(GetCurrentMyTvSortOrder()!=a){SetCurrentMyTvSortOrder(a);GenerateMyTvGallery()}}function SetMyTvSortByUI(d){var a=document.getElementById("ReleaseDate");var c=document.getElementById("AdditionDate");var b=document.getElementById("Series");if(a!=null&&c!=null&&b!=null){a.className="PivotItem";c.className="PivotItem";b.className="PivotItem";switch(d){case"AdditionDate":c.className="PivotItemSelected";break;case"ReleaseDate":a.className="PivotItemSelected";break;case"Series":b.className="PivotItemSelected";break}}}function SetCurrentMyTvSortOrder(b){if(b!=null&&b!=""){var a="MyTvSort";Cookie.set(a,b,videoCookieExpiration,null,"/",null)}}function GetCurrentMyTvSortOrder(){var a="MyTvSort";var b=Cookie.get(a);if(b==null||b==""){var c=GetInputValue("MyTvDefaultSortBy");SetCurrentMyTvSortOrder(c);b=c}return b}function onVideoImageError(a){if(a.tagName=="IMG"){switch(a.className){case"FeaturesGalleryItemImage":case"GalleryItemSeriesPosterImage":case"MyTvGalleryImage":a.src="/xweb/lx/pic/video/no-art_150x150.gif";break;case"VideoListItemImage":a.src="/xweb/lx/pic/video/no-art_75x75.gif";break}}}function SetSeriesImageCss(){var a=document.getElementById("seriesImageDiv");var b=document.getElementById("seriesImage");if(a!=null&&b!=null){a.className=(b.height==200)?"EpisodeSeriesContainerSmall":"EpisodeSeriesContainerLarge";b.style.visibility="visible"}}function cancelEvent(){event.returnValue=false}var videoUrl="http://msxb-d2.vo.llnw.net/ztest/CONTENT/MBR/M4_V3_HD30_WinterXGames_Day2_1280x720_64Kbps/MBR.elive";var mediaId=null;var playerHost=null;var playerControl=null;var ePlayer=null;var started=false;var isPreviewUrl=false;var saveBookmarkTimerInterval=60000;var saveBookmarkTimerId=null;var lastSavedBookmark=0;var playWhenReadyToPlay=false;var collapsedCompanionAdHeight=60;function SilverlightTrace(a){if(ePlayer==null){}else{ePlayer.LogText=a}}function onSilverlightError(b,a){}function LoadPlayer(){if(window.location.search){var c=window.location.search.split("?");var b;if(c){if(c.length==1){b=c[0].split("&")}if(c.length==2){b=c[1].split("&")}}if(b&&b.length>0){for(var a=0;a<b.length;a++){var d=b[a].split("=");if(d.length==2){if(d[0].toLowerCase()=="vid"){mediaId=d[1]}}}}}SetSilverlightJsOverrides();CreatePlayer(mediaId)}function FormatPopupPlayerPage(){playerHost=document.getElementById("eLivePlayerHost");if(playerHost!=null){playerHost.className="PopupPlayerContainer";try{document.body.firstChild.insertBefore(playerHost)}catch(b){document.body.appendChild(playerHost)}}var a=document.getElementsByTagName("body");if(a!=null&&a.length>0){a[0].style.display="block"}}function SetSilverlightJsOverrides(){Silverlight.buildPromptHTML=function(b){var d="";var c="/xweb/lx/pic/mbs/SL_install.jpg";var a=b.version;if(b.alt){d=b.alt}else{if(!a){a=""}d="<a href='#' onclick='Silverlight.getSilverlight(\"{1}\");return false;' style='text-decoration: none;'><img src='{2}' alt='Get Microsoft Silverlight' style='border-style: none'/></a>";d=d.replace("{1}",a);d=d.replace("{2}",c)}return d}}function ValueToString(a){if(a){return a.toString()}return""}function onQualityChanged(b,a){var c="PlayRate: "+ValueToString(a.PlayBitRate)+", DownloadRate: "+ValueToString(a.DownloadBitRate)+", RenderedFPS: "+ValueToString(a.RenderedFPS)+", AverageFPS: "+ValueToString(a.AverageFPS)+", DroppedFPS: "+ValueToString(a.DroppedFPS)+", TotalDropped: "+ValueToString(a.TotalFramesDropped);SilverlightTrace(c)}var companionAdUrl="";function onDisplayCompanionAd(b,a){DisplayCompanionAd(b,a);if(!a.Ad){SilverlightTrace("onDisplayCompanionAd had null args");return}if(a.Ad.UrlCompanion==null||a.Ad.UrlCompanion==""){SilverlightTrace("Display ad off: "+companionAdUrl)}else{companionAdAddress=a.Ad.UrlCompanion;SilverlightTrace("Display ad on: "+companionAdUrl+", placement: "+a.Ad.Placement)}}function onPlayerLog(b,a){var c=a.Message;SilverlightTrace(c)}function AddCopySpewButton(){}function onPlayerLoad(b,c,a){if(b.Content){ePlayer=b.Content.eLivePlayerControl}AddCopySpewButton();if(ePlayer!=null){SilverlightTrace("Starting...");SilverlightTrace("onPlayerLoad");SilverlightTrace("got player: "+ePlayer.ControlName);ePlayer.addEventListener("PlayerStateChanged",onPlayerStateChanged);ePlayer.addEventListener("DisplayCompanionAd",onDisplayCompanionAd);ePlayer.addEventListener("QualityChanged",onQualityChanged);ePlayer.addEventListener("RequestToSignIn",onRequestToSignIn);ePlayer.addEventListener("MediaEnded",onMediaEnded)}else{SilverlightTrace("ePlayer not found")}}function onMediaEnded(b,a){clearBookmark()}function onRequestToSignIn(b,a){Auth.validateTicket()}function onPlayerUnload(){if(started&&ePlayer.CurrentPosition>0){saveBookmark()}}function onPlayerStateChanged(b,a){var c="None";switch(a.PlaybackState){case 0:c="Initial";break;case 1:c="Loading";break;case 2:c="ReadyToPlay";if(playWhenReadyToPlay==true){ePlayer.Play();playWhenReadyToPlay=false}break;case 3:c="Playing";if(started==false){started=true}break;case 4:saveBookmark();c="Paused";break;case 5:SilverlightTrace("Error "+ePlayer.ErrorText);c="Error";break;default:c="Unknown";break}var d=a.Content?", content":", ad";SilverlightTrace("New state "+c+", position "+a.CurrentPosition+" "+d)}function saveBookmark(){var d=ePlayer.CurrentPosition;if(Auth.isSignedIn&&isPreviewUrl==false){if(d!=lastSavedBookmark){var c="save";var a="/profile/SetBookmarkPost.ashx";var b={mediaId:mediaId,action:c,bookmark:d.toString(10)};Ajax.PostAsyncWithSilentLoad(a,b,null,null);lastSavedBookmark=d}}}function clearBookmark(){var c="clear";var a="/profile/SetBookmarkPost.ashx";var b={mediaId:mediaId,action:c};Ajax.PostAsyncWithSilentLoad(a,b,null,null)}function setBookmarkTimer(){if(saveBookmarkTimerId==null){saveBookmarkTimerId=window.setInterval(saveBookmark,saveBookmarkTimerInterval)}}function ResumePlayback(b,c,a){isPreviewUrl=false;lastSavedBookmark=parseInt(a,10);return PlayContentFromPosition(b,c,lastSavedBookmark)}function PlayContent(b,c,a){isPreviewUrl=a;return PlayContentFromPosition(b,c,0)}function PlayTrailer(b,c,a){isPreviewUrl=a;if(ePlayer!=null){mediaId=c;if(b!=""&&b.length>0){videoUrl=b}ShowPlayer(true);ePlayer.Play();SilverlightTrace("LoadContent: Playing content: "+videoUrl)}}function PlayContentFromPosition(a,c,b){if(ePlayer!=null){mediaId=c;if(!isPreviewUrl){setBookmarkTimer()}if(a!=""&&a.length>0){videoUrl=a}ShowPlayer(true);if(b>0){ePlayer.setCurrentPosition(b)}SilverlightTrace("LoadContent: Playing content: "+videoUrl);ePlayer.Play()}else{SilverlightTrace("PlayContentFromPosition: No player available to play "+videoUrl)}return false}function ShowPlayer(a){if(a==true){eLivePlayerHost.style.display="inline";eLivePlayerHost.style.visibility="visible"}else{if(a==false){eLivePlayerHost.style.visibility="hidden";eLivePlayerHost.style.display="none"}}}function WatchNow(a){if(ePlayer!=null&&ePlayer.PlaybackState!=3){return PlayContent("",a,false)}}function LoadContent(){}function mailTo(){document.location.href="MailTo:?subject=Zune Video&body=Check out this video"}function copyThis(){var b=document.location.toString();var a=document.getElementById("txtInput").value.toString();window.clipboardData.setData("Text",b+a)}function embedThis(){var a=document.getElementById("txtInput").value.toString();var b="<iframe src="+document.location.toString()+a+' scrolling="no" frameborder="0" style="width:895px; height:700px"></iframe>';window.clipboardData.setData("Text",b)}function msnThis(){window.open("http://www.live.com/?add=http%3a%2f%2fwww.metaliq.com")}function diggThis(){window.open("http://digg.com/submit?url=http%3A%2F%2Fwww.metaliq.com&title=metaliqTESTTEST&bodytext=www.metaliq.com")}function facebookThis(){window.open("http://www.facebook.com/sharer.php?u=http://www.metaliq.com&t=TESTTEST | metaliq.com")}function AdvertClicked(){ePlayer.CompanionAdClicked(adAddress)}var adAddress="nowhere";function DisplayCompanionAd(d,c){if(c.Ad.UrlCompanion!=null||c.Ad.UrlCompanion!=""){var f=document.createElement("img");f.src=c.Ad.UrlCompanion;if(f.height=="250"||f.height=="60"){var b=document.getElementById("companionAd");var a=document.getElementById("EpisodeMetaDataMainDiv");var g=document.getElementById("EpisodeMetaDataFooter");if(b!=null&&a!=null&&g!=null){adAddress=c.Ad.UrlCompanion;b.src=c.Ad.UrlCompanion;if(c.Ad.DisplayType=="expandedType"&&f.height>collapsedCompanionAdHeight){a.style.display="none";g.style.display="none"}else{a.style.display="block";g.style.display="block"}}}b.style.display="block"}}var g_useSilverlightForSongPlays;function SetSongPlayerPreference(a){g_useSilverlightForSongPlays=a}function MBS(c,b,j,g,a,h,f,d){this.img=c;this.previewId=b;this.trackId=j;this.albumId=g;this.expandId=a;this.albumImageId=h;this.playsId=f;this.playLabelId=d;if(typeof(this.expandId)=="undefined"){this.expandId=c.id+"_expand"}this.playState=0}MBS.prototype.Stop=function(){this.playState=0;this.SetImageState(false);MBS.StopPlayer();window.lxPlaying=null;this.img.title=LocStr.lxUtilResources.ClickToPlay.expandTokens({TITLE:this.trackTitle})};MBS.prototype.Playing=function(){this.playState=2;this.SetImageState(false)};MBS.prototype.Start=function(){this.playState=1;this.SetImageState(false);if(window.lxPlaying){window.lxPlaying.Stop()}window.lxPlaying=this;MBS.PlayPreview(this.previewId,this.trackId,this.albumId,this.img);this.img.title=LocStr.lxUtilResources.ClickToPause.expandTokens({TITLE:this.trackTitle});MBS.LoadTrackDetails(this.trackId,this.expandId,true);SetLargeSize(this.playsId,this.playLabelId);if("undefined"!=typeof(this.albumImageId)){SongListingDisplayAlbumImage(this.albumImageId,"/Album/GetAlbumImageUrl.ashx?aid="+this.albumId)}};MBS.LoadTrackDetails=function(g,b,h){var d=getEl(b);if(null==d){return}var c=d.getAttribute("loaded");var f=d.getAttribute("isfav");var a=d.getAttribute("playedby");if(css.has(d,"hide")||h){css.remove(d,"hide");if(!c){Ajax.FragmentHttpGet("/frags/TrackDetails.aspx?trackId="+g+"&isfav="+f+"&playedby="+a,b,b);d.setAttribute("loaded",true)}}else{css.add(d,"hide")}};MBS.PlayPreviewError=function(){MBS.StopAll()};MBS.StopAll=function(){if(window.lxPlaying){window.lxPlaying.Stop()}window.lxPlaying=null};MBS.Started=function(){if(window.lxPlaying){window.lxPlaying.Playing()}};MBS.prototype.SetImageState=function(a){if(this.playState==2){if(this.hover){this.img.src="/xweb/lx/pic/mbs/pause_hover.gif"}else{this.img.src="/xweb/lx/pic/mbs/pause_active.gif"}}if(this.playState==0){if(this.hover){this.img.src="/xweb/lx/pic/mbs/play_hover.gif"}else{if(g_useSilverlightForSongPlays=="true"&&this.trackId==g_currPlayingTrackId&&g_isCurrTrackOn==true){if(this.img.src.indexOf("/xweb/lx/pic/mbs/loading_active.gif")==-1){this.img.src="/xweb/lx/pic/mbs/loading_active.gif"}}else{this.img.src=this.defaultImageSrc}}}if(this.playState==1&&!a){this.img.src="/xweb/lx/pic/mbs/loading_active.gif"}};MBS.MouseOver=function(){var a=this.lxMbs;a.hover=true;a.SetImageState(true)};MBS.MouseOut=function(){var a=this.lxMbs;a.hover=false;a.SetImageState(true)};MBS.Click=function(){var a=this.lxMbs;if(a.playState==0){a.Start()}else{a.Stop()}};MBS.SilverlightClick=function(){var a=this.lxMbs;MBS.PlayPreview(a.previewId,a.trackId,a.albumId,a.img);MBS.LoadTrackDetails(a.trackId,a.expandId,true);SetLargeSize(a.playsId,a.playLabelId);if("undefined"!=typeof(a.albumImageId)){SongListingDisplayAlbumImage(a.albumImageId,"/Album/GetAlbumImageUrl.ashx?aid="+a.albumId)}UpdateCurrentlyPlayingImages(a.trackId,true)};MBS.Init=function(l,h,c,j,d,m,a,b,k){var f=getEl(l);var g=new MBS(f,h,c,j,d,m,a,b);f.lxMbs=g;f.onmouseover=MBS.MouseOver;f.onmouseout=MBS.MouseOut;g.trackTitle=f.title;g.defaultImageSrc=f.src;if(g_useSilverlightForSongPlays=="true"){f.onclick=MBS.SilverlightClick;if(k!="undefined"&&k!=undefined){f.title=k.format(g.trackTitle)}}else{f.onclick=MBS.Click;f.title=LocStr.lxUtilResources.ClickToPlay.expandTokens({TITLE:g.trackTitle})}f.className="LxEnabled";g.SetImageState(false)};function getExternalInterface(a){return(navigator.appName.indexOf("Microsoft")!=-1)?window[a]:document[a]}MBS.PlayPreview=function(b,d,a,c){if(g_useSilverlightForSongPlays=="true"){MBS.PlaySongInSilverlight(d);return}function g(h,j){player=getExternalInterface("ZuneMusicPlayer");player.Url=j.location+j.resource;var l=j.location;var k=j.resource;player.PlayStreaming(l,k)}c.LxOnAjaxStart=function(){};var f={PreviewId:b,TrackId:d,AlbumId:a};Ajax.GetAsync("/frags/GetPreviewUrl.ashx",f,c,g)};MBS.StopPlayer=function(){player=getExternalInterface("ZuneMusicPlayer");player.StopStreaming()};MBS.PlaySongInSilverlight=function(a){AudioPlayerPlayMedia(a,5000)};var g_currPlayingTrackId=null;var g_isCurrTrackOn=false;function UpdatePlayerCurrentMediaInfo(h,c,f,d,a){if(audioPlayerMode!=0){return}var k=35;var j=function(m,l){l=l||k;return(m.length>l)?m.substring(0,l)+"...":m};var b=function(l,m){if(m.length>k){return'<li><a href="{0}" title="{1}">{2}</a></li>'.format(l,m,j(m))}else{return'<li><a href="{0}">{1}</a></li>'.format(l,m)}};var g=[];g.push(b(c,h));g.push(b(d,f));$("#LxDashboardSongInfo").empty().append(g.join("")).newsTicker();UpdateCurrentlyPlayingImages(a,true)}function UpdateCurrentlyPlayingImages(c,d){if(audioPlayerMode!=0){return}g_currPlayingTrackId=c;g_isCurrTrackOn=d;var a=$("img");for(i=0;i<a.length;i++){var b=a[i].lxMbs;if(b!=undefined&&b!=null){b.SetImageState(false)}}}function AddEpisodeToMyTv(f,b,a){if(!Auth.validateTicket()){setRedirectAddToMyTvElementIdCookie(f);return false}ResetMyTvVersion();toggleMyTvEpisodeButton(true,f,b,a);UpdateSeasonListControlAddToMyTv(true,f);var c="/profile/AddToMyTv.ashx";var d={mediaId:f,mediaType:b};Ajax.PostAsyncWithSilentLoad(c,d,getEl(a),null);return false}function setFavorite(j,a){function h(l,o){for(var m=0;m<f.length;m++){var k=f[m];k.title=LocStr.lxUtilResources.FavoriteTooltip.format(o.songTitle)}}var g=document.getElementById(a);var f=[];if(Auth.validateTicket()){if(g!=null){var b=document.createElement("IMG");b.style.paddingTop="4px";b.style.paddingLeft="7px";b.style.paddingRight="7px";b.src="/xweb/lx/pic/mbs/check.gif";b.alt=LocStr.lxUtilResources.FavoriteButton;b.height=10;b.width=12;g.innerHTML="";g.appendChild(b);g.onclick=function(){return false};g.href="#";g.title="";if(isIE()){g.style.paddingBottom="4px"}f.push(b)}}var c="/profile/SetFavPost.ashx";var d={aid:j};Ajax.PostAsyncWithSilentLoad(c,d,getEl(a),h);return false}function RemoveEpisodeFromMyTv(f,b,a){var c="/profile/AddToMyTv.ashx";var d={mediaId:f,action:"remove"};ResetMyTvVersion();Ajax.PostAsyncWithSilentLoad(c,d,getEl(a),null);toggleMyTvEpisodeButton(false,f,b,a);UpdateSeasonListControlAddToMyTv(false,f);return false}function toggleMyTvEpisodeButton(j,b,k,a){var f=document.getElementsByName(a);for(var g=0;g<f.length;g++){var c=f[g];var h="";var d="";if(j){h=c.getAttribute("RemoveFromMyTvText")||"";d=c.getAttribute("RemoveFromMyTvHoverText")||""}else{h=c.getAttribute("AddToMyTvText")||"";d=c.getAttribute("AddToMyTvHoverText")||""}c.innerHTML=h;c.href="#";c.title=d;if(j){c.onclick=function(){return RemoveEpisodeFromMyTv(b,k,a)}}else{c.onclick=function(){return AddEpisodeToMyTv(b,k,a)}}}}function removeFavorite(b,g,a){var d=b.target!=null?b.target:b.srcElement;while(d!=null&&!d.id.endsWith("_ShaddingWrapperDiv")){d=d.parentNode}if(d!=null){d.style.display="none";d.parentNode.removeChild(d)}var c="/profile/SetFavPost.ashx";var f={aid:g,action:"remove"};Ajax.PostAsyncWithSilentLoad(c,f,getEl(a),null);return false}var g_BuyDialog;function BuyButton(f,a,b){HideBuyButton();g_BuyDialog=document.createElement("DIV");g_BuyDialog.className="LxMediaButtonConfirmSearch";var j=findPosition(f);var d=j.top+f.offsetHeight;if(d<0){d=0}g_BuyDialog.style.top=d+"px";var c=j.left-250+f.offsetWidth;if(c<0){c=0}g_BuyDialog.style.left=c+"px";var h=document.createElement("DIV");h.innerHTML=(b=="0")?LocStr.lxUtilResources.BuyButtonRedirectNotAvailable:LocStr.lxUtilResources.BuyButtonRedirectNoMarketplace;h.className="LxMediaButtonText alignLeft";g_BuyDialog.appendChild(h);h=document.createElement("DIV");h.className="LxMediaButtonText alignCenter";g_BuyDialog.appendChild(h);h.appendChild(CreateButton(LocStr.lxUtilResources.Yes,YesBuyButton,a));var g=document.createTextNode(" ");h.appendChild(g);h.appendChild(CreateButton(LocStr.lxUtilResources.No,NoBuyButton,"#"));document.body.appendChild(g_BuyDialog);return false}function YesBuyButton(){HideBuyButton();return true}function NoBuyButton(){HideBuyButton();return false}function HideBuyButton(){if(g_BuyDialog){document.body.removeChild(g_BuyDialog);g_BuyDialog=null}return false}function CreateButton(d,c,a){var b=document.createElement("A");b.className="LxButtonCommon LxCommentButton LxMediaButtonButton";b.href=a;b.onclick=c;b.innerHTML=d;return b}function playPreview(a){function d(f,g){if(g_useSilverlightForSongPlays=="true"){AudioPlayerStopMedia()}player=getExternalInterface("ZuneMusicPlayer");player.Url=g.location+g.resource;var j=g.location;var h=g.resource;player.PlayStreaming(j,h)}if(a){var b="1033";var c={PreviewId:a,Lcid:b};Ajax.GetAsync("/zcard/getmp3jsonservice.ashx",c,null,d)}}var SubmitPodcastPopup={data:{title:LocStr.lxUtilResources.PodcastSubmitTitle,buttons:[{id:"PodcastSubmitButton",name:LocStr.lxUtilResources.Submit,behavior:"SubmitPodcast();"},{id:"PodcastCancelButton",name:LocStr.lxUtilResources.Cancel,behavior:"popup.hide();"}],getHeader:function(){var a=[];a.push('<div class="dialogWrapper">');a.push('<a onclick="popup.hide();" href="#" class="closeIcon"><img height="16" width="16" alt="Close Icon" src="/xweb/lx/pic/ico_circ_remove.png"/></a><h2 id="popTitle" class="LxPopupHeader">{0}</h2>'.format(this.title));return a.join("")},getBody:function(){var a=[];a.push('<div id="popBody" class="dialogBody">');a.push(LocStr.lxUtilResources.PodcastSubmitBodyText);a.push('<input type="text" id="PodcastUrl" value="'+LocStr.lxUtilResources.PodcastSubmitInputText+'"  size="88">');a.push('<div id="PodcastMsg" style="color:Red;"> </div>');a.push("</div>");return a.join("")},getFooter:function(){var b=[];b.push('<div style="display:none;" id="Div1"></div>');b.push('<div id="popFooter" class="LxPopupFooter ButtonWrapper">');for(var a=0;a<this.buttons.length;a++){b.push('<a href="#" class="btn pink {0}" onclick="{1}" id="{3}"><span class="btntip"></span><span class="btntext">{2}</span></a>'.format((a==0)?"popupButtonFirst":"popupButton",this.buttons[a].behavior,this.buttons[a].name,this.buttons[a].id))}b.push("</div>");b.push("</div>");return b.join("")}}};function isUrl(a){var b=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/i;return b.test(a)}function SubmitPodcast(){var f=getEl("PodcastUrl");var b=getEl("PodcastMsg");var c=getEl("PodcastSubmitButton");var a=getEl("PodcastCancelButton");if(!isUrl(f.value)){b.innerHTML=LocStr.lxUtilResources.PodcastSubmitErrorInvalidUrl}else{b.innerHTML=LocStr.lxUtilResources.PleaseWait;c.disabled=true;a.disabled=true;f.disabled=true;var g="/podcasts/PodcastSubmit.ashx";var d={podcastUrl:f.value};Ajax.GetAsync(g,d,null,ResponseHandler,g)}}function ResponseHandler(a,f){var g=getEl("PodcastUrl");var c=document.getElementById("PodcastMsg");var d=getEl("PodcastSubmitButton");var b=getEl("PodcastCancelButton");if(a==200){popup.hide()}else{c.innerHTML=f;d.disabled=false;b.disabled=false;g.disabled=false}}function ReportAConcernResponseHandler(a,g){var d=getEl("Email");var c=getEl("ReportAConcernMsg");var f=getEl("PodcastSubmitButton");var b=getEl("PodcastCancelButton");if(a==200){c.innerHTML="";alert(g);popup.hide()}else{c.innerHTML=g;d.disabled=false;f.disabled=false;b.disabled=false}}function ReportAConcern(){var j=getEl("Email");var b=getEl("PodcastSubmitButton");var g=getEl("PodcastCancelButton");var a=getEl("ReportAConcernMsg");j.disabled=true;b.disabled=true;g.disabled=true;a.innerHTML=LocStr.lxUtilResources.PleaseWait;var h=getEl("ReportAConcernForm");var f="1";for(var c=1;c<h.elements.length;c++){if(h.elements[c].checked){f=h.elements[c].value}}var m=new URI(location.href);var d=m.queryString("serid");var k="methodName=ReportConcern&names=MediaId&values="+d+"&names=ConcernId&values="+f+"&names=ConcernText&values="+j.value.encodeURI();var l="http://catalog.xboxlive.com/Catalog/Catalog.asmx/Query";var o=Ajax.GetAsync(l,k,null,ReportAConcernResponseHandler,l)}var ReportAConcernPopup={data:{title:LocStr.lxUtilResources.PodcastReportAConcernTitle,buttons:[{id:"PodcastSubmitButton",name:LocStr.lxUtilResources.Submit,behavior:"ReportAConcern();"},{id:"PodcastCancelButton",name:LocStr.lxUtilResources.Cancel,behavior:"popup.hide();"}],getHeader:function(){return'<div id="popTitle" class="LxPopupHeader">{0}</div>'.format(this.title)},getBody:function(){var a=[];a.push('<div id="popBody" class="LxPopupBody">');a.push(LocStr.lxUtilResources.PodcastReportAConcernEmailHeader);a.push('<br><form id="ReportAConcernForm">');a.push('<input type="text" name="Email" value="Type email"  size=100 /><br/>');a.push("Your Concern:<br>");a.push('<input name="PodcastConcern" type="radio" checked="checked" value="1" />'+LocStr.lxUtilResources.PodcastReportAConcern1+"<br/>");a.push('<input name="PodcastConcern" type="radio" value="2" />'+LocStr.lxUtilResources.PodcastReportAConcern2+"<br/>");a.push('<input name="PodcastConcern" type="radio" value="3" />'+LocStr.lxUtilResources.PodcastReportAConcern3+"<br/>");a.push('<input name="PodcastConcern" type="radio" value="4" />'+LocStr.lxUtilResources.PodcastReportAConcern4+"<br/>");a.push('<input name="PodcastConcern" type="radio" value="5" />'+LocStr.lxUtilResources.PodcastReportAConcern5+"<br/>");a.push('<input name="PodcastConcern" type="radio" value="6" />'+LocStr.lxUtilResources.PodcastReportAConcern6+"<br/>");a.push("</form>");a.push('<div id="Div2"><br/>'+LocStr.lxUtilResources.PodcastReportAConcernFooterText+'<a target="_blank" href="http://www.microsoft.com/info/cpyrtinfrg.htm">http://www.microsoft.com/info/cpyrtinfrg.htm</a></div>');a.push('<div id="ReportAConcernMsg" style="color:Red;"> </div>');a.push("</div>");return a.join("")},getFooter:function(){var b=[];b.push('<div style="display:none;" id="Div1"></div>');b.push('<div id="popFooter" class="LxPopupFooter LxPopupButtons">');for(var a=0;a<this.buttons.length;a++){b.push('<input type="button" class="LxButtonCommon {0}" onclick="{1}" value="{2}" id="{3}" />'.format((a==0)?"popupButtonFirst":"popupButton",this.buttons[a].behavior,this.buttons[a].name,this.buttons[a].id))}b.push("</div>");return b.join("")}}};function NavigateToPodcastGallery(c,b,d,f){var a="SeriesGallery.aspx?Genre="+c;if(b!=null&&b!=""){a+="&SubGenre="+b}if(d!=null){if(d==""){d="SubscriptionRank"}a+="&Sort="+d}if(f!=null){if(f==""){f="all"}a+="&Filter="+f}window.location=a}function NavigateToPodcastSeriesDetailPage(a){window.location="/podcasts/Series.aspx?serid="+a.getAttribute("itemId")}var podcastPlayerDefaultUrl=null;var podcastPlayerDefaultTitle=null;var pocastPlayerControl=null;var podcastPlayerCurrentState=-1;var podcastPlayerCurrentItem=null;var podcastPlayerImagePath="/xweb/lx/pic/mbs/";function onPodcastPlayerLoad(b,c,a){if(b.Content){pocastPlayerControl=b.Content.PocastPlayerControl}if(pocastPlayerControl!=null){if(podcastPlayerDefaultUrl!=null){pocastPlayerControl.PlayMedia(podcastPlayerDefaultUrl,podcastPlayerDefaultTitle)}pocastPlayerControl.addEventListener("PlayerStateChanged",onPodcastPlayerStateChanged)}}function onPodcastPlayerStateChanged(b,a){podcastPlayerCurrentState=a.PlayerState;switch(a.PlayerState){case 3:showActivePauseButton(podcastPlayerCurrentItem);podcastPlayerCurrentItem.title=LocStr.lxUtilResources.ClickToPause.expandTokens({TITLE:podcastPlayerDefaultTitle});break;case 4:showActivePlayButton(podcastPlayerCurrentItem);podcastPlayerCurrentItem.title=LocStr.lxUtilResources.ClickToPlay.expandTokens({TITLE:podcastPlayerDefaultTitle});break}}function setPlayButtonImage(a,b){if(podcastPlayerCurrentItem==a){if(b){if(podcastPlayerCurrentState==3){showHoverPauseButton(a)}else{showHoverPlayButton(a)}}else{if(podcastPlayerCurrentState==3){showActivePauseButton(a)}else{showActivePlayButton(a)}}}if(podcastPlayerCurrentItem!=a){if(b){showHoverPlayButton(a)}else{showActivePlayButton(a)}}}function playOrPause(a,b,c){if(podcastPlayerCurrentItem==null){StartPodcastPlayer(a,b,c)}else{showActivePlayButton(podcastPlayerCurrentItem,podcastPlayerDefaultTitle);if(podcastPlayerCurrentItem!=a){pocastPlayerControl.PlayMedia(b,c)}else{if(podcastPlayerCurrentState==3){pocastPlayerControl.PauseMedia()}else{pocastPlayerControl.PlayMedia()}}podcastPlayerCurrentItem=a;podcastPlayerDefaultUrl=b;podcastPlayerDefaultTitle=c}}function showActivePlayButton(a,b){if(a!=null){a.src=podcastPlayerImagePath+"play_active.gif";if(b!=null){a.title=LocStr.lxUtilResources.ClickToPlay.expandTokens({TITLE:b})}}}function showActivePauseButton(a,b){if(a!=null){a.src=podcastPlayerImagePath+"pause_active.gif";if(b!=null){a.title=LocStr.lxUtilResources.ClickToPause.expandTokens({TITLE:podcastPlayerDefaultTitle})}}}function showHoverPlayButton(a){if(a!=null){a.src=podcastPlayerImagePath+"play_hover.gif"}}function showHoverPauseButton(a){if(a!=null){a.src=podcastPlayerImagePath+"pause_hover.gif"}}function showPodcastPlayer(){document.getElementById("PocastPlayerHost").style.visibility="visible"}function hidePodcastPlayer(){document.getElementById("PocastPlayerHost").style.visibility="hidden"}function StartPodcastPlayer(a,b,c){podcastPlayerCurrentItem=a;podcastPlayerDefaultUrl=b;podcastPlayerDefaultTitle=c;if(pocastPlayerControl!=null){pocastPlayerControl.PlayMedia(podcastPlayerDefaultUrl,podcastPlayerDefaultTitle)}showPodcastPlayer()}function podcastExpando(a){var b=getEl(a);if(b!=null){b.style.display=b.style.display=="none"?"block":"none"}}function tileDialog(){var dialogDiv=null;var showTimerId=null;var hideTimerId=null;var showDialogDelay=500;var hideDialogDelay=500;var widthToIncrease=20;tileDialog.tileMouseOver=function(obj,type){obj.active=true;if(showTimerId){window.clearTimeout(showTimerId);showTimerId=null}function show(){showTileDialog(obj,type)}showTimerId=window.setTimeout(show,showDialogDelay);return false};tileDialog.tileMouseOut=function(obj){obj.active=false;hideWait()};function loadUserInfo(tag,callback){var url="/xweb/lx/GetAboutMe.ashx?zunetag="+tag.encodeURI();Ajax.GetAsync(url,null,null,callback,url)}function hideWait(){if(showTimerId){window.clearTimeout(showTimerId);showTimerId=null}var hideTileDialog=function(){mouseSelect()};hideTimerId=window.setTimeout(hideTileDialog,hideDialogDelay)}function GetUserInfo(obj){if(!obj.aboutMe){obj.aboutMe=eval("("+obj.getAttribute("UserInfo")+")")}if(!obj.aboutMe){var arr=obj.src.split("/");var tag=arr[arr.length-1];obj.aboutMe={tag:tag}}return obj.aboutMe}function showTileDialog(obj,type){if(!dialogDiv){var body=document.getElementsByTagName("BODY")[0];dialogDiv=createTileDialog();body.appendChild(dialogDiv)}var json=GetUserInfo(obj);function callback(status,response){if(type&&type=="toplistener"){response.rank=json.rank;response.playCount=json.playCount}var imgs=document.getElementsByTagName("IMG");for(var i=0;i<imgs.length;i++){if(imgs[i].getAttribute("zunetag")==response.tag){imgs[i].aboutMe=response}}if(obj.active){if(initTileDialog(response,type)){showDialog()}}}if(typeof json.name=="undefined"||typeof json.location=="undefined"){loadUserInfo(json.tag,callback);return false}if(initTileDialog(json,type)){showDialog()}}function cancelHide(){if(hideTimerId){window.clearTimeout(hideTimerId)}for(var o in this.childNodes){o.onmouseover=cancelHide}}function createTileDialog(){var el=document.createElement("div");el.id="tileDialog";el.style.display="none";el.style.position="absolute";el.style.zIndex=1000;el.onmouseover=cancelHide;el.onmouseout=hideWait;return el}function showDialog(){var topSpace,rightSpace,bottomSpace,leftSpace;var xOffset,yOffset;topSpace=yMousePos-document.documentElement.scrollTop;bottomSpace=yMousePosMax-yMousePos;leftSpace=xMousePos-document.documentElement.scrollLeft;rightSpace=xMousePosMax-xMousePos;dialogDiv.style.display="";dialogDiv.style.left="-2000px";dialogDiv.style.top="-2000px";var elHeight=dialogDiv.offsetHeight;var elWidth=dialogDiv.offsetWidth;var elIncreasedWidth=elWidth+widthToIncrease;if(rightSpace>elIncreasedWidth){xOffset=5;dialogDiv.innerHTML+='<img src="/xweb/lx/pic/tooltipb1.gif" class="bottomLeft" />'}else{xOffset=-1*(elWidth+5);dialogDiv.innerHTML+='<img src="/xweb/lx/pic/tooltipb2.gif" class="bottomRight" />'}yOffset=-1*(elHeight+5);function show(){showElementAtMouse("tileDialog",xOffset,yOffset)}window.setTimeout(show,50)}function initTileDialog(json,type){var html=[],topListener=(type&&type=="toplistener");if(topListener){html.push('<div class="rank">');html.push(json.rank);html.push("</div>")}html.push('<div class="body">');html.push('<div class="zuneTag">');html.push(json.tag);html.push("</div>");html.push('<div class="nameLoc">');if(json.name){html.push(json.name.encodeHtml());if(json.location){html.push(" "+LocStr.lxUtilResources.From+" ")}}if(json.location){html.push(json.location.encodeHtml())}html.push("</div>");if(topListener){html.push('<div class="playCount">');html.push(json.playCount+" "+LocStr.lxUtilResources.Plays);html.push("</div>")}html.push("</div>");html.push('<div class="clearBoth"></div>');dialogDiv.innerHTML=html.join("");return true}}tileDialog();$ExpBase=function(){var a=fn={_config:{inited:false,cro:false,prefix:"http",obsMap:{}},_commonRoData:{},init:function(c){$.extend(true,a._config,c);try{a._commonRoData.pageId=a._config.pageId}catch(b){}try{a._commonRoData.pageCategory=a._config.pageCategory}catch(b){}try{a._commonRoData.c=navigator.appName=="Netscape"?navigator.language:navigator.userLanguage}catch(b){}try{a._commonRoData.hasZunePass=Cookie.get(a._config.expCtxHasZunePassCookie)}catch(b){}if($("body").hasClass("SignedIn")){a._commonRoData.signedIn="true"}else{a._commonRoData.signedIn="false"}if(window.location.href.startsWith("https")){a._config.prefix="https"}try{a._commonRoData.euid=Cookie.get(a._config.idCookie)}catch(b){}try{a._commonRoData.pageUrl=window.location.href}catch(b){}try{a._commonRoData.referrerUrl=document.referrer}catch(b){}a._config.inited=true},ro:function(d,f){if(!a._config.inited||!a._config.cro||!a._config.obsMap[d]){return}var c=$.extend({},a._commonRoData,f);c.rand=Math.floor(Math.random()*1000000);var b="{0}://{1}?{2}".format(a._config.prefix,a._config.obsMap[d],$.param(c));a._asyncFire(b)},_asyncFire:function(b){try{var c=new Image(1,1);c.onload=c.onerror=function(){c.onload=c.onerror=null};c.src=b}catch(d){}}};return fn};ExpBase=new $ExpBase();$ExpClickBindings=function(){var a=".ectForce",j="a:not(.ectIgnore)",k="img:not(.ectIgnore)",c="{0},{1},{2}".format(a,j,k),b="ectWeight",h="ectLoc",g="ectLinkClick",m="ectCustomClick",f="Click";var l=function(q){q=$(q);var p=q.parents("[id],[class]");var o="";p.each(function(s,r){o=o+";"+($(r).attr("id")||$(r).attr("class"));return true});return o};var d=fn={init:function(o){o?d.ready(null,o):$(document).ready(d.ready)},ready:function(o,p){p=p||document.body;$(c,p).bind("click",{obsName:f,t:g,ff:d.defaultFilterFunc,df:d.defaultDataFunc},d.action).attr("ect",1)},defaultFilterFunc:function(q){var p=q.target,o=q.currentTarget;return !(p!=o&&$(p).attr("ect"))},defaultDataFunc:function(q){var p=$(q.currentTarget);var r={};if(p.attr(b)){r.linkWeight=p.attr(b)}else{r.linkWeight=1}if(p.attr(h)){r.linkLocation=p.attr(h)}else{r.linkLocation=l(p)}var o=p.find(k+":first");r.linkId=p.attr("id")||p.attr("class");if(!r.linkId&&p.is(j)&&o.size()>0){r.linkId=o.attr("id")||o.attr("class")}r.linkText=trim(p.text())||p.attr("title")||p.attr("alt");if(!r.linkText&&p.is(j)&&o.size()>0){r.linkText=trim(o.text())||o.attr("title")||o.attr("alt")}r.linkUrl=p.attr("href");r.src="html";return r},bind:function(p,r,q,o){$(p).bind(r,{obsName:f,t:m,ff:q,df:o},d.action).attr("ect",1)},action:function(o){try{var p=o.data;if(!p.ff(o)){return}var r=p.df(o);if(d._allowRO(r.linkText)&&d._allowRO(r.linkUrl)){ExpBase.ro(p.obsName,r)}}catch(q){}},_allowRO:function(o){return true},cloneEvent:function(p){var o={};for(var q in p){o[q]=p[q]}return o}};return fn};new $ExpClickBindings().init();function expSilverlightRO(){var b=arguments[0];var c={};for(var a=1;a<arguments.length;a+=2){c[arguments[a]]=arguments[a+1]}c.src="sl";ExpBase.ro(b,c)}function closeMixView(){MBS.StopPlayer();if(popup&&typeof(popup.hide)=="function"){popup.hide()}}if(!window.Silverlight){window.Silverlight={}}Silverlight._silverlightCount=0;Silverlight.fwlinkRoot="http://go2.microsoft.com/fwlink/?LinkID=";Silverlight.onGetSilverlight=null;Silverlight.onSilverlightInstalled=function(){window.location.reload(false)};Silverlight.isInstalled=function(l){var o=false;var a=null;try{var g=null;try{g=new ActiveXObject("AgControl.AgControl");if(l==null){o=true}else{if(g.IsVersionSupported(l)){o=true}}g=null}catch(k){var h=navigator.plugins["Silverlight Plug-In"];if(h){if(l===null){o=true}else{var b=h.description;if(b==="1.0.30226.2"){b="2.0.30226.2"}var c=b.split(".");while(c.length>3){c.pop()}while(c.length<4){c.push(0)}var d=l.split(".");while(d.length>4){d.pop()}var m;var f;var j=0;do{m=parseInt(d[j]);f=parseInt(c[j]);j++}while(j<d.length&&m===f);if(m<=f&&!isNaN(m)){o=true}}}}}catch(k){o=false}if(a){document.body.removeChild(a)}return o};Silverlight.WaitForInstallCompletion=function(){if(!Silverlight.isBrowserRestartRequired&&Silverlight.onSilverlightInstalled){try{navigator.plugins.refresh()}catch(a){}if(Silverlight.isInstalled(null)){Silverlight.onSilverlightInstalled()}else{setTimeout(Silverlight.WaitForInstallCompletion,3000)}}};Silverlight.__startup=function(){Silverlight.isBrowserRestartRequired=Silverlight.isInstalled(null);if(!Silverlight.isBrowserRestartRequired){Silverlight.WaitForInstallCompletion()}if(window.removeEventListener){window.removeEventListener("load",Silverlight.__startup,false)}else{window.detachEvent("onload",Silverlight.__startup)}};if(window.addEventListener){window.addEventListener("load",Silverlight.__startup,false)}else{window.attachEvent("onload",Silverlight.__startup)}Silverlight.createObject=function(a,l,c,j,o,g,h){var p=new Object();var d=j;var m=o;p.version=d.version;d.source=a;p.alt=d.alt;if(g){d.initParams=g}if(d.isWindowless&&!d.windowless){d.windowless=d.isWindowless}if(d.framerate&&!d.maxFramerate){d.maxFramerate=d.framerate}if(c&&!d.id){d.id=c}delete d.ignoreBrowserVer;delete d.inplaceInstallPrompt;delete d.version;delete d.isWindowless;delete d.framerate;delete d.data;delete d.src;delete d.alt;if(Silverlight.isInstalled(p.version)){for(var b in m){if(m[b]){if(b=="onLoad"&&typeof m[b]=="function"&&m[b].length!=1){var k=m[b];m[b]=function(q){return k(document.getElementById(c),h,q)}}var f=Silverlight.__getHandlerName(m[b]);if(f!=null){d[b]=f;m[b]=null}else{throw"typeof events."+b+" must be 'function' or 'string'"}}}slPluginHTML=Silverlight.buildHTML(d)}else{slPluginHTML=Silverlight.buildPromptHTML(p)}if(l){l.innerHTML=slPluginHTML}else{return slPluginHTML}};Silverlight.buildHTML=function(c){var b=[];b.push('<object type="application/x-silverlight" data="data:application/x-silverlight,"');if(c.id!=null){b.push(' id="'+c.id+'"')}if(c.width!=null){b.push(' width="'+c.width+'"')}if(c.height!=null){b.push(' height="'+c.height+'"')}b.push(" >");delete c.id;delete c.width;delete c.height;for(var a in c){if(c[a]){b.push('<param name="'+Silverlight.HtmlAttributeEncode(a)+'" value="'+Silverlight.HtmlAttributeEncode(c[a])+'" />')}}b.push("</object>");return b.join("")};Silverlight.createObjectEx=function(c){var b=c;var a=Silverlight.createObject(b.source,b.parentElement,b.id,b.properties,b.events,b.initParams,b.context);if(b.parentElement==null){return a}};Silverlight.buildPromptHTML=function(b){var d="";var c=Silverlight.fwlinkRoot;var a=b.version;if(b.alt){d=b.alt}else{if(!a){a=""}d="<a href='#' onclick='Silverlight.getSilverlight(\"{1}\");return false;' style='text-decoration: none;'><img src='{2}' alt='Get Microsoft Silverlight' style='border-style: none'/></a>";d=d.replace("{1}",a);d=d.replace("{2}",c+"108181")}return d};Silverlight.getSilverlight=function(c){if(Silverlight.onGetSilverlight){Silverlight.onGetSilverlight()}var a="";var f=String(c).split(".");if(f.length>1){var d=parseInt(f[0]);if(isNaN(d)||d<2){a="1.0"}else{a=f[0]+"."+f[1]}}var b="";if(a.match(/^\d+\056\d+$/)){b="&v="+a}Silverlight.followFWLink("114576"+b)};Silverlight.followFWLink=function(a){top.location=Silverlight.fwlinkRoot+String(a)};Silverlight.HtmlAttributeEncode=function(b){var f;var d="";if(b==null){return null}for(var a=0;a<b.length;a++){f=b.charCodeAt(a);if(((f>96)&&(f<123))||((f>64)&&(f<91))||((f>43)&&(f<58)&&(f!=47))||(f==95)){d=d+String.fromCharCode(f)}else{d=d+"&#"+f+";"}}return d};Silverlight.default_error_handler=function(b,a){var c;var f=a.ErrorType;c=a.ErrorCode;var d="\nSilverlight error message     \n";d+="ErrorCode: "+c+"\n";d+="ErrorType: "+f+"       \n";d+="Message: "+a.ErrorMessage+"     \n";if(f=="ParserError"){d+="XamlFile: "+a.xamlFile+"     \n";d+="Line: "+a.lineNumber+"     \n";d+="Position: "+a.charPosition+"     \n"}else{if(f=="RuntimeError"){if(a.lineNumber!=0){d+="Line: "+a.lineNumber+"     \n";d+="Position: "+a.charPosition+"     \n"}d+="MethodName: "+a.methodName+"     \n"}}alert(d)};Silverlight.__cleanup=function(){for(var a=Silverlight._silverlightCount-1;a>=0;a--){window["__slEvent"+a]=null}Silverlight._silverlightCount=0;if(window.removeEventListener){window.removeEventListener("unload",Silverlight.__cleanup,false)}else{window.detachEvent("onunload",Silverlight.__cleanup)}};Silverlight.__getHandlerName=function(b){var a="";if(typeof b=="string"){a=b}else{if(typeof b=="function"){if(Silverlight._silverlightCount==0){if(window.addEventListener){window.addEventListener("onunload",Silverlight.__cleanup,false)}else{window.attachEvent("onunload",Silverlight.__cleanup)}}var c=Silverlight._silverlightCount++;a="__slEvent"+c;window[a]=b}else{a=null}}return a};function serializeObject(b){var a=[];for(var c in b){a.push(c+":");a.push(b[c]);a.push("\n")}return(a.join(""))}(function(){sfHover=function(){var a=$(".DropDownButton li.button").hover(function(c){$(this).toggleClass("sfhover",0);var b=$ExpClickBindings().cloneEvent(c);b.data={obsName:"Hover",ff:$ExpClickBindings().defaultFilterFunc,df:$ExpClickBindings().defaultDataFunc};$ExpClickBindings().action(b)},function(){$(this).toggleClass("sfhover",0)})};setUserBackgroundImage=function(a){$("#userBg").attr("src",a)};artistViewImg=function(){var c,g,b=0,k=350,d=250,h={};function f(){return document.createElement("img")}function a(o,m){var l=m||$(o.target).attr("src");c.fadeOut(d,function(){c.attr("src",l);c.fadeIn(k)})}function j(p){var o=$(this),m=o.attr("href");var l={visibility:"visible",height:"1px",width:"1px",position:"absolute",left:"-3000px",top:"-3000px",zIndex:"-1"};if(h[m]){a(null,m)}else{h[m]=$(f()).appendTo($("#_artistImages")).css(l).attr("src",m).load(a)}}this.init=function(){$(".overviewThumb").click(j);c=$(".artistOverviewImage");g=$(".overviewThumb",".artistOverviewImages");if(c){c.fadeIn(k)}}};$(document).ready(function(){$artistViewImg=new artistViewImg().init();sfHover()})}());function pagerButtonImageSwap(b,a){b.src=a}String.prototype.maskValue=function(d){var g=this,f="",a=d.length,b=g;for(var c=0;c<b.length;++c){f+=String.fromCharCode(d.charCodeAt((c)%a)^b.charCodeAt(c))}return $.base64Encode(f)};String.prototype.unmaskValue=function(d){var g=this,f="",a=d.length,b=$.base64Decode(g);for(var c=0;c<b.length;c++){f+=String.fromCharCode(d.charCodeAt((c)%a)^b.charCodeAt(c))}return f};function zAjax(c,a,f,g,d,b){this.url=c;this.blockid=a;if(a){this.block=typeof a=="string"?$("#"+a):$(a)}this.data=f;this.callback=g;this.xkey=d;this.dataType=b}zAjax.showStockBusyMessage=function(b){var a='<div id="LxAjaxBusyMessage">';a+=LocStr.lxUtilResources.AjaxBusyMessage;a+="</div>";zAjax.showErrorPage(a,b)};zAjax.showStockError=function(a){zAjax.showErrorString(LocStr.lxUtilResources.AjaxGeneralError,a)};zAjax.showErrorString=function(c,b){var a='<div id="LxAjaxInlineError">';a+=c;a+="</div>";zAjax.showErrorPage(a,b)};zAjax.showErrorPage=function(b,c){if(!c||!b){return}var a=zAjax.findAjaxErr(c);if(a){a.html(b).show()}};zAjax.dismissError=function(b){var a=zAjax.findAjaxErr(b);if(a){a.hide()}};zAjax.doConcurrencyCheck=function(a,b){if(!a){return true}if(jQuery.inArray(a,zAjax.PendingFragments)>-1){zAjax.showErrorString(LocStr.lxUtilResources.AjaxAlreadyInProgress,b);return false}zAjax.PendingFragments.push(a);return true};zAjax.onAjaxFinished=function(){if(this.timerid){window.clearTimeout(this.timerid);this.timerid=null}zAjax.PendingFragments.remove(this.xkey);zAjax.dismissError(this.block)};zAjax.protocol={sourceUrl:"lx-ajax-source",authUrl:"lx-ajax-auth-url",status:"lx-ajax-status",errInline:"error/inline",redirect:"lx-ajax-location",redirectTop:"lx-ajax-topLocation"};zAjax.PendingFragments=[];zAjax.findAjaxErr=function(b){b=typeof b=="string"?$("#"+b):$(b);var a;while(b&&b[0]){a=$("#ajaxErr",b)[0];if(a){return $(a)}b=b.parent()}return null};zAjax.post=function(c,a,f,h,d,b){var g=new zAjax(c,a,f,h,d,b);g.send("POST")};zAjax.get=function(b,a,d,g,c){var f=new zAjax(b,a,d,g,c);f.send()};zAjax.prototype.ConcurrencyCheck=function(){return zAjax.doConcurrencyCheck(this.xkey,this.block)};zAjax.prototype.send=function(c){if(!this.ConcurrencyCheck()){window.clearTimeout(this.timerid);return}c=c||"GET";var d=this;function a(){d.timerid=null;zAjax.showStockBusyMessage(d.block)}if(this.block){this.timerid=window.setTimeout(a,500)}var b={type:c,url:this.url,data:this.data,dataType:this.dataType||"html",beforeSend:function(f){f.setRequestHeader(zAjax.protocol.sourceUrl,window.location.href)},success:function(h,j,f){var g=f.getResponseHeader(zAjax.protocol.redirect);if(g){window.location.href=g;return}g=f.getResponseHeader(zAjax.protocol.redirectTop);if(g){window.top.location.href=g;return}zAjax.onAjaxFinished.call(d);if(d.callback){d.callback(h,j)}if("undefined"!=typeof $Bindings){$Bindings.reinitall()}},error:function(g,k,h){zAjax.onAjaxFinished.call(d);switch(g.status){case 401:case 441:window.location=g.getResponseHeader(zAjax.protocol.authUrl);return;case 0:break;default:var j=g.getResponseHeader("Content-Type");var f=g.getResponseHeader(zAjax.protocol.status);if(f==Ajax.protocol.errInline){if(j.indexOf("html")>=0){zAjax.showErrorPage(g.responseText,d.block)}else{zAjax.showErrorString(LocStr.lxUtilResources.AjaxInternalError,d.block)}}else{zAjax.showStockError(d.block)}return}}};$.ajax(b)};function ajaxLoader(a,c,d,b,f){ajaxLoaderEx(a,c,d,b,false,f)}function ajaxLoaderEx(s,h,o,g,q,k){q=q||false;var m={},a="~*";function r(w,v){$("#"+s).html(w);if(k){k()}}function l(w,v){$("#"+s).html(w);if("undefined"!=typeof $Bindings){$Bindings.reinitall($("#"+s))}}if(s&&o){m.action=o;var j=Cookie.get("BSID");if(typeof(g)!="undefined"){for(var p=0;p<g.length;p++){var c=$("#"+g[p]);if(c){if(c.attr("tagName")=="FORM"&&c.serialize()){var f=c.serialize().split("&");for(var p=0;p<f.length;p++){var d=f[p].split("=");m[d[0]]=d[1]}}else{if(c.attr("type")=="radio"){var u=c.attr("name");if(c.attr("checked")==true){m[u]=c.attr("value")}else{var b=$("input[name='"+u+"']:checked").val();if(b){m[u]=b}}}else{if(c.attr("type")=="checkbox"){if(c.attr("checked")==true){m[g[p]]=c.attr("value")}}else{var t=c.attr("value");if(t!=""){if(q&&j!=""){m[g[p]]=((t+"").maskValue(j))+a}else{m[g[p]]=t}}}}}}}}zAjax.post(h,s,m,r,s)}else{if(s&&h&&!o){zAjax.get(h,s,"",l,s)}}return false}function setPageTitle(a){document.title=a}function setFocus(a){if($.browser.msie){setTimeout("$('#"+a+"').focus()",1000)}else{$("#"+a).focus()}}(function(a){a(window).ready(function(){var b=a(".page_Music_Landing .NarrowerColumn #_ccm");if(b[0]&&b[0].innerHTML==""){a("#_mostActive").css({marginTop:"0px",paddingTop:"0px"})}var b=a("#_ccmBlock");if(b[0]&&a.trim(b[0].innerHTML)==""){b.css({display:"none"})}var b=a("#_rn .NarrowerColumn #_editorialBlockRight1");if(b[0]&&b[0].innerHTML==""){b.css({display:"none"})}})})(jQuery);function setSortableBetweenContainers(g,d,b,c,f,a){$(d).sortable({connectWith:g,handle:b,receive:function(j,k){var l=$(d+" "+c)[0];var h=l.cloneNode(true);$(d)[0].removeChild(l);$(g)[0].insertBefore(h,$(f)[0])}});$(g).sortable({connectWith:d,handle:b,receive:function(j,k){var l=$(g+" "+c)[a];var h=l.cloneNode(true);$(g)[0].removeChild(l);if($(d+" "+c)[0]==undefined){$(d)[0].insertBefore(h,$("#emptyArea2")[0])}else{$(d)[0].insertBefore(h,$(d+" "+c)[0])}}})}function setTopDivisionSortable(c,a){$(c).sortable({handle:a});if($(c+" "+a).length<=1){$(c).sortable("disable");var b=$(".LxFanClubBtnGroup");if(b.length>0){$(".LxFanClubBtnGroup")[0].style.display="none"}}}function countFanClubs(){return $("#myFavoriteFanClubs .ArtistImageFC").length}function getLastMediaIdInTopFavs(b){var a="";if(b){if($("#myFavoriteFanClubs #"+b.id).length>0&&$("#myOtherFanClubs .FanClubArtist").length>0){a=$("#myOtherFanClubs .FanClubArtist").attr("fid")}}return a}function formatIntWithSeparator(c,f){c=c+"";if(c.length<=3){return c}c=c.split("");var a=[];for(var d=c.length-1,b=0;d>=0;d--,b++){if(b==3){a.push(f);b=0}a.push(c[d])}return a.reverse().join("")}function leaveFanClub(g,p,l){var r=$(g+" .FansCount span");if(r&&r.length>0){var b=/[^0-9]/gi;var q=r[0].innerHTML;var f=b.exec(q);q=q.replace(b,"");if(p){q--}else{q++}var k=formatIntWithSeparator(q,f);var d;if(q==1){d=$(g+" .FansCount").attr("onefanhtml")}else{d=$(g+" .FansCount").attr("manyfanhtml")}$(g+" .FansCount")[0].innerHTML=d.format(k)}if(!l){return}if($(g)[0].parentNode){if($(g)[0].parentNode.id=="myFavoriteFanClubs"){$("#myFavoriteFanClubs")[0].removeChild($(g)[0]);if($("#myOtherFanClubs")[0]){if($("#myOtherFanClubs .ArtistImageFC").length>0){var c=$("#myOtherFanClubs .FanClubArtist")[0];var m=c.cloneNode(true);$("#myOtherFanClubs")[0].removeChild(c);$("#myFavoriteFanClubs")[0].insertBefore(m,$("#emptyArea1")[0])}if($("#myOtherFanClubs .ArtistImageFC").length==0){var a=$("#myOtherFanClubs")[0].parentNode;a.parentNode.removeChild(a)}}var j=$(".LxFanClubBtnGroup");var h=$(".LxTopFanClubDivHeaderWrapper .desc");if($("#myFavoriteFanClubs .ArtistImageFC").length==1){if(j.length>0){$(".LxFanClubBtnGroup")[0].style.display="none"}if(h.length>0){h[0].style.display="none"}$("#myFavoriteFanClubs").sortable("disable")}else{if($("#myFavoriteFanClubs .ArtistImageFC").length==0){location.href=location.href}}}else{if($(g)[0].parentNode.id=="myOtherFanClubs"){$("#myOtherFanClubs")[0].removeChild($(g)[0]);if($("#myOtherFanClubs .ArtistImageFC").length==0){var a=$("#myOtherFanClubs")[0].parentNode;a.parentNode.removeChild(a)}}}}}function syncJoinFanClubText(b,a,c){var d=$(".LxJoinFanClubModule[fid="+b+"]");if(d.length<=1){return}d.each(function(f){d[f].innerHTML=a;$('input[HideName="hidIsJoinFanClub"]',d[f].parentNode).val(c)})}function saveFanClubs(){$("#hidMyFanClubIds")[0].value=$("#myFavoriteFanClubs").sortable("toArray",{attribute:"fid",key:"fid"});var c=$("#myOtherFanClubs")[0];if(c){c.value=$("#myOtherFanClubs").sortable("toArray",{attribute:"fid",key:"fid"})}var a="/music/LxSaveFanClubsHandler.ashx";var b={mediaIds:$("#hidMyFanClubIds")[0].value+(c?c.value:"")};Ajax.PostAsync(a,b,null,function(){location.href=location.href},null);return false}function cancelFanClubs(){location.href=location.href;return false}function sortFanClub(a){if(a=="Date"){if(!$("#lnkRecentlyJoined").hasClass("Selected")){$("#myOtherFanClubs .FanClubArtist").tsort(".joinDate",{order:"desc"});$("#myFanClubFilter a").toggleClass("Selected")}}else{if(a=="ABC"){if(!$("#lnkAToZ").hasClass("Selected")){$("#myOtherFanClubs .FanClubArtist").tsort(".artistName");$("#myFanClubFilter a").toggleClass("Selected")}}}return false}function noResults(a){popup.hide();$(".noFanClubResults")[0].innerHTML=a;$(".noFanClubResults")[0].style.display="block"}function prepareSortableContainers(a){$(document).ready(function(){setSortableBetweenContainers("#myFavoriteFanClubs","#myOtherFanClubs",".ArtistImageFC",".FanClubArtist","#emptyArea1",a)})}function prepareTopDivisionSortable(){$(document).ready(function(){setTopDivisionSortable("#myFavoriteFanClubs",".ArtistImageFC")})}function subscribeLeaveFanClub(){Trigger.LeaveFanClub.subscribe(function(){if(countFanClubs()==1){location.href=location.href}})}function fanClubSearchAutoComplete(){var a=[];a.push('<div id="LxSmallArtistName{0}" class="LxSmallArtistWrapper">');a.push('<div class="LxSmallArtistImage">');a.push('<img src="{1}"/>');a.push("</div>");a.push('<div class="LxSmallArtistTitle">');a.push("{2}");a.push("</div>");a.push('<div class="LxSmallArtistPlays">');a.push("{3}");a.push("</div>");a.push("</div>");var b=a.join("");$("#txtSearch").autocomplete("/music/LxGetArtistListHandler.ashx",{minChars:3,max:5,selectFirst:true,scroll:false,formatItem:function(f,c,h,d){if(c==1){fanClubSearchAutoComplete.aname=f[0];fanClubSearchAutoComplete.aid=f[2]}var g;g=b.replace(/\{0\}/g,f[0].replace(/ /g,"_").replace(/\./g,"_"));g=g.replace(/\{1\}/g,f[1]);g=g.replace(/\{2\}/g,f[0]);g=g.replace(/\{3\}/g,f[4]);return g},formatResult:function(d,c){return d[0]}}).result(function(c,f,d){if(f){fanClubSearchAutoComplete.aname=f[0];fanClubSearchAutoComplete.aid=f[2];$(".noFanClubResults")[0].style.display="none";return f[0]}else{$(".noFanClubResults")[0].style.display="block";fanClubSearchAutoComplete.aname=null}});$("#txtSearch").keydown(function(c){if(c.keyCode==13){addFanClub(c);this.blur()}$(".noFanClubResults")[0].style.display="none"})}function addFanClub(c){var a=$("#txtSearch")[0].value;if(a.length==0){return false}if(a==fanClubSearchAutoComplete.aname){addFanClubToDB()}else{var b="/xweb/lx/frags/SmallArtistListFrag.aspx?q="+a.encodeURI();popup.showFrag(b,null,"LxSmallArtistPopupFrag",true);if(c&&c.preventDefault){c.preventDefault()}else{window.event.returnValue=false}}}function copyTextToSearch(b){var a=$("#"+b+" .LxSmallArtistTitle").attr("fullartistname");if(a==undefined||a.length==0){a=$("#"+b+" .LxSmallArtistTitle")[0].innerHTML}$("#txtSearch")[0].value=a;fanClubSearchAutoComplete.aname=a;fanClubSearchAutoComplete.aid=$("#"+b).attr("fid");popup.hide()}function addFanClubToDB(){var a="/music/LxSaveFanClubsHandler.ashx";var b={artistId:fanClubSearchAutoComplete.aid};Ajax.PostAsync(a,b,null,function(c,d){if(d.length>0){lxAlert(d)}else{location.href=location.href}},null)}function toggleFollowing(c){var b=$(c),a={obj:b,hasFollowed:(b.attr("hasFollowed")=="true"),mid:b.attr("mid"),id:b.attr("id"),bType:b.attr("bType"),disappear:b.attr("disappear")};tryFollowing(a)}function tryFollowing(j,d){var b=j.id,c=j.hasFollowed,m=j.mid,l=j.obj||{},h=j.bType,k=j.disappear,d=d||o;function g(p){l.attr("title",p);if(h=="HyperLink"){l.text(p)}else{l.toggleClass("followed")}l.attr("hasFollowed",c?"false":"true")}function o(p){if(p.status=="succeeded"){leaveFanClub("#FanClub"+m,c,k);if(!k){g(p.text)}a(p)}else{if(p.status=="outOfLimit"){lxAlert(p.msg)}}}function a(q){var p=$("a[mediainfo*="+m+"]");if(p){p.attr("title",q.text);p.attr("hasFollowed",c?"false":"true")}}var f={hasFollowed:c,mid:m,lastIdInFavs:getLastMediaIdInTopFavs(l[0])};zAjax.post("/profile/FollowingHandler.ashx",b,f,d,b,"json")}function ClearFanClubSearchBox(a){a.value="";a.onfocus=null}var g_useSilverlightForSongPlays;function SetSongPlayerPreference(a){g_useSilverlightForSongPlays=a}function MBS(c,b,j,g,a,h,f,d){this.img=c;this.previewId=b;this.trackId=j;this.albumId=g;this.expandId=a;this.albumImageId=h;this.playsId=f;this.playLabelId=d;if(typeof(this.expandId)=="undefined"){this.expandId=c.id+"_expand"}this.playState=0}MBS.prototype.Stop=function(){this.playState=0;this.SetImageState(false);MBS.StopPlayer();window.lxPlaying=null;this.img.title=LocStr.lxUtilResources.ClickToPlay.expandTokens({TITLE:this.trackTitle})};MBS.prototype.Playing=function(){this.playState=2;this.SetImageState(false)};MBS.prototype.Start=function(){this.playState=1;this.SetImageState(false);if(window.lxPlaying){window.lxPlaying.Stop()}window.lxPlaying=this;MBS.PlayPreview(this.previewId,this.trackId,this.albumId,this.img);this.img.title=LocStr.lxUtilResources.ClickToPause.expandTokens({TITLE:this.trackTitle});MBS.LoadTrackDetails(this.trackId,this.expandId,true);SetLargeSize(this.playsId,this.playLabelId);if("undefined"!=typeof(this.albumImageId)){SongListingDisplayAlbumImage(this.albumImageId,"/Album/GetAlbumImageUrl.ashx?aid="+this.albumId)}};MBS.LoadTrackDetails=function(g,b,h){var d=getEl(b);if(null==d){return}var c=d.getAttribute("loaded");var f=d.getAttribute("isfav");var a=d.getAttribute("playedby");if(css.has(d,"hide")||h){css.remove(d,"hide");if(!c){Ajax.FragmentHttpGet("/frags/TrackDetails.aspx?trackId="+g+"&isfav="+f+"&playedby="+a,b,b);d.setAttribute("loaded",true)}}else{css.add(d,"hide")}};MBS.PlayPreviewError=function(){MBS.StopAll()};MBS.StopAll=function(){if(window.lxPlaying){window.lxPlaying.Stop()}window.lxPlaying=null};MBS.Started=function(){if(window.lxPlaying){window.lxPlaying.Playing()}};MBS.prototype.SetImageState=function(a){if(this.playState==2){if(this.hover){this.img.src="/xweb/lx/pic/mbs/pause_hover.gif"}else{this.img.src="/xweb/lx/pic/mbs/pause_active.gif"}}if(this.playState==0){if(this.hover){this.img.src="/xweb/lx/pic/mbs/play_hover.gif"}else{if(g_useSilverlightForSongPlays=="true"&&this.trackId==g_currPlayingTrackId&&g_isCurrTrackOn==true){if(this.img.src.indexOf("/xweb/lx/pic/mbs/loading_active.gif")==-1){this.img.src="/xweb/lx/pic/mbs/loading_active.gif"}}else{this.img.src=this.defaultImageSrc}}}if(this.playState==1&&!a){this.img.src="/xweb/lx/pic/mbs/loading_active.gif"}};MBS.MouseOver=function(){var a=this.lxMbs;a.hover=true;a.SetImageState(true)};MBS.MouseOut=function(){var a=this.lxMbs;a.hover=false;a.SetImageState(true)};MBS.Click=function(){var a=this.lxMbs;if(a.playState==0){a.Start()}else{a.Stop()}};MBS.SilverlightClick=function(){var a=this.lxMbs;MBS.PlayPreview(a.previewId,a.trackId,a.albumId,a.img);MBS.LoadTrackDetails(a.trackId,a.expandId,true);SetLargeSize(a.playsId,a.playLabelId);if("undefined"!=typeof(a.albumImageId)){SongListingDisplayAlbumImage(a.albumImageId,"/Album/GetAlbumImageUrl.ashx?aid="+a.albumId)}UpdateCurrentlyPlayingImages(a.trackId,true)};MBS.Init=function(l,h,c,j,d,m,a,b,k){var f=getEl(l);var g=new MBS(f,h,c,j,d,m,a,b);f.lxMbs=g;f.onmouseover=MBS.MouseOver;f.onmouseout=MBS.MouseOut;g.trackTitle=f.title;g.defaultImageSrc=f.src;if(g_useSilverlightForSongPlays=="true"){f.onclick=MBS.SilverlightClick;if(k!="undefined"&&k!=undefined){f.title=k.format(g.trackTitle)}}else{f.onclick=MBS.Click;f.title=LocStr.lxUtilResources.ClickToPlay.expandTokens({TITLE:g.trackTitle})}f.className="LxEnabled";g.SetImageState(false)};function getExternalInterface(a){return(navigator.appName.indexOf("Microsoft")!=-1)?window[a]:document[a]}MBS.PlayPreview=function(b,d,a,c){if(g_useSilverlightForSongPlays=="true"){MBS.PlaySongInSilverlight(d);return}function g(h,j){player=getExternalInterface("ZuneMusicPlayer");player.Url=j.location+j.resource;var l=j.location;var k=j.resource;player.PlayStreaming(l,k)}c.LxOnAjaxStart=function(){};var f={PreviewId:b,TrackId:d,AlbumId:a};Ajax.GetAsync("/frags/GetPreviewUrl.ashx",f,c,g)};MBS.StopPlayer=function(){player=getExternalInterface("ZuneMusicPlayer");player.StopStreaming()};MBS.PlaySongInSilverlight=function(a){AudioPlayerPlayMedia(a,5000)};var g_currPlayingTrackId=null;var g_isCurrTrackOn=false;function UpdatePlayerCurrentMediaInfo(h,c,f,d,a){if(audioPlayerMode!=0){return}var k=35;var j=function(m,l){l=l||k;return(m.length>l)?m.substring(0,l)+"...":m};var b=function(l,m){if(m.length>k){return'<li><a href="{0}" title="{1}">{2}</a></li>'.format(l,m,j(m))}else{return'<li><a href="{0}">{1}</a></li>'.format(l,m)}};var g=[];g.push(b(c,h));g.push(b(d,f));$("#LxDashboardSongInfo").empty().append(g.join("")).newsTicker();UpdateCurrentlyPlayingImages(a,true)}function UpdateCurrentlyPlayingImages(c,d){if(audioPlayerMode!=0){return}g_currPlayingTrackId=c;g_isCurrTrackOn=d;var a=$("img");for(i=0;i<a.length;i++){var b=a[i].lxMbs;if(b!=undefined&&b!=null){b.SetImageState(false)}}}function AddEpisodeToMyTv(f,b,a){if(!Auth.validateTicket()){setRedirectAddToMyTvElementIdCookie(f);return false}ResetMyTvVersion();toggleMyTvEpisodeButton(true,f,b,a);UpdateSeasonListControlAddToMyTv(true,f);var c="/profile/AddToMyTv.ashx";var d={mediaId:f,mediaType:b};Ajax.PostAsyncWithSilentLoad(c,d,getEl(a),null);return false}function setFavorite(j,a){function h(l,o){for(var m=0;m<f.length;m++){var k=f[m];k.title=LocStr.lxUtilResources.FavoriteTooltip.format(o.songTitle)}}var g=document.getElementById(a);var f=[];if(Auth.validateTicket()){if(g!=null){var b=document.createElement("IMG");b.style.paddingTop="4px";b.style.paddingLeft="7px";b.style.paddingRight="7px";b.src="/xweb/lx/pic/mbs/check.gif";b.alt=LocStr.lxUtilResources.FavoriteButton;b.height=10;b.width=12;g.innerHTML="";g.appendChild(b);g.onclick=function(){return false};g.href="#";g.title="";if(isIE()){g.style.paddingBottom="4px"}f.push(b)}}var c="/profile/SetFavPost.ashx";var d={aid:j};Ajax.PostAsyncWithSilentLoad(c,d,getEl(a),h);return false}function RemoveEpisodeFromMyTv(f,b,a){var c="/profile/AddToMyTv.ashx";var d={mediaId:f,action:"remove"};ResetMyTvVersion();Ajax.PostAsyncWithSilentLoad(c,d,getEl(a),null);toggleMyTvEpisodeButton(false,f,b,a);UpdateSeasonListControlAddToMyTv(false,f);return false}function toggleMyTvEpisodeButton(j,b,k,a){var f=document.getElementsByName(a);for(var g=0;g<f.length;g++){var c=f[g];var h="";var d="";if(j){h=c.getAttribute("RemoveFromMyTvText")||"";d=c.getAttribute("RemoveFromMyTvHoverText")||""}else{h=c.getAttribute("AddToMyTvText")||"";d=c.getAttribute("AddToMyTvHoverText")||""}c.innerHTML=h;c.href="#";c.title=d;if(j){c.onclick=function(){return RemoveEpisodeFromMyTv(b,k,a)}}else{c.onclick=function(){return AddEpisodeToMyTv(b,k,a)}}}}function removeFavorite(b,g,a){var d=b.target!=null?b.target:b.srcElement;while(d!=null&&!d.id.endsWith("_ShaddingWrapperDiv")){d=d.parentNode}if(d!=null){d.style.display="none";d.parentNode.removeChild(d)}var c="/profile/SetFavPost.ashx";var f={aid:g,action:"remove"};Ajax.PostAsyncWithSilentLoad(c,f,getEl(a),null);return false}var g_BuyDialog;function BuyButton(f,a,b){HideBuyButton();g_BuyDialog=document.createElement("DIV");g_BuyDialog.className="LxMediaButtonConfirmSearch";var j=findPosition(f);var d=j.top+f.offsetHeight;if(d<0){d=0}g_BuyDialog.style.top=d+"px";var c=j.left-250+f.offsetWidth;if(c<0){c=0}g_BuyDialog.style.left=c+"px";var h=document.createElement("DIV");h.innerHTML=(b=="0")?LocStr.lxUtilResources.BuyButtonRedirectNotAvailable:LocStr.lxUtilResources.BuyButtonRedirectNoMarketplace;h.className="LxMediaButtonText alignLeft";g_BuyDialog.appendChild(h);h=document.createElement("DIV");h.className="LxMediaButtonText alignCenter";g_BuyDialog.appendChild(h);h.appendChild(CreateButton(LocStr.lxUtilResources.Yes,YesBuyButton,a));var g=document.createTextNode(" ");h.appendChild(g);h.appendChild(CreateButton(LocStr.lxUtilResources.No,NoBuyButton,"#"));document.body.appendChild(g_BuyDialog);return false}function YesBuyButton(){HideBuyButton();return true}function NoBuyButton(){HideBuyButton();return false}function HideBuyButton(){if(g_BuyDialog){document.body.removeChild(g_BuyDialog);g_BuyDialog=null}return false}function CreateButton(d,c,a){var b=document.createElement("A");b.className="LxButtonCommon LxCommentButton LxMediaButtonButton";b.href=a;b.onclick=c;b.innerHTML=d;return b}function playPreview(a){function d(f,g){if(g_useSilverlightForSongPlays=="true"){AudioPlayerStopMedia()}player=getExternalInterface("ZuneMusicPlayer");player.Url=g.location+g.resource;var j=g.location;var h=g.resource;player.PlayStreaming(j,h)}if(a){var b="1033";var c={PreviewId:a,Lcid:b};Ajax.GetAsync("/zcard/getmp3jsonservice.ashx",c,null,d)}}var audioPlayerUrl=null;var audioPlayerControl=null;var audioPlayerCurrentState=-1;var audioPlayerVolumeLevel=0;var audioPlayerVolumeIsMuted=null;var audioPlayerMode=null;var audioPlayerPopoutWindow=null;var currWinIsPopAudioPlayer=false;var videoPlayerPopoutWindow=null;var audioQueueEditorControl=null;var audioPlayerCurrIndex=-1;var audioPlayerCurrPlaylist="";var dashIsMaximized=true;var px="px";var dashDim={shadowHt:50,maxWrapHt:135,minWrapHt:80,emptyWrapHt:83};function onAudioPlayerLoad(a,g,c){try{var b=document.getElementById("dashboardPlayer");var f=a.getHost();if(b&&f.isVersionSupported("3.0")){audioPlayerControl=b.content.DashPlayerControl}else{$("#zuneDashboardWrapper").css({display:"none"})}if(audioPlayerControl){audioPlayerControl.addEventListener("PlayerStateChanged",onAudioPlayerStateChanged);audioPlayerControl.addEventListener("VolumeStateChanged",onAudioVolumeChanged);audioPlayerControl.addEventListener("MediaLoaded",onAudioMediaLoaded);audioPlayerControl.addEventListener("UserMessageNotification",onUserMessageNotification);audioPlayerControl.addEventListener("PopoutStatusChanged",onPopoutStatusChanged);audioPlayerControl.addEventListener("PlaylistUpdated",onAudioPlaylistUpdated)}}catch(d){audioPlayerControl=null}}function onQueueEditorControlLoad(a,g,b){try{var c=document.getElementById("audioQueueEditor");var f=a.getHost();if(c&&f.isVersionSupported("3.0")){audioQueueEditorControl=c.content.queueControl;audioQueueEditorControl.UpdatePlaylist(audioPlayerCurrIndex,audioPlayerCurrPlaylist)}}catch(d){audioQueueEditorControl=null}}function onPopupAudioPlayerLoad(a,g,c){try{var b=document.getElementById("popupAudioPlayer");var f=a.getHost();if(b&&f.isVersionSupported("3.0")){audioPlayerControl=b.content.PopupPlayerControl}if(audioPlayerControl){audioPlayerControl.addEventListener("PlayerStateChanged",onAudioPlayerStateChanged);audioPlayerControl.addEventListener("VolumeStateChanged",onAudioVolumeChanged);audioPlayerControl.addEventListener("MediaLoaded",onAudioMediaLoaded);audioPlayerControl.addEventListener("UserMessageNotification",onUserMessageNotification);audioPlayerControl.addEventListener("PopoutStatusChanged",onPopoutStatusChanged);currWinIsPopAudioPlayer=true}}catch(d){audioPlayerControl=null}}function onAudioVolumeChanged(b,a){audioPlayerVolumeLevel=a.VolumeLevel;audioPlayerVolumeIsMuted=a.IsMuted}function onAudioPlayerStateChanged(b,a){audioPlayerCurrentState=a.PlayerState;if(a.PlayerState==4||a.PlayerState==5){UpdateCurrentlyPlayingImages(g_currPlayingTrackId,false)}if(a.PlayerState==3){UpdateCurrentlyPlayingImages(g_currPlayingTrackId,true)}}function onAudioMediaLoaded(b,a){try{audioQueueEditorControl.UpdatePlaylistPosition(a.PlaylistIndex)}catch(c){}}function onAudioPlaylistUpdated(b,a){UpdatePlaylistInfo(a.CurrentIndex,a.Playlist)}function UpdatePlaylistInfo(a,c){audioPlayerCurrIndex=a;audioPlayerCurrPlaylist=c;try{audioQueueEditorControl.UpdatePlaylist(a,c)}catch(b){}}var AudioPlayerCurrentMediaGuidList;var AudioPlayerCurrentPlaylistIndex;function onUserMessageNotification(b,a){if(a.Title!=null){if(a.Title=="Session id expired"){popup.show(streamingErrorPopup)}else{if(a.ShouldShowGenericErrorToUser==true){popup.show(genericStreamingErrorPopup)}}}UpdateCurrentlyPlayingImages(null,false);AudioPlayerCurrentPlaylistIndex=a.CurrentPlaylistIndex}function onPopoutStatusChanged(b,a){if("undefined"!=typeof MaximizeDash){if(a.IsPopoutOpen&&dashIsMaximized){MinimizeDash()}else{if(!a.IsPopoutOpen&&!dashIsMaximized){MaximizeDash()}}}}function ShowErrorForMediaItem(a,b){if(audioPlayerControl!=null){audioPlayerControl.ShowErrorDetails(a,b)}}function AudioPlayerPlayMedia(c,d){AudioPlayerCurrentMediaGuidList=c;if(audioPlayerControl==null){if(d>0){var b=100;var a=d-b;setTimeout('AudioPlayerPlayMedia("{0}",{1})'.format(c,a),b)}}else{audioPlayerControl.PlayMedia(c)}}function AudioPlayerAddSongsToQueue(a){if(audioPlayerControl!=null){audioPlayerControl.AddMediaToQueue(a)}}function AudioPlayerStopMedia(){if(audioPlayerControl!=null){audioPlayerControl.StopMedia()}}function AudioPlayerPlayMediaForceLogin(){var a="forceNewSession "+AudioPlayerCurrentMediaGuidList;audioPlayerControl.PlayMedia(a,AudioPlayerCurrentPlaylistIndex)}function PopoutAudioPlayer(a,c,b){audioPlayerPopoutWindow=window.open("/zpage.aspx?c=SilverlightPageController&mediatype=audio&index={0}&pos={1}&playing={2}#".format(a,c,b),"ZuneMediaPlayer","height=485,width=330,status=no,toolbar=no,directories=no,menubar=no,location=no,resizable=no,scrollbars=no,titlebar=no,channelmode=no",false)}function ExecInPopoutPlayer(command){if(currWinIsPopAudioPlayer==true){audioPlayerPopoutWindow=self}else{audioPlayerPopoutWindow=window.open("/zpage.aspx?c=SilverlightPageController&mediatype=audio#","ZuneMediaPlayer","height=485,width=330,status=no,toolbar=no,directories=no,menubar=no,location=no,resizable=no,scrollbars=no,titlebar=no,channelmode=no",false)}if(audioPlayerPopoutWindow.execScript){audioPlayerPopoutWindow.execScript(command)}else{audioPlayerPopoutWindow.eval(command)}}function AudioPlayerPlayMediaAtIndex(b,a){AudioPlayerPlayMediaAtIndexHelper(b,10000,a)}function AudioPlayerPlayMediaAtIndexHelper(d,g,c){if(audioPlayerControl==null){if(g>0){var b=100;var a=g-b;setTimeout("AudioPlayerPlayMediaAtIndex({0},{1},{2})".format(d,a,c),b)}}else{try{audioPlayerControl.PlayMediaAtIndex(d,c)}catch(f){if(g>0){var b=100;var a=g-b;setTimeout("AudioPlayerPlayMediaAtIndex({0},{1},{2})".format(d,a,c),b)}}}}function RemoveItemFromMediaList(a){if(audioPlayerControl!=null){audioPlayerControl.RemoveItemFromQueue(a)}}function RemoveAllItemsFromMediaList(){if(audioPlayerControl!=null){audioPlayerControl.RemoveAllItemsFromQueue()}}function MinimizeDash(){HideQueueEditor();$("#zuneDashboardWrapper").css({height:dashDim.minWrapHt+px});dashIsMaximized=false}function HideQueueEditor(){$("#queueEditorWrapper").hide().css("zIndex",9999);if(audioPlayerControl){audioPlayerControl.UpdateQueueEditorState(false)}}function ShowQueueEditor(){$("#queueEditorWrapper").show().css("zIndex",9999);if(audioPlayerControl){audioPlayerControl.UpdateQueueEditorState(true)}}function MaximizeDash(){$("#zuneDashboardWrapper").css({height:dashDim.maxWrapHt+px,backgroundColor:"transparent"});dashIsMaximized=true}function AudioPlayerInitNav(a){if(currWinIsPopAudioPlayer==true){window.opener.location=a}else{window.location=a}}function TryCloseVideoPlayerWindow(){if(videoPlayerPopoutWindow!=null){try{videoPlayerPopoutWindow.close()}catch(a){}videoPlayerPopoutWindow=null}}function TryCloseAudioPlayerWindow(){if(audioPlayerPopoutWindow!=null){try{audioPlayerPopoutWindow.close()}catch(a){}audioPlayerPopoutWindow=null}}function ShowTopDashboardCCM(){$("#zuneDashboardTopCCM").css({visibility:"visible"})}function HideTopDashboardCCM(){$("#zuneDashboardTopCCM").css({visibility:"hidden"})}$(document).ready(function(){var f=$("#queueEditorWrapper"),d=$(window),c=$("#dashboardPlayer"),a=1000,b="px";d.bind("resize",g);function g(){var h={x:d.width(),y:d.height()},k={x:c.width(),y:c.height()},j=((h.x-a)/2)+55,j=(j<0)?0:j;f.css({position:"fixed",right:j+b,zIndex:9999})}g()});function growDashboard(){$("#dashboardControlHost").css({height:(dashDim.maxWrapHt-dashDim.shadowHt)+px});$(".zuneDashboardWrapper").css({height:dashDim.maxWrapHt+px,bottom:"0px"})}function shrinkDashboard(){$("#dashboardControlHost").css({height:(43)+px});$(".zuneDashboardWrapper").css({height:"auto",bottom:"0px"})}$Buybutton=function(){var c=".jsBuybtn",b="click",a=200;var d=fn={init:function(f){f?d.ready(null,f):$(document).ready(d.ready)},ready:function(g,h){h=h||document.body;var f=$(c,h);f.each(function(){var j=$(this);if(j.attr("canPurchase")&&j.attr("canPurchase").toLowerCase()=="true"){j.attr("href","#").bind((b),d.click)}})},click:function(m){var k=$(m.currentTarget);if(k.length>0){var o=k.attr("mediainfo");var h=k.attr("purchasebiinfo");var f=k.attr("cookieDomain");var l=o.split("#");var j="Buy Button: "+((l.length>1)?l[0]:"");var g=["DCS.dcsuri","/{pname}/{bname}/buy","WT.ti",j,"wtNavigation","Buy Button","wtEvtSrc","{url}"];dcsMultiTrackWrapper(k,g);BuyAction(o,h,f)}}};return fn};if(typeof ZunePageData!="undefined"){new $Buybutton().init()}function BuyAction(g,c,b){b=b||null;c=c||null;if(g&&g.indexOf("#")>-1){var f=g.split("#");var h="";if(c){var a=GetPurchaseBIInfoObj(c);if(a&&a.contextEvent&&a.contextGuid){if(b){Cookie.set("purchaseBIInfo","event="+a.contextEvent+"&guid="+a.contextGuid,null,b,"/",null)}h="&purchaseContextEvent="+a.contextEvent+"&purchaseContextGuid="+a.contextGuid}}if(!Auth.isSignedIn){delayNav(DTO.authurl.replace("{mid}",f[0]).replace("{mtype}",f[1]))}else{var d=ZunePageData.secureurl+"/Purchase/Music?mid=";lxShowIFrame(d+f[0]+"&mtype="+f[1]+h)}}return false}function GetPurchaseBIInfoObj(purchaseBIInfoJson){var purchaseBiInfoObj=null;if(purchaseBIInfoJson!=undefined&&purchaseBIInfoJson!=null){purchaseBiInfoObj=eval("("+purchaseBIInfoJson+")")}return purchaseBiInfoObj}$Hovertoggle=function(){var c=$Hovertoggle,j=[".jsTrack.NarrowMostPlayedSongs"],g="mouseenter",b="mouseleave",f=".content",a=".altContent",d=200;var h=fn={init:function(k){k?h.ready(null,k):$(document).ready(h.ready)},ready:function(l,m){m=m||document.body;var k=j.length;while((--k)>=0){$(j[k],m).bind((g+" "+b),{context:j[k]},h.toggle)}},toggle:function(l){var m=l.type,k=l.currentTarget;if(k){if(m==b){h.hide(l)}else{if(m==g){h.show(l)}}}},show:function(l){if(c.lastAlt){c.lastAlt.hide(c.lastAlt.ev)}var k=$(l.currentTarget),m=$(a,k);$(f,k).css("display","none");m.css({visibility:"visible",display:"block"});c.lastAlt=h;c.lastAlt.ev=l},hide:function(o){var q=o.type,m=$(o.currentTarget),p=false,k=$(".jsMenuGrip",m);if(k[0]&&k[0].dropMenu){p=k[0].dropMenu.isShowing}if(!p){$(a,m).css("display","none");var l=$(f,m);l.css({visibility:"hidden",display:"block"});l.css({visibility:"visible",display:"none"});l.fadeIn(d)}}};return fn};new $Hovertoggle().init();$Hovergrip=function(){var f=[".jsTrack"],b="mouseenter",a="mouseleave",c=null;var d=fn={init:function(g){g?d.ready(null,g):$(document).ready(d.ready)},ready:function(h,j){j=j||document.body;var g=f.length;while((--g)>=0){$(f[g],j).bind((b+" "+a),{context:f[g]},d.toggle)}},toggle:function(l){var m=l.type,k=l.currentTarget;if(k){k=$(k);c=k.attr("mediainfo");var g=$(".jsMenuGrip",k),h=$(".menugrip",k),j="none";if(m==a){h.css("display",h.attr("hideDisplay")?h.attr("hideDisplay"):"none")}else{if(m==b){$Dropmenu.lastmenu.hide()}}if(g[0]&&!g[0].proxyElement){g[0].proxyElement=l.currentTarget}}}};return fn};new $Hovergrip().init();$Dropmenu=function(){var k=[".jsMenuGrip","#jsOverMenu"],G="mouseleave",p="#jsMenuBuy",C="#jsMenuFavorite",h="#jsDropMenu",J="#jsMenuRentZune",D="#jsMenuRentXbox",L="#jsMenuFollow",T="#jsMenuFriend",B="#jsMenuShare",f="#jsMenuLearn",d="#jsMenuMixView",K="#jsMenuProfile",N="#jsMenuAddToCart",S="#jsMenuStopFollow",o="#jsRemoveFavorite",j=null,q=null,s=null,w=null,H=null,F=null,A=null,E=null,R=null,z=null,b=null,I="click",U=200,v=[],V=null,u=$Dropmenu,t="/profile/SetFavPost.ashx",m="";u.current=u.target=null;function c(){for(var W=0;W<v.length;W++){v[W].parent().css("display","none")}}function a(W){for(var X=0;X<W.length;X++){if(W[X].css){W[X].parent().css("display","block")}}}function Q(X,W){return $(X,h).bind(I,{t:W},g.action)}function M(){var W={};if(V){W=V.attr("hasFollowed")}return W}function r(X){c();var Y=[],W=M();if(X=="song"||X=="track"){o.hide();Y.push(C);P()}if(j&&W){Y.push((W=="true")?S:L)}if(F){Y.push(B)}if(A&&DISPLAY_MIX_VIEW){Y.push(d)}if(H&&X!="user"){Y.push(f)}else{if(H&&X=="user"){Y.push(K)}}if(b){Y.push(N)}if(s&&!(X=="song"||X=="track")){Y.push(p)}a(Y)}function P(){if($("body").hasClass("SignedIn")){if(V&&"undefined"==typeof V.attr("isFavorite")){window.setTimeout(function(){var X=j.split("#")[0];if(X){var W={aid:X,action:"query"};zAjax.post(t,null,W,l,null,"json");return false}},0)}else{if(V){if(V.attr("isFavorite")=="true"){o.show()}}}}}function l(W){o.hide();V.attr("isFavorite",W.isFavorite);if(W.isFavorite=="true"){o.show()}}function O(W,Y){try{while(Y&&Y!==W&&Y!=document){Y=Y.parentNode}return Y===W}catch(X){}}function y(){var W=M(),X={mid:j.split("#")[0],hasFollowed:W,disappear:true};var Y=$("a[mid="+X.mid+"][hasfollowed*=]");if(Y[0]){Y.click()}else{tryFollowing(X,function(Z){if(Z.status=="succeeded"){V.attr("hasFollowed",((W=="true")?"false":"true"))}else{if(Z.status=="outOfLimit"){lxAlert(Z.msg)}}})}}var g=fn={init:function(W){W?g.ready(null,W):$(document).ready(g.ready);$(document).bind("click scroll",g.doc_click);return g},ready:function(X,Y){Y=Y||document.body;var W=k.length;while((--W)>=0){$(k[W],Y).bind("click",{context:k[W]},g.show)}$(".buttonRow #jsOverMenu",Y).bind("mouseenter",{context:"buttonRow #jsOverMenu"},g.show);if(typeof h!="object"){h=$(h).bind((G),g.hide);u.element=h;p=Q(p,"buy");C=Q(C,"fav");J=Q(J,"rentzune");D=Q(D,"rentxbox");L=Q(L,"follow");T=Q(T,"friend");B=Q(B,"share");f=Q(f,"learn");K=Q(K,"profile");N=Q(N,"cart");d=Q(d,"mixview");S=Q(S,"follow");o=$(o);v=[p,C,B,J,D,L,S,T,f,K,N,d]}},action:function(ah){var ab=ah.data;var Z=V.attr("mediaInfo").split("#");var ad=((Z.length>1)?Z[1]:"")+" drop-down";var W=ad+": "+ab.t;var af=["DCS.dcsuri","/{pname}/{bname}/share","WT.ti",W,"wtNavigation",ad,"wtEvtSrc","{url}"];dcsMultiTrackWrapper(V,af);switch(ab.t){case"buy":if(w&&w.toLowerCase()=="true"){BuyAction(j,q)}else{if(s){delayNav(s)}}break;case"cart":var X=b.split("#");var aa=X[0],aj=X[1],ac=X[2],Y=X[3],ai=X[4],ak=X[5];addMediaToCart(aa,aj,ac,Y,ai,ak);break;case"learn":case"profile":if(H){delayNav(H)}break;case"share":if(F){sendWrapper2(F,$("body").hasClass("SignedIn"))}break;case"mixview":if(A){var ag=A.split("#");popup.showMixview(ag[0],ag[1])}break;case"fav":function ae(am){if(am){var al={aid:am};if(V.attr("isFavorite")=="true"){al.action="remove"}zAjax.post(t,null,al,l,null,"json")}return false}if(j){ae(j.split("#")[0])}break;case"follow":if(j){y()}break;case"rentzune":case"rentxbox":break}g.hide(ah)},show:function(Z){var Y=$(Z.currentTarget);Y[0].dropMenu=g;j=null;V=Y[0].proxyElement||Y.attr("proxyElement");if(V){V=$(V);j=V.attr("mediainfo");q=V.attr("purchasebiinfo");s=V.attr("purchaseinfo");w=V.attr("canPurchase");b=V.attr("cartinfo");H=V.attr("learninfo")||V.attr("href");if(!H||H==""){H=V.attr("moreinfourl")}F=V.attr("sendinfo");A=V.attr("mixviewinfo");E=V.attr("friendinfo");R=V.attr("followinfo")}if(j){var X=j.split("#")[1];r(X);h.css({visibility:"hidden",display:"block"});h.position({target:Y,targetPos:2,elementPos:1,hideAfterPosition:true});h.css({visibility:"visible",display:"none"});h.fadeIn(U);u.current=h;u.target=Y}var W=$ExpClickBindings().cloneEvent(Z);W.data={obsName:"Hover",ff:$ExpClickBindings().defaultFilterFunc,df:$ExpClickBindings().defaultDataFunc};$ExpClickBindings().action(W);g.isShowing=true;g.el=Y},doc_click:function(X){var Y=X.target,W=g.el?g.el[0]:null;if(g.isShowing&&W&&!O(W,Y)&&W!=Y){g.hide(X)}},hide:function(W){if(typeof h=="object"&&g.isShowing){$Overlay.onmenuhide(W);h.fadeOut(U,function(){u.current=u.target=null;h.css({visibility:"hidden",display:"none"})});h.trigger("onhide",{ev:W});g.isShowing=false}},isShowing:false};u.lastmenu=g;return fn};$Overlay=function(){var r=$Overlay,c=[".jsAlbum",".jsArtist",".jsUser"],u="px",y="mouseenter",f="mouseleave",q="#jsOverlay",B="#jsOverPlay",g="#jsOverAdd",D="#jsAddBtn",h="#jsPlayBtn",d="small",s="med",C=null,p="#jsOverMenu",t="/xweb/lx/pic/icons/",o=null,k=null,H=null,G=null,j=true;var v="ico16_play_bgdark_hover.png",l="ico16_play_bgdark.png",F="ico30_bgdark_play_hover.png",m="ico30_bgdark_play.png",b="ico16_add_bgdark_hover.png",I="ico16_add_bgdark.png",E="ico30_bgdark_add_hover.png",A="ico30_bgdark_add.png";var w=0;function a(M){var W="#jsOverPlay",O="#jsOverAdd",Z="#jsAddBtn",P="#jsPlayBtn",X,S,ae=150,Q,aa=0.6,L=null,ab=null;var Y=q.clone();$(Y).removeClass("ectIgnore");$(Y).find().removeClass("ectIgnore");q.after(Y);Q=($Dropmenu.lastmenu||new $Dropmenu());Q.init(Y.parent());function V(ai){var ag=null;if(ai.target==ai.currentTarget&&L){var ah=$(L);if(ah.attr("href")&&ah.attr("href")!="#"){ag=ah.attr("href")}else{if(ah.attr("learninfo")){ag=ah.attr("learninfo")}}}if(ag!=null){delayNav(ag)}}function U(){W.attr("src",(t+(d==s?v:F)))}function T(){W.attr("src",(t+(d==s?l:m)))}function ac(){O.attr("src",(t+(d==s?b:E)))}function J(){O.attr("src",(t+(d==s?I:A)))}function af(ai,ah,ag){var ak=null,aj=0;if(ah.x&&ah.y){Y.css({width:ah.x+u,height:ah.y+u});lasttarget=ai;d=(ah.x>=150?"large":s);T();J();aj=(ah.y/1.5);if(ah.x==30&&ah.y==30){Z.hide();S.hide();ak=-1;aj=0;d="large";W.attr("src",(t+m))}else{if(ah.x==200&&ah.y==200){aj=155;ak=60}else{if(ah.x==150&&ah.y==84){aj=48}else{if(d=="large"&&ag==".jsAlbum"){aj=112}else{if(ah.y==75&&ah.x==75){aj=52;ak=15}else{if(d==s){aj=35}}}}}}X.css("position","absolute");X.css("top",aj+u);X.addClass(d);if(ak!=null){X.css("left",ak+u)}}}function N(ag){R(ag)}var R=this.hide=function(ah,ai){function aj(){this.isHiding=true;Y.fadeOut(ae+100,function(){Y.hide()})}if(ai){aj()}else{if(ah){var ag=$(ah.relatedTarget).attr("className");if(ag!="dropMenu"&&ag!="jsImage"&&ag!="gripbox"){aj()}}}};$(window).resize(R);var ad=this.show=function(al,am){if(!j){return false}if(!this.isActionable){O.parent("a").removeAttr("title").unbind("click").attr("href",window.top.location.href);W.parent("a").removeAttr("title").unbind("click").attr("href",window.top.location.href);O.hide();W.hide()}r.last=r.current;this.isHiding=false;$Dropmenu.lastmenu.hide(al);r.hideCurrent(al,true);ab=am;var ak=ab,ai=(ak[0]&&ak[0].width)?{x:ak[0].width,y:ak[0].height}:{x:ak.width(),y:ak.height()},aj=ak.parent(),ah=al.data.context;L=al.currentTarget;Y.css("visibility","hidden");if(al.needSized){Y.css("cursor","pointer");if(aj&&aj.hasClass("jsCrop")){var ag=aj.parent();ai={x:ag.width(),y:ag.height()}}af(ak,ai,ah,Y,al.currentTarget);S[0].mediainfo=P[0].mediainfo=Z[0].mediainfo=mediainfo;S[0].proxyElement=al.currentTarget}Y.position({target:ak,targetPos:0,elementPos:0,hideAfterPosition:true,force:true});Y.css({opacity:0,visibility:"visible",display:"block"});Y.fadeTo(ae,aa);r.current=this};W=$("#jsOverPlay",Y);O=$("#jsOverAdd",Y);Z=$("#jsAddBtn",Y).bind("click",{t:"queue"},$PlayAddBtn.action).hover(ac,J);P=$("#jsPlayBtn",Y).bind("click",{t:"play"},$PlayAddBtn.action).hover(U,T);X=$(".buttonRow",Y);S=$("#jsOverMenu",Y);$(Y).bind("click",V);var K=new $ExpClickBindings();K.bind(Y,"click",K.defaultFilterFunc,function(ah){var ai=K.defaultDataFunc(ah);var ag=$(L);if(ag.attr("href")&&ag.attr("href")!="#"){ai.linkUrl=ag.attr("href")}else{if(ag.attr("learninfo")){ai.linkUrl=ag.attr("learninfo")}}return ai});K.bind(O,"click",K.defaultFilterFunc,K.defaultDataFunc);K.bind(W,"click",K.defaultFilterFunc,K.defaultDataFunc);$(Y).bind("mouseleave",this.hide);this.el=Y;this.isHiding=false;this.isActionable=true}r.disable=function(){r.hideCurrent(null,true);j=false};r.enable=function(){j=true};r.hideCurrent=function(J,K){if(r.current&&r.current.isHiding==false){r.current.hide(J,K)}};r.onmenuhide=function(J){if(J&&J.relatedTarget){if(J.relatedTarget.className!="overlay"){r.hideCurrent(J)}}};var z=fn={init:function(J){J?z.ready(null,J):$(document).ready(z.ready)},ready:function(K,L){L=L||document.body;q=$(q);var J=c.length;while((--J)>=0){$(c[J],L).bind((y+" "+f),{context:c[J]},z.toggle)}},toggle:function(L){var O=L.type,K=$(L.currentTarget),N=L.relatedTarget;if(K){var J=K.attr("isactionable");var M=K[0].targetImage;mediainfo=K.attr("mediainfo");if(!M){if($(".jsNewImage",K).length>0){K[0].targetImage=M=K}else{K[0].targetImage=M=$(".jsImage",K)}}if(O==y){if(undefined==M[0].overlayElement){G=new a(M);M[0].overlayElement=G;L.needSized=true;if(J!=null&&J.toLowerCase()=="false"){G.isActionable=false}}else{if(G&&G!=M[0].overlayElement){G.hide(L)}G=M[0].overlayElement}G.show(L,M)}}}};r.current=null;r.last=null;return fn};new $Overlay().init();$PlayAddBtn=function(){var f=".jsPlayBtn",b=".jsAddBtn",c="play",a="queue";var d=fn={init:function(g){g?d.ready(null,g):$(document).ready(d.ready)},ready:function(g,h){h=h||document.body;$(f,h).bind("click",{t:c},d.action);$(b,h).bind("click",{t:a},d.action)},action:function(j){var h=$(j.currentTarget),l=(h?h.attr("mediainfo"):null),o=[],k=j.data;if(l){o=l.split("#")}if(o.length>1){var g=o[1].toLowerCase();var m=(g=="tvepisode"||g=="movie"||g=="movietrailer"||g=="videopodcastepisode");if(m){VideoPlayerPlayMedia(l)}else{if(k.t==c){AudioPlayerPlayMedia(o[0]+";"+o[1])}else{if(k.t==a){AudioPlayerAddSongsToQueue(o[0]+";"+o[1])}}}}}};$PlayAddBtn.action=fn.action;$PlayAddBtn.playContext=f;return fn};new $PlayAddBtn().init();$PlayAddAllBtn=function(){var c=".jsPlayAllBtn",b=".jsAddAllBtn",d="play",a="queue";var f=fn={init:function(g){g?f.ready(null,g):$(document).ready(f.ready)},ready:function(g,h){h=h||document.body;$(c,h).bind("click",{t:d},f.action);$(b,h).bind("click",{t:a},f.action)},action:function(k){var j=$(k.currentTarget),g=j.closest(".MediaListContainer"),h="",l=k.data;if(g.length>0){$($PlayAddBtn.playContext,g).each(function(m){var o=$(this),p=(o?o.attr("mediainfo"):null),q=[];if(p){q=p.split("#");if(q.length>1){if(h.length>0){h+=","}h+=q[0]+";"+q[1]}}return true});if(l.t==d){AudioPlayerPlayMedia(h)}else{if(l.t==a){AudioPlayerAddSongsToQueue(h)}}}}};$PlayAddAllBtn.action=fn.action;return fn};new $PlayAddAllBtn().init();$ExpandoToggle=function(){var f=".jsExpandoMore",a=".jsExpandoLess",b=".expandoMoreItem",c="more",d="less";var g=fn={init:function(h){h?g.ready(null,h):$(document).ready(g.ready)},ready:function(h,j){j=j||document.body;$(f,j).bind("click",{t:c},g.action);$(a,j).bind("click",{t:d},g.action)},action:function(r){var h=$(r.currentTarget),m=r.data,s=h.closest("ul");if(s.length==1){$Overlay.disable();var q=s.parent(),o=q.length>0,l=$(b,s),p=l.length,k=(m.t==c)?$(a,h.parent()):$(f,h.parent()),j=function(){p--;if(p<=0){if(o){q.css("width",q.attr("bigwidth"))}k.show()}};if(o){q.css("width",q.attr("normalwidth"))}h.hide();if(p>0){l.toggle("fast",j)}else{j()}$Overlay.enable()}}};return fn};new $ExpandoToggle().init();$PurchaseLBI=function(){var lbiAttribute="purchasebiinfo",lbiSelector="a["+lbiAttribute+"]";var _this=fn={init:function(pel){pel?_this.ready(null,pel):$(document).ready(_this.ready)},ready:function(ev,pel){pel=pel||document.body;$("a[purchasebiinfo]",pel).each(function(index){var el=$(this);href=el.attr("href");if(href==undefined){return}purchasebiinfo=eval("("+el.attr("purchasebiinfo")+")");lbiQueryParam="purchaseContextEvent="+purchasebiinfo.contextEvent+"&purchaseContextGuid="+purchasebiinfo.contextGuid+"&picksContext="+purchasebiinfo.picksContext+"&cache=true";if(href.indexOf("?")>-1){if(href.substr(href.length-1,1)=="&"){el.attr("href",href+lbiQueryParam)}else{el.attr("href",href+"&"+lbiQueryParam)}}else{el.attr("href",href+"?"+lbiQueryParam)}})},action:function(ev){}};return fn};new $PurchaseLBI().init();$Bindings={reinitall:function(a){if(a){new $PlayAddBtn().init(a);new $PlayAddAllBtn().init(a);new $Hovergrip().init(a);if($Bindings.dropMenu){$Bindings.dropMenu.init(a)}new $Overlay().init(a);new $Hovertoggle().init(a);new $ExpandoToggle().init(a);new $ExpClickBindings().init(a);new $PurchaseLBI().init(a);new $Buybutton().init(a)}if(typeof Cufon!="undefined"){sifrConfig()}},reinit:function(b,a){new b.init(a)}};if(typeof ZunePageData!="undefined"){$Bindings.dropMenu=new $Dropmenu().init()}function addHoverForPlayList(){function a(c,d){var b={top:0,left:0};for(var f=c;f.id!=d;f=f.offsetParent){b.top+=f.offsetTop;b.left+=f.offsetLeft}return b}if(!document.getElementById("SongsInfoContainer")){$("<div id='SongsInfoContainer'></div>").appendTo("#PlaylistSongs")}$("table.MediaList tr:last td").css("border-bottom","solid 1px #FFF");$("table.MediaList tr").hover(function(){var d=a(this,"PlaylistSongs");var c=d.left+$(this).width()+15;var b=d.top;$("#SongsInfoContainer").css({left:c,top:b,display:"block"}).text($(this).attr("songsInfo"))},function(){$("#SongsInfoContainer").css("display","none")})}function formatArtistMediaImage(d){var g=$(d),a=g.height(),f=g.width(),c=(f>a),b=c?"bingImgWide":"bingImgTall";g.addClass(b);if(c){var h=Math.abs(f-a)/2;g.parent().css("margin-top",h+"px")}g.css("visibility","visible")}function formatArtistVideoImage(c){var f=$(c),d=f.parent(),a=f.height(),b=d.height();if(a<b){var g=(b-a)/2;f.css("margin-top",g+"px")}f.css("visibility","visible")}function getMatchingCss(c,d){if(c){var a=c.split(" ");for(var b=0;b<a.length;b++){if(a[b].indexOf(d)==0){return a[b].substr(d.length)}}}return""}function dcsMultiTrackWrapper(g,f){var h=getMatchingCss(g.parents(".block").attr("class"),"b_");var d=getMatchingCss($("body").attr("class"),"page_");var a=window.location;var b=a.hostname+a.pathname;for(var c=0;c<f.length;c++){f[c]=f[c].replace("{pname}",d).replace("{bname}",h).replace("{url}",b)}dcsMultiTrack.apply(this,f)}function delayNav(a){setTimeout(function(){window.location=a},400)}function search_viewAll(c,d,b){if(c=="all"){var g=$("#searchLeftNav a[name=all]");if(g.hasClass("selected")){return false}$("#_body2").hide().html("");$("#_body1").show();$("#searchLeftNav a").removeClass("selected");g.addClass("selected");return false}else{if(d&&d>0){var a=$("#searchLeftNav a[name="+c+"]");if(a.hasClass("selected")){return false}$("#searchLeftNav a").removeClass("selected");a.addClass("selected");$("#_body1").hide();$("#_body2").show();$("#_body2").addClass("border");function f(){ajaxLoader("_body2",b.replace(/id=[^&]*/,"id=_body2"))}window.setTimeout(f,1);return false}}}function setSearchResultsCount(g,f){var d=$("#searchLeftNav");var b=$("li[name="+g+"]",d);b.find("span").removeClass("Loading");if(f==0){b.find("span").text(f);b.addClass("NoResult")}else{$("#_searchTotalResult .SearchResult").show();$(".SearchHeader[bname="+g+"]").parent().parent().show();$(".SearchHeader[bname="+g+"]").show();var a=b.html();var c=$(".SearchHeader[bname="+g+"]").find(".SeeAll a").attr("href");b.html("");b.prepend('<a href="{0}">{1}</a>'.format(c,a));b.find("a span").text(f)}var h=$("span:eq(0)",d);h.text(parseInt(h.text())+f);$("#totalResult").text(h.text());if(++setSearchResultsCount.count==quickSearchResultsCount){setNofound()}}setSearchResultsCount.count=0;quickSearchResultsCount=0;function initSearchLeftNav(){var c=$("#_body1 .SearchHeader");var b=$("#searchLeftNav");var a=0;c.each(function(h){var k=$(this).attr("bname");var l=$(this).attr("count");var j=$(this).attr("isDark");if(j!="true"){var f=$("h2:eq(0)",this).text();if($(this).attr("qs")){var d=$("a",this);b.append('<li id="snl_{0}" class="NoResult">{1} (<span class="Loading">{2}</span>)</li>'.format(h,f,LocStr.lxUtilResources.SearchLoading))}else{if(l=="0"){b.append('<li class="NoResult">'+f+" (0)</li>");$("span:eq(0)",b).removeClass("Loading")}else{a+=parseInt(l);$("span:eq(0)",b).removeClass("Loading");$(this).parent().parent().show();$(this).show();var g=$(this).attr("fragPageUrl");b.append('<li id="snl_{0}"><a>{1} (<span>{2}</span>)</a></li>'.format(h,f,l));$("#snl_"+h).click(function(){search_viewAll(k,l,g)});$(this).find(".SeeAll a").click(function(){search_viewAll(k,l,g)})}}$("#snl_"+h).attr("name",k);$("#snl_"+h+" a").attr("name",k)}});quickSearchResultsCount=$("#_body1 div.SearchBlock div.SearchHeader[qs=true]").size();if(a>0){$("#_content1").show();$("#_content1 .SearchResult").show()}$("span:eq(0)",b).text(a);$("#totalResult").text(a)}function setNofound(){var a=$("#totalResult").text();if(a=="0"){$("#_content1").show();$("#_searchTotalResult .SearchResult").show();$("#_searchTotalResult .SearchNoFound").show()}}$(function initTiles(){$("img[src*=zune.net/tiles/user/]").live("mouseover",function(){tileDialog.tileMouseOver(this)}).live("mouseout",function(){tileDialog.tileMouseOut(this)}).attr("title","")});function acceptRejectFriend(a,b){var c=function(){var d=$(a).closest(".RowData");d.hide();if(d.siblings(":visible").length==0){$("#_friendRequests").hide()}};zAjax.post(b,null,{},c)}function addFriend(a,b){var c=function(){$(a).hide();$(".retract",$(a).parent()).show()};zAjax.post(b,null,{},c)}function retractFriendRequest(a,b){var c=function(){$(a).hide();$(".add").show()};zAjax.post(b,null,{},c)}function ignoreSimilarUser(a,b){var c=function(){$(a).closest(".RowData").hide()};zAjax.post(b,null,{},c)}function removeFriend(a,b){}function updateFriendButtons(a){$(".AddFriendButtons").hide();switch(a){case"Friend":$("#friendToolbarRemove").show();break;case"Pending":$("#friendToolbarCancel").show();break;case"Requesting":$("#friendToolbarAccept").show();$("#friendToolbarReject").show();break;case"NotAFriend":case"Unknown":default:$("#friendToolbarAdd").show();break}}function friendButtonAction(d,c,f,a){function g(h){updateFriendButtons(h.expectedFriendState)}function b(h){updateFriendButtons("NotAFriend")}if(d=="Remove"){popup.invoke("RemoveFriend",{zunetag:a,authRequired:true,success:b,nocache:true})}else{zAjax.post(f,c,{},g,"friendsToolbarActions","json")}}function friendRemoveButtonAction(d,c,f,a){function b(g){$(c).closest(".RowData").hide()}popup.invoke("RemoveFriend",{zunetag:a,authRequired:true,success:b,nocache:true})}var allContactsSelected=false;function ToggleAllContacts(){allContactsSelected=!allContactsSelected;var a=$(".ContactCheckBox");for(var b=0;b<a.length;b++){a[b].checked=allContactsSelected}}function SubmitInvites(c){var g=[],b=$(".ContactCheckBox"),a=$("#ExtraAddresses"),f={additionalAddresses:$("#ExtraAddresses").val(),message:$("#Message").val()};for(var d=0;d<b.length;d++){if(b[d].checked){g.push(b[d].value)}}f.emailAddresses=g.join(",");zAjax.post(c,"InviteFriendsErrorDiv",f,HandleServerResponse,null,"json");return false}function HandleServerResponse(a){window.location=a.redirect}function IsMessageLengthOk(b,a){var c=a||window.event;if(c.charCode!=undefined&&c.charCode==0){return true}if(b){if(!b.maxMessageLen){b.maxMessageLen=230}return(b.value.length<b.maxMessageLen)}return(false)}var deviceWp7="windows phone os 7.";var deviceWp7b="zunewp7";var uagent=navigator.userAgent.toLowerCase();function DetectWP7(){if(uagent.match(deviceWp7)||uagent.match(deviceWp7b)){return true}else{return false}}function popup(){var _me=popup,popupDiv=null,bypassPopupDiv=false,theBody,px="px",elPopupShield,elPopupDiv,elLoadingMessage,elTrim,elDialog,body,de=document.documentElement,w=window,active=false,compatmode=document.compatMode=="CSS1Compat",pendingFrag=false,cancelFrag=false,dialogCache={},loadingMessage=['<div class="dialogBusyMessage">',LocStr.lxUtilResources.AjaxBusyMessage,"</div>",'<div class="dialogButtons"><a onclick="popup.close()" href="javascript:">',LocStr.lxUtilResources.Cancel,"</a></div>"].join("");newLoadingMessage=['<div id="LxAjaxBusyMessage" class="dialogWrapper">','<a onclick="popup.hide();" href="#" class="closeIcon"><img height="16" width="16" alt="Close Icon" src="/xweb/lx/pic/ico_circ_remove.png"/></a>',"<h2>",LocStr.lxUtilResources.AjaxBusyMessage,"</h2>",'<div class="LoadingImg"><img src="/xweb/lx/pic/loading_animation.gif"/></div>','<div class="RowLine">&nbsp;</div>',"</div>"].join("");_me.centerDialog=centerElement;if(!DetectWP7()){$(document).ready(cacheElements)}function cacheElements(){body=document.body;elPopupDiv=$('<div class="LxPopup"></div>');elPopupShield=$('<div id="popupShield" style="visibility:hidden;position:absolute;top:0;left:0;z-index:10001;"></div>');elTrim=$('<div class="popupTrim" style="visibility:hidden;position:absolute;top:0;left:0;z-index:10002;"></div>');elPopupShield.css("opacity",0.6).css("backgroundColor","#000");elDialog=$('<div class="dialog" style="background-color:#FFF;"></div>');elLoadingMessage=$(loadingMessage);elPopupDiv.append(elPopupShield);elPopupDiv.append(elTrim);elTrim.append(elDialog);$(body).append(elPopupDiv);$(window).bind("resize scroll",centerElement);$(document).bind("keydown",keyHandle);$(body).bind("keydown",keyHandle)}function showModal(){elDialog.css("display","block");elPopupDiv.css("display","block");elPopupShield.css("display","block");if(typeof Cufon!="undefined"){sifrConfig()}}function hideModal(){elDialog.css({backgroundColor:"#FFF",height:"auto",width:"auto",display:"none"});elPopupDiv.css({display:"none"})}function centerElement(){if(elDialog.height()<=30){window.setTimeout(centerElement,10);return}var height=function(){var r=w.innerHeight||body.clientHeight;return(compatmode?de.clientHeight:r)}(),width=function(){var r=w.innerWidth||body.clientWidth;return(compatmode?de.clientWidth:r)}(),x=function(){var r=self.pageYOffset||body.scrollTop;return parseInt((de.scrollTop?de.scrollTop:r),10)}(),y=function(){var r=self.pageXOffset||body.scrollLeft;return parseInt((de.scrollLeft?de.scrollLeft:r),10)}();if(active){elPopupShield.css({height:height+px,width:width+px,top:x+px,left:y+px,visibility:"visible"});var top=x+((height-elTrim[0].offsetHeight)/2),left=y+((width-elTrim[0].offsetWidth)/2);elTrim.css({top:top+px,left:left+px,visibility:"visible"})}return{height:height,width:width,x:x,y:y}}function keyHandle(ev){if(active){switch(ev.keyCode){case 27:popup.hide();break}}}_me.close=function(){active=false;if(pendingFrag){cancelFrag=true}elDialog.html("");hideModal()};var invoke=_me.invoke=function(id,args){args=args||{};var url=["/zpage.aspx?c=FragPageController&controller=Dialogs&Dialog=",id],local=args.local;var fragPopup=function(ev){pendingFrag=false;if(cancelFrag){cancelFrag=false;return}if(id=="alert"){ev=(ev+"").format(args.header,args.subheader,args.body)}elDialog.html(ev);centerElement();if(!args.nocache){dialogCache[id]=ev}if("undefined"!=typeof $Dialog){window.eval($Dialog);$Dialog(args)}};if(args.authRequired&&!$("body").hasClass("SignedIn")){window.location=$("body").attr("authurl");return false}cancelFrag=false;active=pendingFrag=true;if(dialogCache[id]){fragPopup(dialogCache[id])}else{elDialog.html(loadingMessage);if(!local){for(var o in args){url.push("&"+o+"=",args[o])}}$.get(url.join(""),fragPopup)}showModal();centerElement()};function createPopupShield(className){var r=elPopupShield[0];elPopupShield.className=className||"lxPopupShield";return r}function createSendContentWrapper(){var divEl=document.createElement("div");divEl.id="sendMsgDiv";var wrapperEl=document.createElement("div");wrapperEl.id="wwWrapper";divEl.appendChild(wrapperEl);return divEl}function createTrim(win){var el=document.createElement("div");el.id="popupTrim";el.style.visibility="hidden";el.style.position="absolute";el.style.top=0;el.style.left=0;el.style.zIndex=10002;el.className=(win&&(typeof win.className)!=undefined)?win.className:"lxPopupTrim";if(win&&win.w){el.style.width=(!isNaN(win.w))?win.w+px:win.w}if(win&&win.h){el.style.height=(!isNaN(win.h))?win.h+px:win.h}return el}function createPopup(containerClass){var el=document.createElement("div");el.id="popupContainer";if(typeof containerClass=="undefined"){containerClass="dialog"}el.className=containerClass;return el}function createPopupByData(dataObj){var trimEl=createTrim(dataObj.win);var popupEl=createPopup(dataObj.containerClass);if(dataObj&&dataObj.data){var html=[];html.push(dataObj.data.getHeader());html.push(dataObj.data.getBody());html.push(dataObj.data.getFooter());popupEl.innerHTML=html.join("")}trimEl.appendChild(popupEl);return trimEl}function createPopupByInnerEl(innerEl){var trimEl=createTrim();var popupEl=createPopup();if(innerEl){popupEl.appendChild(innerEl)}trimEl.appendChild(popupEl);return trimEl}_me.showNew=function(obj){var html=[],containerClass=obj.containerClass;bypassPopupDiv=true;html.push(obj.data.getHeader());html.push(obj.data.getBody());html.push(obj.data.getFooter());window.iframeCallback=obj.iframeCallback||doNothing;active=true;elDialog.html('<div class="dialogWrapper">'+html.join("")+"</div>");showModal();window.setTimeout(centerElement,0);return false};_me.show=function(obj){theBody=document.getElementsByTagName("BODY")[0];bypassPopupDiv=false;if(!popupDiv){popupDiv=new element({tagName:"DIV"});css.add(popupDiv,"LxPopup");theBody.appendChild(popupDiv)}obj=obj||{};window.iframeCallback=obj.iframeCallback||doNothing;var popupShield=createPopupShield(obj.containerClass);popupDiv.appendChild(popupShield);var popupEl=createPopupByData(obj);popupDiv.appendChild(popupEl);window.setTimeout(popup.center,0);window.setTimeout(popup.autoFocus,30);if(typeof Cufon!="undefined"){window.setTimeout(sifrConfig,30)}setupEventHandler();return false};_me.showSend=function(){bypassPopupDiv=false;active=true;elDialog.html('<div id="sendMsgDiv"><div id="wwWrapper"></div></div>');showModal();return false};_me.showImage=function(src,alt){bypassPopupDiv=false;active=true;var html=[];html.push('<a class="closeIcon" href="#" onclick="popup.hide();">');html.push('<img src="/xweb/lx/pic/ico_circ_remove.png" width="16" height="16" alt="Close Icon" />');html.push("</a>");html.push('<img src="'+src+'" alt="'+alt+'" />');elDialog.html('<div class="dialogWrapper imageViewDialogWrapper" >'+html.join("")+"</div>");showModal();window.setTimeout(centerElement,0);return false};_me.showMixview=function(params,mixViewUrl){bypassPopupDiv=false;active=true;elDialog.html(popup.getMixViewHtml(params,mixViewUrl));elDialog.css({backgroundColor:"transparent",height:"600px",width:"1000px"});showModal();window.setTimeout(centerElement,0);return false};_me.showFrag=function(fragUrl,sender,cssClass,authRequired,authUrl){bypassPopupDiv=false;if(authRequired){if(!Auth.isSignedIn){if(typeof Auth.authUrl!="undefined"){window.location=(authUrl)?authUrl:Auth.authUrl;return false}}}theBody=document.getElementsByTagName("BODY")[0];if(!popupDiv){popupDiv=new element({tagName:"DIV"});css.add(popupDiv,"LxPopup");theBody.appendChild(popupDiv)}var popupShield=createPopupShield();popupDiv.appendChild(popupShield);var trimEl=createTrim({h:600,className:""});var fragControlContainerEl=document.createElement("div");fragControlContainerEl.id="fraggedPopupDiv";if(cssClass){fragControlContainerEl.className=cssClass}else{fragControlContainerEl.className="dialog"}var fraggedControl=document.createElement("div");fraggedControl.id="fraggedControl";fraggedControl.innerHTML=newLoadingMessage;fragControlContainerEl.appendChild(fraggedControl);trimEl.appendChild(fragControlContainerEl);popupDiv.appendChild(trimEl);if(typeof Cufon!="undefined"){cufonConfig()}window.setTimeout(popup.center,0);setupEventHandler();Ajax.FragmentHttpGet(fragUrl,fraggedControl.id,fraggedControl);return false};_me.refreshFrag=function(fragUrl,sender,cssClass,authRequired,authUrl){var fraggedControl=$("#fraggedControl");if(fraggedControl){bypassPopupDiv=false;if(authRequired){if(!Auth.isSignedIn){if(typeof Auth.authUrl!="undefined"){window.location=(authUrl)?authUrl:Auth.authUrl;return false}}}$("#fraggedPopupDiv").addClass(cssClass||"dialog");fraggedControl.html(newLoadingMessage);window.setTimeout(popup.center,0);setupEventHandler();Ajax.FragmentHttpGet(fragUrl,fraggedControl.attr("id"),fraggedControl.get(0));return false}else{return showFrag(fragUrl,sender,cssClass,authRequired,authUrl)}};_me.injectFrag=function(element){theBody=document.getElementsByTagName("BODY")[0];if(!popupDiv){popupDiv=document.createElement("div");css.add(popupDiv,"LxPopup");theBody.appendChild(popupDiv)}var popupShield=createPopupShield();popupDiv.appendChild(popupShield);var trimEl=createTrim({h:600,className:""});var fragControlContainerEl=document.createElement("div");fragControlContainerEl.id="fraggedPopupDiv";fragControlContainerEl.className="dialog";var fraggedControl=document.createElement("div");fraggedControl.id="fraggedControl";fraggedControl.innerHTML=element;fragControlContainerEl.appendChild(fraggedControl);trimEl.appendChild(fragControlContainerEl);popupDiv.appendChild(trimEl);window.setTimeout(popup.center,0);setupEventHandler();return false};_me.getMixViewHtml=function(initParams,mixViewUrl){initParams="playStream=Hero_play, queueFunction=Hero_queue, onClose=closeMixView,"+initParams;var html=[];html.push('<object id="mixView" data="data:application/x-silverlight-2," type="application/x-silverlight-2" width="100%" height="100%">');html.push('<param name="source" value="'+mixViewUrl+'"/>');html.push('<param name="minRuntimeVersion" value="3.0.40624.0" />');html.push('<param name="windowless" value="true" />');html.push('<param name="background" value="transparent" />');html.push('<param name="initParams" value="'+initParams+'" />');html.push('<a href="http://go.microsoft.com/fwlink/?LinkID=149156&v=3.0.40624.0" style="text-decoration:none;display:block;background:#fff;width:500px;height:292px;text-align:center;margin:0 auto;">');html.push('<img src="http://social.'+ZunePageData.BaseDomain+'/xweb/lx/pic/video_silverlight.png" alt="Get Microsoft Silverlight" style="border-style:none;margin-top:39px;"/>');html.push("</a>");html.push("</object>");return html.join("")};_me.autoFocus=function(){bodyEl=getEl("popBody");if(bodyEl){var inputEls=bodyEl.getElementsByTagName("INPUT");for(var i=0;i<inputEls.length;i++){var el=inputEls[i];if(el&&(el.getAttribute("type")=="text"||el.getAttribute("type")=="textarea")){el.focus();el.select();return}}}else{window.setInterval(popup.autoFocus,30)}};_me.center=function(){var popupTrim=getEl("popupTrim");var popupShield=getEl("popupShield");if(popupTrim&&popupShield){var winHeight=getViewportHeight();var winWidth=getViewAreaWidth();var scTop=parseInt(getScrollTop(),10);var scLeft=parseInt(getScrollLeft(),10);popupShield.style.height=winHeight+px;popupShield.style.width=winWidth+px;popupShield.style.top=scTop+px;popupShield.style.left=scLeft+px;popupShield.style.visibility="visible";var width=popupTrim.offsetWidth;var height=popupTrim.offsetHeight;if(height<30){window.setInterval(popup.center,10)}else{var topMargin=scTop+((winHeight-height)/2);topMargin=(topMargin>0)?topMargin:0;var leftMargin=scLeft+((winWidth-width)/2);leftMargin=(leftMargin>0)?leftMargin:0;popupTrim.style.top=topMargin+px;popupTrim.style.left=leftMargin+px;popupTrim.style.visibility="visible"}}};function setupEventHandler(){Event.add(window,"resize",popup.center);Event.add(window,"scroll",popup.keyDown);Event.add(document,"keydown",popup.keyDown);this.onscrollOld=window.onscroll;window.onscroll=popup.center}function releaseEventHandler(){window.onscroll=(this.onscrollOld)?this.onscrollOld:null;Event.remove(document,"keydown",popup.keyDown);Event.remove(window,"scroll",popup.center);Event.remove(window,"resize",popup.center)}_me.uploadImage=function(formEl,iframeCallback){if(!popupDiv&&!bypassPopupDiv){return}Ajax.DismissError(formEl);try{Ajax.PostToIframe(formEl,iframeCallback,popup)}catch(e){Ajax.ShowErrorString(LocStr.lxUtilResources.EmptyImageFile,formEl)}};_me.sendRequest=function(url,body,callback){if(url&&body){function defaultCallback(lxstatus,response){setTimeout(refreshPage,100);return}var callback=callback||defaultCallback;var xkey=popup;var divHolder=popupDiv;if(bypassPopupDiv){divHolder=$(".dialogWrapper",elDialog)[0]}Ajax.PostAsync(url,body,divHolder,callback,xkey)}};_me.hide=function(){if(active){popup.close()}if(popupDiv){var el=getEl(popupDiv);if(Ajax.PendingFragments.contains(popup)){Ajax.ShowErrorString(LocStr.lxUtilResources.AjaxAlreadyInProgress,el);return false}if(el){el.innerHTML="";$(document).ready(cacheElements)}releaseEventHandler();popupDiv=null}if(document.getElementById("zuneDashboardWrapper")&&document.getElementById("zuneDashboardWrapper").style.position=="relative"){document.getElementById("zuneDashboardWrapper").style.position="fixed"}return false};_me.keyDown=function(ev){ev=ev||event;if(ev.keyCode==27){try{ImageCropCancel();popup.hide()}catch(e){}}};_me.confirmPopup={data:{msg:"",buttons:[{name:LocStr.lxUtilResources.Yes,behavior:"popup.hide();"},{name:LocStr.lxUtilResources.No,behavior:"popup.hide();"}],getHeader:function(){var html=[];html.push('<div class="dialogWrapper">');html.push('<a onclick="popup.hide();" href="#" class="closeIcon"><img height="16" width="16" alt="Close Icon" src="/xweb/lx/pic/ico_circ_remove.png"/></a>');return html.join("")},getBody:function(){var html=[];html.push('<div id="popBody" class="dialogBody">');html.push('<p style="text-align:left;">{0}</p>'.format(this.msg));html.push("</div>");return html.join("")},getFooter:function(){var html=[];html.push('<div id="popFooter" class="ButtonWrapper" style="border:0;">');for(var i=0;i<this.buttons.length;i++){html.push('<a href="#" class="btn pink {0}" onclick="{1}" id="{3}"><span class="btntip"></span><span class="btntext">{2}</span></a>'.format((i==0)?"popupButtonFirst":"popupButton",this.buttons[i].behavior,this.buttons[i].name,this.buttons[i].id))}html.push("</div>");return html.join("")}}};_me.lxShowIFramePopup={data:{buttons:[{name:LocStr.lxUtilResources.OK,behavior:"popup.hide();"}],getHeader:function(){return""},getBody:function(){var html=[];html.push('<div id="popBody" class="LxPopupBody">');html.push(newLoadingMessage);html.push('<div class="iFrameWrapper">');html.push('<div style="position:absolute;right:10px;top:10px;"><img src="/xweb/lx/pic/ico16_delete.png" onclick="popup.hide();"/></div>');html.push('<iframe id="lxFrame" scrolling="no" frameborder="0" style="background-color:#fff;width:630px;height:430px;"/>');html.push("<div>");html.push("</div>");return html.join("")},getFooter:function(){return""}}};_me.confirm=function(msg,action){_me.confirmPopup.data.msg=msg;_me.confirmPopup.data.buttons[0].behavior+=action;_me.show(_me.confirmPopup);return false};_me.alert=function(msg,header,subheader){popup.invoke("alert",{body:msg||"",header:header||"",subheader:subheader||""});return false};_me.showIFrame=function(){_me.show(popup.lxShowIFramePopup)}}new popup();function closeMixView(){popup.hide()}function lxAlert(b,c,a){return popup.alert(b,c,a)}function lxConfirm(b,a){return popup.confirm(b,a)}function lxShowIFrame(a){popup.showIFrame();$("#lxFrame")[0].src=a;$("#lxFrame").load(function(){$("#popBody .iFrameWrapper").show();$("#popBody #LxAjaxBusyMessage").hide();window.setTimeout(popup.center,0)})}function LxLogBookmark(a){function b(){popup.hide()}Ajax.GetAsync(a,null,null,b,null)}function ShowPolicyMessage(a){return Ajax.ShowErrorPage(LocStr.lxUtilResources.PrivacySettingsError,a)}var AddToCartControls={remove:function(){$("#AddToCart .Cart input[type='checkbox']:checked").each(function(){deleteSingleMedia(this)})},selectAll:function(){$("#AddToCart .Cart input[type='checkbox']").attr("checked",true)},deselectAll:function(){$("#AddToCart .Cart input[type='checkbox']").attr("checked",false)}};function deleteSingleMedia(a){var b=$(a.parentNode.parentNode);var c=b.attr("itemId");deleteMediaInCart(c);b.remove()}function deleteMediaInCart(b){var a="/xweb/lx/frags/AddItemToCart.ashx";var c={ids:b,action:"delete"};zAjax.post(a,null,c,null)}function addMediaToCart(p,r,b,u,g,c,s){var h="/xweb/lx/frags/AddItemToCart.ashx";var a="/my/ManageCart";var f="<a href='#' onclick='{0}'>{1}</a>";var w="javascript:popup.hide();return false;";var k='<div id="mediaName" class="LxAddToCartMediaName">{0}</div>';var l='<div id="byDiv" class="LxAddToCartNormalText">{0}</div>';var y="{0}{1}{2}";var j=k.format(u);if(c){var o=k.format(u);var d=k.format(c);var m=l.format(LocStr.lxUtilResources.AlbumByArtistFormat);j=y.format(o,m,d)}var t={data:{title:LocStr.lxUtilResources.AddToCart,buttons:[],getHeader:function(){return'<div id="cartPopupFrame" class="LxCartPopupFrame"><div id="popTitle" class="LxAddToCartPopupH1">{0}</div>'.format(this.title)},getBody:function(){var z=[];z.push('<div id="popBody" class="LxAddToCartPopupBody">');z.push('<div id="mediaInfo" class="LxAddToCartPopupH2">');z.push('<div id="mediaType" class="LxAddToCartMediaType">{0}</div><div id="colonDiv" class="LxAddToCartColon">:</div><div id="displayName" class="LxAddToCartDisplayName">{1}</div>'.format(r,j));z.push("</div>");z.push('<img id="mediaImage" src="{0}" class="LxAddToCartImg">'.format(g));z.push('<div id="ajaxResult" class="LxAddToCartPopupH3">{0}</div>'.format(LocStr.lxUtilResources.AjaxBusyMessage));z.push('<div id="tipText" class="LxAddToCartPopupH3"></div>');z.push("</div>");return z.join("")},getFooter:function(){var z=[];z.push('<div id="popFooter" class="LxAddToCartPopupFoot ButtonWrapper ButtonV2">');z.push('<a id="cancelButton" class="btn pink" href="#" onclick="{0}"><span class="btntip"></span><span class="btntext">{1}</span>'.format(w,LocStr.lxUtilResources.Close));z.push("</div></div>");return z.join("")}}};var q=function(B,J){var D=document.getElementById("tipText");var z=document.getElementById("ajaxResult");var A=document.getElementById("popTitle");if(D){var H=J.tipstr;var I=f.format(w,J.continuestr);var G=f.format(a,J.gotocartstr);var E=H.format(I,G);D.innerHTML=E;A.innerHTML=J.resultTitle;z.innerHTML=J.resultText}var C=$(s.parentNode).attr("isFromRecommend");var F=$(s.parentNode).attr("addedText");if(C&&J.success){$("#cancelButton").click(function(){$(s).html(F||"added to cart").attr("isAdded","true");$(s.parentNode).attr("isAdded","true");var O="cartRecommendation";var N="";var K=[];var M=[];$(".RecommendationsWrapper .BrowseUnit").each(function(){K.push($(this).attr("itemId"));M.push($(this).attr("isAdded"))});N=K.join(",")+"_"+M.join(",");var L=O+"="+N+";domain"+document.domain;document.cookie=L;window.location=window.location})}};var v={mediaid:p,type:b,action:"add",location:"recommendation"};Ajax.PostAsync(h,v,null,q,null);popup.show(t)}function sendWrapper(a){if(!Auth.validateTicket()){return false}var b="";if(a){b=$(a).attr("sendInfo")}sendWrapper2(b,true);return false}function sendWrapper2(json,alreadyAuthed){if(!Auth.isSignedIn&&(typeof Auth.authUrl=="undefined")){return false}if(!alreadyAuthed&&!Auth.validateTicket()){return true}var jsonObj;if(typeof sendInfo=="undefined"){sendInfo={}}if(json&&typeof(jsonObj=eval("("+json+")"))!="undefined"){sendInfo.trackName="";sendInfo.artistName="";sendInfo.albumName="";sendInfo.albumArtUrl="";sendInfo.videoArtUrl="";sendInfo.videoName="";sendInfo.videoSeriesName="";sendInfo.videoSeasonNo="";sendInfo.videoEpisodeNo="";for(var o in jsonObj){sendInfo[o]=jsonObj[o]}}popup.showSend();wordWheel.init(sendInfo);popup.centerDialog();return true}function wordWheel(){var _timeout;var _itemCount;var _searchThrottle;var _selIdx;var _target;var _prevIdx;var _inputcode=null;var _inputMask;var _input=null;var _wwOptionsList=null;var _noEnter;var _WwBoxminwidth;var _formEl;var _messageType="Message";var _isFriendRequest=false;var _isSendSong=false;var _isSendPlaylist=false;var _isSendAlbum=false;var _isSendVideo=false;var _isSendMovie=false;var _isSendMovieTrailer=false;var _isSendPodcast=false;var _isReply=false;var _zuneTag="";var _zuneTagSelf="";var _messageMediaId="";var _messageSource="";var _podcastUrl="";var _podcastMediaId="";var _podcastName="";var _podcastEpisodeName="";var _podcastArtUrl="";var _podcastAuthor="";var _movieTitle="";var _movieArtUrl="";var _removeSymbol='<img height="16" width="16" alt="Remove user from list" src="/xweb/lx/pic/ico_circ_remove.png" style="float:none; margin-left:5px;" />';var _selectionsCss="clearBoth clearfix";var _selectionsCssHide="hide";var _errEl;var _loc;var _parentEl=document.createDocumentFragment();var _wwContainer=null;var _wwContent=null;var _wwInput=null;var _wwSelections=null;var _prevSelections=null;var _wwOptionsListWidth=250;var _maxAllowedTextLength=230;var _dafaultTile16x16="/xweb/lx/pic/Constellation_16x16.jpg";var _dafaultTile32x32="/xweb/lx/pic/Constellation_32x32.jpg";var _dafaultTile75x75="/xweb/lx/pic/Constellation_75x75.jpg";var _movieTitle,_movieArtUrl;wordWheel.checkMsgLen=function(){var messageEl=getEl("message");if(messageEl){checkMaxLength(messageEl,"wordCount")}};function getFriendsAjax(){var callback=function(status,result){if(result&&result.friends){var friends=result.friends;wordWheel._wwOptionsList=friends;var imageList=[];for(var i=0;i<friends.length;i++){var friend=friends[i];for(var o in friend){imageList.push(friend[o])}}var imagePreloader=new ImagePreloader(imageList)}};var url="/xweb/lx/frags/getfriends.ashx";Ajax.GetAsync(url,null,null,callback,url)}function getInstString(){return _loc.EnterZuneTagOrEmail}wordWheel.ShowMessage=function(message){if(_errEl){Ajax.ShowErrorString(message,_errEl)}};wordWheel.HideMessage=function(){if(_errEl){Ajax.DismissError(_errEl)}};wordWheel.init=function(pageInfo){var _me=wordWheel;if(pageInfo){_messageType=pageInfo.messageType?pageInfo.messageType:_messageType;var _messageTypeLower=_messageType.toLowerCase(),messageTitle=pageInfo.messageTitle;pageInfo.movieName=pageInfo.movieName||sendInfo.movieName||"";pageInfo.movieArtUrl=pageInfo.movieArtUrl||sendInfo.movieArtUrl||"";_isFriendRequest=(_messageTypeLower=="friendrequest");_isSendSong=(_messageTypeLower=="song");_isSendPlaylist=(_messageTypeLower=="playlist");_isSendAlbum=(_messageTypeLower=="album");_isSendVideo=(_messageTypeLower=="video");_isSendPodcast=(_messageTypeLower=="podcast");_isSendMovie=(_messageTypeLower=="movie");_isSendMovieTrailer=(_messageTypeLower=="movietrailer");_isReply=pageInfo.reply?(pageInfo.reply=="1"):false;_zuneTag=pageInfo.zuneTag?pageInfo.zuneTag:_zuneTag;_zuneTagSelf=sendInfo.zuneTagSelf?sendInfo.zuneTagSelf:_zuneTagSelf;_messageMediaId=pageInfo.messageMediaId?pageInfo.messageMediaId:_messageMediaId;_messageSource=pageInfo.messageSource?pageInfo.messageSource:_messageSource;_podcastUrl=pageInfo.podcastUrl?pageInfo.podcastUrl:_podcastUrl;_podcastMediaId=pageInfo.podcastMediaId?pageInfo.podcastMediaId:_podcastMediaId;_podcastName=pageInfo.podcastName?pageInfo.podcastName:_podcastName;_podcastEpisodeName=pageInfo.podcastEpisodeName?pageInfo.podcastEpisodeName:_podcastEpisodeName;_podcastArtUrl=pageInfo.podcastArtUrl?pageInfo.podcastArtUrl:_podcastArtUrl;_podcastAuthor=pageInfo.podcastAuthor?pageInfo.podcastAuthor:_podcastAuthor;_maxAllowedTextLength=pageInfo.maxAllowedTextLength?sendInfo.maxAllowedTextLength:_maxAllowedTextLength;_returnUrl=((typeof pageInfo.returnUrl)=="undefined")?"":pageInfo.returnUrl;_movieTitle=pageInfo.movieName;_movieArtUrl=pageInfo.movieArtUrl;_me._wwOptionsList=[];if(!_isFriendRequest){getFriendsAjax()}if(LocStr&&LocStr.lxUtilResources){_loc=LocStr.lxUtilResources;if(_isReply){_me.sendTitle=_loc.ReplyTitle}else{if(_messageType){_messageType=[_messageType.substr(0,1).toUpperCase(),_messageType.substr(1).toLowerCase()].join("");_me.sendTitle=eval("_loc.Send"+_messageType+"Title")}}if(!_me.sendTitle&&messageTitle){_me.sendTitle=messageTitle}_me.inputLabel=_loc.SendInputLabel?_loc.SendInputLabel:"";_me.messageLabel=_loc.SendMessageLabel?_loc.SendMessageLabel:"";_me.inputInst=getInstString();_me.showAll=_loc.SendShowAll?_loc.SendShowAll:"";_me.selectAll=_loc.SendSelectAll?_loc.SendSelectAll:"";_me.confirmButton=_loc.SendOk?_loc.SendOk:"";_me.cancelButton=_loc.SendCancel?_loc.SendCancel:""}var html=[];_me._wwRecipientList=pageInfo.recipientList;html.push('<div id="wwMainDiv" class="dialogWrapper">');html.push('<a class="closeIcon" href="#" onclick="popup.hide();"><img src="/xweb/lx/pic/ico_circ_remove.png" width="16" height="16" alt="Close" /></a>');html.push('<form id="wwForm" action="/my/sendmessage.aspx" onsubmit="return wordWheel.submitMessage();">');html.push('<h2 class="sendMessageTitle">{0}</h2>'.format(_me.sendTitle));if(_isSendSong||_isSendPlaylist||_isSendAlbum||_isSendVideo||_isSendPodcast||_isSendMovie||_isSendMovieTrailer){html.push('<div class="popUpDetails">');html.push('<div id="wwSongContent" class="clearfix alignLeft floatLeft">');if(pageInfo.playlistArtUrl&&pageInfo.playlistArtUrl.length>0&&pageInfo.playlistName.length>0){html.push('<div class="LxMediaBarTrackDetails">');html.push('<div class="LxMediaBarTrackDetailsAlbumArt"><img style="height: 75px; width: 75px;" border="0" src="'+pageInfo.playlistArtUrl+'"></div>');html.push('<div class="LxMediaBarTrackDetailsAlbumDetails">');html.push('<div class="LxSendMediaBarTrackDetailsText">'+pageInfo.playlistName.encodeHtml()+"</div>");html.push("</div>");html.push("</div>")}if(pageInfo.albumArtUrl&&pageInfo.albumArtUrl.length>0&&pageInfo.albumName.length>0){html.push('<div class="LxMediaBarTrackDetails"><div class="LxMediaBarTrackDetailsAlbumArt">');html.push('<img style="height: 64px; width: 64px;" border="0" src="'+pageInfo.albumArtUrl+'"></div>');if(_isSendSong&&pageInfo.trackName&&pageInfo.trackName.length>0&&pageInfo.artistName.length>0){html.push('<div class="LxMediaBarTrackDetailsText floatLeft LxSearchSongDiv textColor">');html.push('<span class="LxSendSongTitle">'+pageInfo.trackName.encodeHtml()+"</span><br />",'<span class="LxSendArtistLink">'+pageInfo.artistName.encodeHtml()+"</span>");html.push("</div>")}html.push('<div class="LxMediaBarTrackDetailsAlbumDetails">');html.push('<div class="LxSendMediaBarTrackDetailsText">'+pageInfo.albumName.encodeHtml()+"</div>");html.push("</div>");html.push("</div>")}if(pageInfo.videoArtUrl&&pageInfo.videoArtUrl.length>0&&pageInfo.videoName.length>0&&pageInfo.videoSeriesName.length>0&&pageInfo.videoSeasonNo.length>0&&pageInfo.videoEpisodeNo.length>0){html.push('<div class="LxMediaBarTrackDetails">');html.push('<div class="LxMediaBarTrackDetailsAlbumArt"><img style="height: 75px; width: 75px;" border="0" src="'+pageInfo.videoArtUrl+'"></div>');html.push('<div class="LxMediaBarTrackDetailsAlbumDetails">');html.push('<div class="LxSendMediaBarTrackDetailsText">'+pageInfo.videoName.encodeHtml()+"</div>");html.push('<div class="LxSendMediaBarTrackDetailsText">'+pageInfo.videoSeriesName.encodeHtml()+"</div>");html.push('<div class="LxMediaBarTrackDetailsText">'+LocStr.lxUtilResources.EpisodeSeriesFormat.format(pageInfo.videoSeasonNo.encodeHtml(),pageInfo.videoEpisodeNo.encodeHtml())+"</div>");html.push("</div>");html.push("</div>")}if(pageInfo.podcastName&&pageInfo.podcastName.length>0&&!_isReply&&!_isSendSong){pageInfo.podcastArtUrl=(pageInfo.podcastArtUrl.length>0)?pageInfo.podcastArtUrl:_dafaultTile75x75;html.push('<div class="LxMediaBarTrackDetails"><div class="LxMediaBarTrackDetailsAlbumArt">');html.push('<img style="max-height: 75px; max-width: 75px;" border="0" src="'+pageInfo.podcastArtUrl+'"></div>');html.push('<div class="LxMediaBarTrackDetailsAlbumDetails">');html.push('<div class="LxSendMediaBarTrackDetailsText">'+pageInfo.podcastName.encodeHtml()+"</div>");html.push('<div class="LxSendArtistLink">'+pageInfo.podcastAuthor.encodeHtml()+"</div>");html.push("</div>");html.push("</div>")}if(pageInfo.movieName&&pageInfo.movieName.length>0&&!_isReply&&!_isSendSong){pageInfo.movieArtUrl=(pageInfo.movieArtUrl.length>0)?pageInfo.movieArtUrl:_dafaultTile75x75;html.push('<div class="LxMediaBarTrackDetails"><div class="LxMediaBarTrackDetailsAlbumArt">');html.push('<img style="max-height: 90px; max-width: 60px;" border="0" src="'+pageInfo.movieArtUrl+'"></div>');html.push('<div class="LxMediaBarTrackDetailsAlbumDetails">');html.push('<div class="LxSendMediaBarTrackDetailsText">'+pageInfo.movieName.encodeHtml()+"</div>");html.push("</div>");html.push("</div>")}html.push("</div>");html.push("</div>");html.push('<div class="popUpMessageWrapper">')}html.push('<div id="wordwheelContainer">');html.push('<label for="wwInput" style="float:left;margin-right:10px;margin-bottom:8px;">'+wordWheel.inputLabel+"</label>");var deaultSelectionHtml=wordWheel.handleDefaultSelection();var wwSelectionsCss=(deaultSelectionHtml)?_selectionsCss:_selectionsCssHide;html.push('<div id="wwSelections" class="'+wwSelectionsCss+"\" onclick=\"var inpt = document.getElementById('wwInput');inpt.focus();if(wordWheel.isEmptyInput(inpt.value)){inpt.value=''};\">");html.push(deaultSelectionHtml);html.push("</div>");html.push('<a class="{0}" '.format(_isFriendRequest?"hide":"clearBoth wwShowAll"));html.push('href="#" onclick="return wordWheel.showAllOptions();">{0}</a>'.format(wordWheel.showAll));html.push('<div id="wwContent">');html.push('<input autocomplete="off" id="wwInput" type="text" value="'+wordWheel.inputInst+'" onclick="if(this.value == wordWheel.inputInst)this.value=\'\';" onfocus="wordWheel.initWW(this,wordWheel._wwOptionsList, 20);"  onkeypress="return wordWheel.wwNoEnter();" onkeydown="return wordWheel.wwNoEnter();" />');html.push("</div>");html.push("</div>");html.push('<div id="messageContainer" class="{0}">'.format((_messageType.toLowerCase()=="friendrequest")?"hide":""));html.push('<div class="wordwheelLabel"><label for="message">{0}</label></div>'.format(wordWheel.messageLabel));html.push('<div id="messageContent" class="clearfix floatLeft alignLeft"><textarea id="message" name="message" class="sendMessageText" max="{0}" required="1" onkeyup="wordWheel.checkMsgLen()" onkeypress="wordWheel.checkMsgLen()" oninput="wordWheel.checkMsgLen()" onpaste="wordWheel.checkMsgLen()"></textarea></div>'.format(_maxAllowedTextLength));html.push("</div>");html.push('<div style="display:none;" id="ajaxErr"></div>');if(_isSendSong||_isSendAlbum||_isSendVideo||_isSendPodcast){html.push("</div>")}html.push('<div id="buttonContainer" class="ButtonWrapper ButtonV2">');html.push('<a class="btn pink" id="sendButton" name="sendButton" href="#" onclick="return wordWheel.submitMessage();"><span class="btntip"></span><span class="btntext">{0}</span></a>'.format(wordWheel.confirmButton));if(_returnUrl.length==0){html.push('<a class="btn gray" id="cancelButton" name="cancelButton" href="#" onclick="popup.hide();return false;"><span class="btntip btnIE6"></span><span class="btntext">{0}</span></a>'.format(wordWheel.cancelButton))}html.push("</div>");html.push("</form>");html.push("</div>");var wwEl=getEl("wwWrapper");if(wwEl){wwEl.innerHTML=html.join("");_parentEl=wwEl;_target=document.getElementById("ww");if(!_target){_target=document.createElement("div");_target.id="ww";_target.style.zIndex=1005;_target.style.position="absolute";_target.style.display="none";_target.style.width="auto";_parentEl.appendChild(_target);$("zuneDashboardWrapper").css("position","relative");if(typeof Cufon!="undefined"){sifrConfig()}}_target.className="wwResults";_inputMask=document.getElementById("wwBG");if(!_inputMask){_inputMask=document.createElement("iframe");_inputMask.id="wwBG";_inputMask.style.zIndex=1004;_inputMask.setAttribute("scrolling","no");_inputMask.setAttribute("frameborder","0");_inputMask.style.position="absolute";_inputMask.style.display="none";_parentEl.appendChild(_inputMask)}}if(isNaN(parseInt(_wwOptionsListWidth))){_WwBoxminwidth=-1}else{_WwBoxminwidth=parseInt(_wwOptionsListWidth)}_errEl=getEl("messageContainer")}};var keyEvents={TAB:9,ESC:27,UP:38,DOWN:40,LEFT:37,RIGHT:39,ENTER:13,COMMA:188,SEMICOLON:59,SEMICOLON_IE:186};var theKey;var lastKey=0;var _pressed=0;var _prevOnKeyDown=null;wordWheel.initListener=function(cb){if(document.onkeydown!=wordWheel.wwListener){wordWheel._prevOnKeyDown=document.onkeydown}document.onkeydown=wordWheel.wwListener;theKey=cb;if(document.layers){document.captureEvents(Event.KEYPRESS)}};function isButton(el){var tagName=el.tagName.toUpperCase();if(tagName=="BUTTON"){return true}if(tagName=="INPUT"&&el.type){var type=el.type.toUpperCase();return type=="BUTTON"||type=="SUBMIT"}return false}wordWheel.isEmptyInput=function(val){return(val=="")||(val==wordWheel.inputInst)};wordWheel.wwListener=function(e){e=e||window.event;var srcEl=e.srcElement||e.target;if(isButton(srcEl)){return true}if(srcEl.tagName.toUpperCase()!="TEXTAREA"){var pK=document.all?window.event.keyCode:e.which;var pK2=String.fromCharCode(pK).toLowerCase();lastKey=pK;if(theKey!=null){return theKey(pK,pK2)}if(pK==keyEvents.UP||pK==keyEvents.DOWN||pK==keyEvents.COMMA||pK==keyEvents.SEMICOLON||pK==keyEvents.ENTER||pK==keyEvents.SEMICOLON_IE){return false}if(pK==keyEvents.TAB&&wordWheel.isEmptyInput(_input.value)){return false}}return true};wordWheel.noEnter=function(){return lastKey!=keyEvents.ENTER};wordWheel.wwNoEnter=function(){var v=(_noEnter==null||_noEnter!=true);return(v?true:wordWheel.noEnter())};wordWheel.keypressed=function(keycode,keyvalue){clearTimeout(_searchThrottle);_pressed=new Date().getTime();switch(keycode){case keyEvents.LEFT:case keyEvents.RIGHT:break;case keyEvents.UP:_selIdx=_selIdx-1;if(_selIdx<0){_selIdx=0}wordWheel.selWwItem(_selIdx);return false;break;case keyEvents.DOWN:_selIdx++;if(_selIdx>=_itemCount){_selIdx=_itemCount-1}wordWheel.selWwItem(_selIdx);return false;break;case keyEvents.TAB:if(wordWheel.isEmptyInput(_input.value)){return true}case keyEvents.ENTER:if(_itemCount>0){wordWheel.updateSendTo(_selIdx)}else{wordWheel.updateSendToWithUserInput()}wordWheel.close();return false;break;case keyEvents.COMMA:case keyEvents.SEMICOLON:case keyEvents.SEMICOLON_IE:wordWheel.updateSendToWithUserInput();wordWheel.close();return false;break;case keyEvents.ESC:wordWheel.close();break;default:wordWheel.updateSendTo(-1);_searchThrottle=window.setTimeout(wordWheel.idle,_timeout);break}};wordWheel._checkInput=function(input){if((_input!=null)&&_input.value.length>0){wordWheel._runSearch(input)}else{wordWheel.updateSendTo(-1);wordWheel.close()}};wordWheel.idle=function(input){if(wordWheel.noEnter()){var now=new Date().getTime();if(now-_pressed>_timeout){clearTimeout(_searchThrottle);wordWheel._checkInput(_input)}else{clearTimeout(_searchThrottle);_searchThrottle=window.setTimeout(wordWheel.idle,_timeout)}}};wordWheel._wwMOut=function(event){_selIdx=-1;wordWheel.selWwItem(-1)};wordWheel._wwMDown=function(event){var obj=event?event.target:this;if(obj.nodeName=="SPAN"||obj.nodeName=="IMG"){_selIdx=wordWheel._getWwIndex(obj.parentNode)}else{_selIdx=wordWheel._getWwIndex(obj)}wordWheel.updateSendTo(_selIdx);wordWheel.close()};wordWheel._wwMOver=function(event){var obj=event?event.target:this;if(obj.nodeName=="SPAN"||obj.nodeName=="IMG"){_selIdx=wordWheel._getWwIndex(obj.parentNode)}else{_selIdx=wordWheel._getWwIndex(obj)}wordWheel.selWwItem(_selIdx)};wordWheel._getWindowOffset=function(obj,parent){var x=wordWheel.findPosX(parent);var y=wordWheel.findPosY(parent)+parent.offsetHeight;obj.style.left=x+"px";obj.style.top=y+"px"};wordWheel.initWW=function(attachTo,hdnInput,timeout){_inputcode=_input=null;wordWheel.cleanup();wordWheel.ensureElements();this.initListener(this.keypressed);_input=attachTo;_input.onblur=function(){if(this.value==""){this.value=wordWheel.inputInst}};_inputcode=hdnInput;_timeout=timeout;wordWheel._getWindowOffset(_target,_input);if(_searchThrottle){clearTimeout(_searchThrottle);_searchThrottle=""}_selIdx=-1;_prevIdx=-1;_noEnter=true};wordWheel.showAllOptions=function(){wordWheel.ensureElements();wordWheel._runSearch("showAll");wordWheel._getWindowOffset(_target,_input);return false};wordWheel._runSearch=function(input){wordWheel.ensureElements();if(_input==input||input=="showAll"){if(input=="showAll"){_target.innerHTML=wordWheel.getOptionsHTML(wordWheel._wwOptionsList,"")}else{_target.innerHTML=wordWheel.getOptionsHTML(wordWheel._wwOptionsList,_input.value)}var list=wordWheel.getOptions();if(list){_itemCount=list.childNodes.length}else{_itemCount=0}if(_itemCount<1){wordWheel.hide()}else{for(var i=0;i<list.childNodes.length;i++){li=list.childNodes[i];li.onmousedown=wordWheel._wwMDown;li.onmouseover=wordWheel._wwMOver;li.onmouseout=wordWheel._wwMOut}var divSelectAll=document.createElement("div");divSelectAll.className="wwDivSelectAll";var ancSelectAll=document.createElement("a");ancSelectAll.setAttribute("href","#");ancSelectAll.onmousedown=function(){for(var i=0;i<list.childNodes.length;i++){wordWheel.updateSendTo(i)}wordWheel.close()};ancSelectAll.innerHTML=wordWheel.selectAll;divSelectAll.appendChild(ancSelectAll);list.parentNode.insertBefore(divSelectAll,list);_target.style.width="auto";_target.style.height="120px";wordWheel._showOptions()}_selIdx=0;_prevIdx=0;wordWheel.selWwItem(0);_noEnter=true}};wordWheel._getWwIndex=function(elem){var list=wordWheel.getOptions();var retIndex=0;for(var i=0;i<list.childNodes.length;i++){if(elem==list.childNodes[i]){retIndex=i;break}}return retIndex};wordWheel._showOptions=function(){document.getElementById("messageContainer").style.paddingTop="100px";_target.style.display="block";if(window.opera){_inputMask.style.display="inline"}if(_WwBoxminwidth>_target.offsetWidth){_inputMask.style.width=_WwBoxminwidth+"px";_target.style.width=_WwBoxminwidth+"px"}else{_inputMask.style.width=_target.offsetWidth+"px"}_inputMask.style.height=_target.offsetHeight+"px";_inputMask.style.top=_target.style.top;_inputMask.style.left=_target.style.left};wordWheel.hide=function(){_target.style.display="none";document.getElementById("messageContainer").style.paddingTop="0px";_inputMask.style.display="none"};wordWheel.cleanup=function(){wordWheel.initListener(null);wordWheel.close();document.onkeydown=wordWheel._prevOnKeyDown;_input=null;_noEnter=false};wordWheel.close=function(){if(_target!=null){_target.style.display="none";_target.innerHTML="";document.getElementById("messageContainer").style.paddingTop="0px"}if(_inputMask!=null){_inputMask.style.display="none"}_noEnter=false};wordWheel.getOptions=function(){var ul;for(var i=0;i<_target.childNodes.length;i++){var node=_target.childNodes[i];if(node.nodeName=="UL"){ul=node;break}}return ul};wordWheel.getOptionsHTML=function(input,matchText){var startMatchList=[];var partialMatchList=[];wordWheel.ensureElements();_prevSelections=_wwSelections.getElementsByTagName("input");for(var i=0;i<input.length;i++){var friend=input[i];for(var o in friend){var bAlreadySelected=false;if(_prevSelections.length>0){for(var j=0;j<_prevSelections.length;j++){if(_prevSelections[j].value.toUpperCase()==o.toUpperCase()){bAlreadySelected=true}}}if(!bAlreadySelected){for(var zuneTag in friend){if(zuneTag.substr(0,matchText.length).toLowerCase()==matchText.toLowerCase()){startMatchList.push(friend)}else{if(zuneTag.toLowerCase().indexOf(matchText.toLowerCase())!=-1){partialMatchList.push(friend)}}}}}}var html=[];html.push('<ul class="friendsList">');html.push(writeOptionList(startMatchList));html.push(writeOptionList(partialMatchList));html.push("</ul>");return html.join("")};function writeOptionList(friendList){var html=[];var friend;for(var i=0;i<friendList.length;i++){var selected=(i==0)?' selected="selected"':"";friend=friendList[i];for(var zuneTag in friend){html.push("<li"+selected+">");html.push('<span><img src="{0}" title="{1}" alt="" height="32" width="32" /></span>'.format(friend[zuneTag],zuneTag));html.push('<span class="zunetag">{0}</span>'.format(zuneTag));html.push('<input type="hidden" id="hdn_{0}" name="hdn_{0}" value="{0}" />'.format(zuneTag));html.push("</li>")}}return html.join("")}wordWheel.checkEmail=function(src){var regex=/^[a-zA-Z0-9._-]+@([a-zA-Z0-9.-]+\.)+[a-zA-Z0-9.-]{2,4}$/;return regex.test(src)};wordWheel.checkZuneTag=function(zuneTag){var url=URI.serverRoot+"/xweb/lx/frags/validate.ashx?zunetag="+escape(zuneTag);xmlhttp=(window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"));xmlhttp.open("GET",url,false);xmlhttp.setRequestHeader(Ajax.protocol.sourceUrl,window.location.href);xmlhttp.send(null);var json={};try{json=eval("("+xmlhttp.responseText+")")}catch(e){}return json};wordWheel.updateSendToWithUserInput=function(){wordWheel.ensureElements();wordWheel.HideMessage();var inputValRaw="";if(_input&&_input.value){inputValRaw=_input.value.trim()}if(wordWheel.isEmptyInput(inputValRaw)){return true}var invalidTags=new Array();var json=null;inputValList=inputValRaw.split(new RegExp("[;,]"));wordWheel.ShowMessage(LocStr.lxUtilResources.Loading);for(var i=0;i<inputValList.length;i++){var inputVal=inputValList[i].trim();if(inputVal!=""){var tileUrl=_dafaultTile16x16;var isValidInput=false;if(wordWheel.checkEmail(inputVal)||wordWheel.isOnList(inputVal)){isValidInput=true;json=null}else{json=wordWheel.checkZuneTag(inputVal);if(json.msg){wordWheel.ShowMessage(json.msg)}else{if(json.image&&json.image.url){tileUrl=json.image.url;isValidInput=true}}}wordWheel.ensureElements();if(isValidInput){if(!wordWheel.isOnList(inputVal)){var el=wordWheel.addToList(tileUrl,json?json.zuneTag:inputVal);_wwSelections.className=_selectionsCss;_wwSelections.appendChild(el)}}else{invalidTags[invalidTags.length]=inputVal}}}_input.value="";_input.focus();if(0==invalidTags.length){wordWheel.HideMessage();isValidInput=true}else{for(var i=0;i<invalidTags.length;i++){if(i>0){_input.value+="; "}_input.value+=invalidTags[i]}_input.select();isValidInput=false}wordWheel._getWindowOffset(_target,_input);return isValidInput};wordWheel.addToList=function(tileUrl,address){var tmpDiv=document.createElement("div");tmpDiv.id="div_"+address;tmpDiv.className="item";tmpDiv.onmouseover=function(){wordWheel.showRemove(tmpDiv.lastChild)};tmpDiv.onmouseout=function(){wordWheel.hideRemove(tmpDiv.lastChild)};var tmpSpan1=document.createElement("span");var tmpImg=document.createElement("img");tmpImg.alt="";tmpImg.src=tileUrl;tmpImg.height=32;tmpImg.width=32;tmpSpan1.appendChild(tmpImg);var tmpSpan=document.createElement("span");tmpSpan.className="zunetag uEmail";tmpSpan.innerHTML=address;var hiddenInput=document.createElement("input");hiddenInput.type="hidden";hiddenInput.id="hdn_"+address;hiddenInput.name=hiddenInput.id;hiddenInput.value=address;var ancRemoveItem=document.createElement("a");ancRemoveItem.className="wwRemoveItem";ancRemoveItem.setAttribute("href","#");ancRemoveItem.onclick=function(){wordWheel.removeFromSendTo(ancRemoveItem.parentNode);return false};ancRemoveItem.innerHTML=_removeSymbol;tmpDiv.appendChild(tmpSpan1);tmpDiv.appendChild(tmpSpan);tmpDiv.appendChild(hiddenInput);tmpDiv.appendChild(ancRemoveItem);return tmpDiv};wordWheel.isOnList=function(recipient){wordWheel.ensureElements();var rec=recipient.toLowerCase();var arrSelectionSpans=_wwSelections.getElementsByTagName("span");if(arrSelectionSpans){for(var i=0;i<arrSelectionSpans.length;i++){if(rec==arrSelectionSpans[i].innerHTML.toLowerCase()){return true}}}return false};wordWheel.showRemove=function(obj){if(obj){obj.style.display="inline"}};wordWheel.hideRemove=function(obj){if(obj){obj.style.display="none"}};wordWheel.removeFromSendTo=function(obj){if(_wwSelections){_wwSelections.removeChild(obj);_wwSelections.className=(_wwSelections.childNodes.length<1)?_selectionsCssHide:_selectionsCss}};wordWheel.updateSendTo=function(wwItem){wordWheel.HideMessage();if(wwItem>-1&&_itemCount>0){var list=wordWheel.getOptions();if(list==null||list.childNodes==null){return}var selected=list.childNodes[wwItem];var tmpDiv=document.createElement("div");tmpDiv.className="item";tmpDiv.onmouseover=function(){this.lastChild.style.display="inline"};tmpDiv.onmouseout=function(){wordWheel.hideRemove(tmpDiv.lastChild)};var ancRemoveItem=document.createElement("a");ancRemoveItem.className="wwRemoveItem";ancRemoveItem.onclick=function(){wordWheel.removeFromSendTo(ancRemoveItem.parentNode)};ancRemoveItem.innerHTML=_removeSymbol;var numOfNodes=selected.childNodes.length;for(var i=0;i<numOfNodes;i++){if(selected.childNodes[i]){tmpDiv.appendChild(selected.childNodes[i].cloneNode(true))}}tmpDiv.appendChild(ancRemoveItem);wordWheel.ensureElements();if(_wwSelections){_wwSelections.className="clearBoth clearfix";_wwSelections.appendChild(tmpDiv)}if(_input){_input.value=""}wordWheel._getWindowOffset(_target,_input)}};wordWheel.handleDefaultSelection=function(){if(!wordWheel._wwRecipientList){return""}var html=[];var zuneTagself=_zuneTagSelf.toLowerCase();for(var i=0;i<wordWheel._wwRecipientList.length;i++){recipient=wordWheel._wwRecipientList[i];for(var o in recipient){if(zuneTagself!=o.toLowerCase()){html.push(renderDefaultRecipient(o,recipient[o]))}}}return html.join("")};function renderDefaultRecipient(zuneTag,tile){var html=[];html.push('<div class="item" onmouseover="wordWheel.showRemove(this.lastChild)" onmouseout="wordWheel.hideRemove(this.lastChild)">');html.push('<span><img src="{0}" title="{1}" alt="" height="32" width="32" /></span>'.format(tile,zuneTag));html.push('<span class="zunetag">{0}</span>'.format(zuneTag));html.push('<input type="hidden" id="hdn_{0}" name="hdn_{0}" value="{0}" />'.format(zuneTag));html.push("</div>");return html.join("")}wordWheel.submitMessage=function(){wordWheel.HideMessage();wordWheel.checkMsgLen();var url="/xweb/lx/frags/sendmessage.ashx";var _messageEl=document.getElementById("message");var message=(_messageEl&&_messageEl.value)?_messageEl.value.trim():"";if(!wordWheel.updateSendToWithUserInput()){return false}targets=wordWheel.getRecipients().join(",");var callback=function(status,response){wordWheel.HideMessage();if(_returnUrl&&_returnUrl.length>0){window.location=_returnUrl}else{popup.hide()}};var getRequestBody=function(){return{type:_messageType,messageSource:_messageSource,zunetag:_zuneTag,mediaid:_messageMediaId,podcasturl:_podcastUrl,podcastmediaid:_podcastMediaId,podcastname:_podcastName,podcastepisodename:_podcastEpisodeName,text:message,recipients:targets}};if(targets.length<1){wordWheel.ShowMessage(LocStr.lxUtilResources.SendErrorNoRecipient);if(_input){_input.focus();_input.select()}}else{if(message==""&&_messageEl){wordWheel.ShowMessage(LocStr.lxUtilResources.SendErrorNoMessage);_messageEl.focus()}else{var body=getRequestBody();wordWheel.ShowMessage(LocStr.lxUtilResources.Sending);Ajax.PostAsync(url,body,_messageEl,callback,url)}}return false};wordWheel.getRecipients=function(){var users=[];wordWheel.ensureElements();if(_wwSelections){var selections=_wwSelections.getElementsByTagName("input");for(var i=0;i<selections.length;i++){var val=selections[i].value;if(val){users.push(val.toLowerCase())}}}return users};wordWheel.selWwItem=function(wwItem){var list=wordWheel.getOptions();if(!list){return}if(list.childNodes.length>0){if(_prevIdx>=0){var prev=list.childNodes[_prevIdx];if(!prev.className){prev.className=""}prev.className=prev.className.replace(/ *selected/,"")}if(wwItem>=0){if(list.childNodes.length>0){var cur=list.childNodes[wwItem];cur.className=cur.className+" selected"}_prevIdx=wwItem}}};wordWheel.ensureElements=function(){_input=document.getElementById("wwInput");_wwContainer=document.getElementById("wordwheelContainer");_wwContent=document.getElementById("wwContent");_wwSelections=document.getElementById("wwSelections")};wordWheel.findPosX=function(obj){var curleft=0;if(obj.offsetParent){while(1){if(obj.style.position!="absolute"){curleft+=obj.offsetLeft}if(!obj.offsetParent){break}obj=obj.offsetParent}}else{if(obj.x){curleft+=obj.x}}return curleft};wordWheel.findPosY=function(obj){var curtop=0;if(obj.offsetParent){while(1){if(obj.style.position!="absolute"){curtop+=obj.offsetTop}if(!obj.offsetParent){break}obj=obj.offsetParent}}else{if(obj.y){curtop+=obj.y}}return curtop}}wordWheel();var messageDetailsDivID="messageDetailsDiv";var msgHiddenInputName="msgHiddenInput";var inboxBodyDivID="inboxBodyDiv";var curMessageNode=null;function GetMessageListUID(){return curMessageNode.parentNode.parentNode.attributes.name.value}function GetMessageListCID(){return curMessageNode.parentNode.parentNode.id}function MessageInfo_WriteUserCard(d,h,j){d=d||"";var b=getEl("userCardWrapper");var o="cardDiv_";if(b){var l=b.getAttribute("ver");var a=b.getElementsByTagName("DIV");var c=null;var g=o+d;for(var f=0;f<a.length;f++){if(a[f].id==g){c=a[f];css.remove(a[f],"hide")}else{css.add(a[f],"hide")}}if(d&&!c){c=document.createElement("DIV");c.id=g;b.appendChild(c);var k=new Flash(h+"?"+l,"zuneCard","250","135","9");var m="/zcard/usercardservice.ashx%3Fzunetag%3D{0}%26lcid%3D{1}%26src%3D{2}".format(escape(d),j,"medium");k.addParam("wmode","opaque");k.addParam("salign","tl");k.addVariable("baseURL",m);k.write(g);setFlashObj()}}return false}function MessageInfo_Onclick(g,c){g=g||window.event;var f=g.srcElement||g.target;if(f.getAttribute("name")=="_checkbox"){return}if(curMessageNode==c.parentNode){return}HideBuyButton();MessageInfo_WriteUserCard("");PrepareForUpdate(messageDetailsDivID);var b="/my/MessageDetailsFrag.aspx?msgid="+c.getAttribute("msgID");var a=Ajax.FragmentHttpGet(b,messageDetailsDivID,messageDetailsDivID);if(a){UpdateCurrentMessage(c);var h="<div class='LxMessageDetails'><h5>{Loading}</h5></div>";var d={Loading:LocStr.lxUtilResources.Loading};setElementHTML(messageDetailsDivID,h.expandTokens(d))}return false}function SetCurrentMessage(){var b="";curMessageNode=null;var a=document.getElementsByName(msgHiddenInputName);if(a&&a[0]){a=a[0];b=a.getAttribute("msgid");messageArray=document.getElementsByName("messageSummary_"+b);for(i=0;i<messageArray.length;i++){if(messageArray[i].parentNode.getAttribute("messageid")==b){UpdateCurrentMessage(messageArray[i]);break}}}}function UpdateCurrentMessage(a){if(curMessageNode){css.remove(curMessageNode,"LxCurrentMessageItem")}curMessageNode=a.parentNode;css.add(curMessageNode,"LxCurrentMessageItem");css.remove(curMessageNode,"LxUnreadMessageItem");HideBuyButton()}function Inbox_SelectAll(){var b=document.getElementsByName("_checkbox");for(var a=0;a<b.length;a++){b[a].checked=true}}function Inbox_DeselectAll(){var b=document.getElementsByName("_checkbox");for(var a=0;a<b.length;a++){b[a].checked=false}}function Inbox_BlockSelectedSenders(c,f){var d=IsBlockSysSender();if(d){popup.show(blockSysSenderPopup);return false}var a=GetSelectedMsgIDs();if(a!=""){var b="/my/MessageListFrag.aspx?block=true&delete=true&msgids="+a;PrepareForUpdate(f);Ajax.FragmentPostBack(b,c,f,c);curMessageNode=null;HideBuyButton()}}function Inbox_DeleteSelectedMessages(b,c){var a=GetSelectedMsgIDs();DeleteMessages(a,b,c)}function MessageDetails_DeleteCurrentMessage(b){var a=GetMessageListUID();var c=GetMessageListCID();DeleteMessages(b,a,c)}function DeleteMessages(a,c,d){if(a!=""){var b="/my/MessageListFrag.aspx?block=false&delete=true&msgids="+a;PrepareForUpdate(d);Ajax.FragmentPostBack(b,c,d,c);curMessageNode=null;HideBuyButton()}}function IsBlockSysSender(){var c=document.getElementsByName("_checkbox");var b=false;for(var a=0;a<c.length;a++){if(c[a].checked==true){if("true"==c[a].parentNode.parentNode.getAttribute("isSysSender")){b=true;break}}}return b}function GetSelectedMsgIDs(){var a="";var d=true;var c=document.getElementsByName("_checkbox");for(var b=0;b<c.length;b++){if(c[b].checked==true){if(d==false){a+=","}a+=c[b].parentNode.parentNode.getAttribute("messageID");d=false}}return a}function Inbox_AcceptFriendRequest(a){var d=document.getElementsByName(msgHiddenInputName);var c="";if(d&&d[0]){d=d[0];c=d.getAttribute("sender");var b="/my/MessageDetailsFrag.aspx?friend=accept&sender="+c;PrepareForUpdate(messageDetailsDivID);Ajax.FragmentPostBack(b,messageDetailsDivID,messageDetailsDivID,messageDetailsDivID);curMessageNode=null;RemoveMessageFromList(a)}}function Inbox_DeclineFriendRequest(a){var d=document.getElementsByName(msgHiddenInputName);var c="";if(d&&d[0]){d=d[0];c=d.getAttribute("sender");var b="/my/MessageDetailsFrag.aspx?friend=decline&sender="+c;PrepareForUpdate(messageDetailsDivID);Ajax.FragmentPostBack(b,messageDetailsDivID,messageDetailsDivID,messageDetailsDivID);curMessageNode=null;RemoveMessageFromList(a)}}function RemoveMessageFromList(a){messageArray=document.getElementsByName("messageSummary_"+a);for(i=0;i<messageArray.length;i++){if(messageArray[i].parentNode.getAttribute("messageId")==a){css.add(messageArray[i].parentNode,"LxInvalidMessage");break}}}function updateNewMessageCount(f){var c=getEl("zuneCardShell");if(c!=null){var a=c.getElementsByTagName("A");for(var b=0;b<a.length;b++){var d=a[b];if(d.id=="unreadCount"){d.innerHTML=f}}}}function PrepareForUpdate(b){Trigger.myNewMsgCount.subscribe(updateNewMessageCount);var a=getEl(b);a.LxOnAjaxStart=function(){};a.LxOnAjaxFinish=function(d,g){var f=g.httpRequest;var c=f.getResponseHeader("lx-msgs-unread");if(c){Trigger.myNewMsgCount.update(c)}}}function purchaseMedia(b,a,c){if(a){location.href=b}else{if(Auth.validateTicket()){if(c.length==0){lxShowIFrame(b)}else{lxConfirm(c,"lxShowIFrame('"+b+"');")}}}return false}var currentCulture;function purchase(f,d){$("#divLoading").show();$("#lnkGroup").hide();var a,c,g;if($("#highDefinition")[0].checked){a=currentCulture.hdOfferId;c=currentCulture.hdPointsPriceWithoutUnit;g=currentCulture.contentAvailableForHD}if($("#standardDefinition")[0].checked){a=currentCulture.sdOfferId;c=currentCulture.sdPointsPriceWithoutUnit;g=currentCulture.contentAvailableForSD}var b=d+"&offerId="+a+"&pointsPrice="+c+"&contentType="+g;zAjax.post(b,"",{},function(h,j){location.href=h})}function SetDynamicData(a){$("#spMsPoints").text(a=="hd"?currentCulture.hdPointsPrice:currentCulture.sdPointsPrice);$("#spMediaDesc").text(a=="hd"?currentCulture.mediaDescForHD:currentCulture.mediaDescForSD);toggleTunersDisplay($("#liRenderPC"),(a=="hd")?currentCulture.renderPCForHD:currentCulture.renderPCForSD);toggleTunersDisplay($("#liRenderZune"),(a=="hd")?currentCulture.renderZuneForHD:currentCulture.renderZuneForSD);toggleTunersDisplay($("#liRenderXbox"),(a=="hd")?currentCulture.renderXBoxForHD:currentCulture.renderXBoxForSD)}function refreshUI(a){currentCulture=window[a];if(currentCulture.hdEnabled=="0"&&currentCulture.sdEnabled=="0"){$("#lnkSave").hide()}else{$("#lnkSave").show()}if(currentCulture.hdEnabled=="0"){$("#highDefinition").attr("disabled","disabled");$("#highDefinition").attr("checked",false);$("#lblHighDefinition").addClass("gray")}else{$("#highDefinition").attr("disabled","");$("#highDefinition").attr("checked",true);$("#lblHighDefinition").removeClass("gray");SetDynamicData("hd")}if(currentCulture.sdEnabled=="0"){$("#standardDefinition").attr("disabled","disabled");$("#standardDefinition").attr("checked",false);$("#lblStandardDefinition").addClass("gray")}else{$("#standardDefinition").attr("disabled","");$("#lblStandardDefinition").removeClass("gray");if(currentCulture.hdEnabled=="0"){$("#standardDefinition").attr("checked",true);SetDynamicData("sd")}}$("#lblStandardDefinition").text(currentCulture.standardDefinition);$("#lblHighDefinition").text(currentCulture.highDefinition);if(currentCulture.hasPurchasedText==""){$(".hasPurchasedText").hide()}else{$(".hasPurchasedText").show();$(".hasPurchasedText").text(currentCulture.hasPurchasedText)}$("#spMediaDesc").text(currentCulture.mediaDesc)}function toggleTunersDisplay(b,a){if(a=="0"){b.hide()}else{b.show()}}function initUI(){if($("#drpLanguage").length>0){refreshUI($("#drpLanguage").val())}else{refreshUI($("#lblLanguage").attr("value"))}}($Hero=function(){var a=$Hero,b={share:function(d){if(d){sendWrapper2(d,$("body").hasClass("SignedIn"))}},follow:function(f){if(f){var d={mid:f.split(":")[0],hasFollowed:false,disappear:true};tryFollowing(d,function(g){if(g.status=="succeeded"){}else{if(g.status=="outOfLimit"){lxAlert(g.msg)}}})}},mixView:function(j){if(j){j=j.split(":");var m=ZunePageData,d="/xweb/lx/xap/MixView.xap?"+m.AppVersionQueryString,l=j[1],g=(j[1]=="artist"?j[0]:""),f=(j[1]=="album"?j[0]:""),h=['{"metadata":{"zune":{"webbase":"',m.zuneurl,'"},"socialapi":{"webbase":"',m.socialurl,'"}, "catalog": { "webbase":"',m.catalog,'"}},"album":{"id":"',f,'"},"artist":{"id":"',g,'"},"profile":{"zuneTag":""}}'].join(""),h=h.encodeHtml().replace(/\,/g,"%2c");mixviewInfo=["displayObject=",j[1],",json=",h].join("");try{popup.showMixview(mixviewInfo,d)}catch(k){}}},play:function(f){if(f){f=f.split(":");var d=f.length==4?f[3]:"";AudioPlayerPlayMedia(f[0]+";"+f[1]+";"+d)}},queue:function(f){if(f){f=f.split(":");var d=f.length==4?f[3]:"";AudioPlayerAddSongsToQueue(f[0]+";"+f[1]+";"+d)}}};for(var c in b){a[c]=b[c];window["Hero_"+c]=b[c]}})();function validateUserComment(f,b){var a=$("#"+f);var c=$("#"+b);var d=a.val().trim();if(!d){c.show();a.focus();return false}return true}function submitUserComment(f,b,d,c){if(validateUserComment(f,b)){var a=$("#"+f);a.val(a.val().encodeHtml2());SpringLoader.CloseAndSubmit(d,c)}return false}$(function(){UserCommentInit()});function UserCommentInit(){$(".Comments .Content").each(function(){more.truncate(this,500,5)});var a=$(".UserComments textarea").attr("id");SpringLoader.FocusOnReveal(a+"_txtComment");ProcessTimes()}function SetRedirectPref(a,b){Cookie.set("ZCI",a,2629743,null,"/",null);window.location=b.href}var purchaseMusicCookieExpiration=2*365*24*60*60;var purchaseHistoryUrl="/my/purchase";function createOrder(j,h,g,b,c){if(c&&"disabled"!=$(c).attr("disabled")){var f="/music/Purchase.ashx";var a=document.referrer;var d={type:"POST",url:f,dataType:"json",async:true,data:{mid:j,mtype:h,pttype:g,ptinstid:b,backurl:a},beforeSend:function(k){k.setRequestHeader(zAjax.protocol.sourceUrl,window.location.href)},success:function(m,p,o){var k=o.getResponseHeader(zAjax.protocol.authUrl);if(k){parent.top.location.href=k;return}var l=o.getResponseHeader(zAjax.protocol.redirect);if(l){parent.top.location.href=l;return}showError({hide:["#dtoconfirmpurchase"],show:["#dtoerror"]})},error:function(o,p,m){var k=o.getResponseHeader(zAjax.protocol.authUrl);if(k){parent.top.location.href=k;return}var l=o.getResponseHeader(zAjax.protocol.redirect);if(l){parent.top.location.href=l;return}showError({hide:["#dtoconfirmpurchase"],show:["#dtoerror"]})}};$(".dtobuybutton a").attr("disabled","disabled");$(".dtocancelbutton a").attr("disabled","disabled");$(".PurchaseMusicDropList select").attr("disabled","disabled");$(".dtobuybutton").removeClass("NormalBright").addClass("NormalDark");$.ajax(d)}return false}function showError(b){if(b.hide&&b.hide.length){for(var a=0;a<b.hide.length;a++){$(b.hide[a]).hide()}}if(b.show&&b.show.length){for(var a=0;a<b.show.length;a++){$(b.show[a]).show()}}}function hideError(a){$(".dtobuybutton").addClass("NormalBright").removeClass("NormalDark");$(".PurchaseMusicDropList select").removeAttr("disabled");$(".dtocancelbutton a").removeAttr("disabled");$(".dtobuybutton a").removeAttr("disabled");showError({hide:["#dtoerror"],show:["#dtoconfirmpurchase"]})}function onchangePaymentType(a){$("div[ id *= 'dtoaction' ]").hide();$("div[ id *= 'dtowarning' ]").hide();$("div[ id *= 'dtoprice' ]").hide();$("div[ id *= 'dtotracklistpointspi' ]").hide();$("#dtoaction"+a).show();if(a.indexOf("creditcardpi")!=-1){$("#dtowarningcreditcardpi").show();$("#dtopricecreditcardpi").show()}else{if(a.indexOf("pointspi")!=-1){$("#dtowarningpointspi").show();$("#dtopricepointspi").show();$("#dtotracklistpointspi").show()}}return true}$Downloadbutton=function(){var f=".jsDownloadbtn",d="click",a=200,b=null,c=1;var g=fn={init:function(h){h?g.ready(null,h):$(document).ready(g.ready)},ready:function(j,k){k=k||document.body;var h=$(f,k);h.each(function(){var l=$(this);l.bind((d),g.click)})},click:function(m){var l=$(m.currentTarget);var o="height=240,width=650,status=no,toolbar=no,directories=no,menubar=no,location=no,resizable=no,scrollbars=no,titlebar=no,channelmode=no";if(l.length>0){var j=l.attr("target"),k=l.attr("pageindex"),h=l.attr("index");if(window.refreshPHTimer){window.clearTimeout(window.refreshPHTimer)}window.refreshPHTimer=window.setTimeout('window.location.href="/Purchase/History?PageIndex='+g.pageindex+'";',20000);window.open(j,k+"_"+h,o)}}};return fn};new $Downloadbutton().init();function showDownloadError(){var a=getEl("dtoDownloadError");popup.injectFrag(a.innerHTML)}function smartDJSearchAutoComplete(){var a=[];a.push('<div id="LxSmallArtistName{0}" class="LxSmallArtistWrapper">');a.push('<div class="LxSmallArtistImage"><img alt="" src="{1}"/></div>');a.push('<div class="LxSmallArtistTitle">{2}</div>');a.push("</div>");var b=a.join("");$("#smartDJSearch").autocomplete("/music/LxGetArtistListHandler.ashx",{minChars:2,max:5,selectFirst:true,scroll:false,formatItem:function(f,c,h,d){if(c==1){hideSmartDJError()}var g;g=b.replace(/\{0\}/g,f[0].replace(/ /g,"_").replace(/\./g,"_"));g=g.replace(/\{1\}/g,f[1]);g=g.replace(/\{2\}/g,f[0]);return g},formatResult:function(d,c){return d[0]}}).result(function(c,f,d){if(f){smartDJSearchAutoComplete.aname=f[0];smartDJSearchAutoComplete.aid=f[2];smartDJSearchAutoComplete.playtype=f[3];hideSmartDJError();return f[0]}else{showSmartDJError();smartDJSearchAutoComplete.aname=null}})}function addSmartDJ(b){var a=$("#smartDJSearch")[0].value;if(a.length==0){showSmartDJError();return false}if(a==smartDJSearchAutoComplete.aname){hideSmartDJError();AudioPlayerPlayMedia(smartDJSearchAutoComplete.aid+";"+smartDJSearchAutoComplete.playtype)}else{showSmartDJError();return false}}function showSmartDJError(){$(".noSmartDJResults")[0].style.display="block"}function hideSmartDJError(){$(".noSmartDJResults")[0].style.display="none"}function ClearSmartDJSearchBox(a){a.value="";a.onfocus=null}zdlm={settings:{source:"/xweb/lx/xap/zdlm.xap",installerPathWin:"zdlm.msi",installerPathMac:"zdlm.mpkg",installerPathLinux:"",parentElement:"zdlmHost",protocol:"zdlm://",id:"zdlmObj",height:0,width:0,background:"transparent",windowless:"true",allowHtmlPopupWindow:"true",enableHtmlAccess:"true",enableNavigation:"true",autoUpgrade:"false",version:"4.0.51204.0",alt:"<!--not installed-->",initParams:{embedding:"DTO"},events:{},context:null,installTimerDelay:5000,create:false,errorUrl:null,autoLaunch:false,callback:null},launched:false,mac:/mac/i.test(navigator.platform),win:/win/i.test(navigator.platform),linux:/linux/.test(navigator.platform),installTimer:null,States:{unloaded:"unloaded",loaded:"loaded",installed:"installed",installing:"installing",error:"error",notsupported:"notsupported"},state:null,links:function(a){switch(a){case zdlm.States.unloaded:case zdlm.States.loaded:$(".zdlmInstalling").hide();$(".zdlmInstalled").hide();$(".zdlmInstall").show();$(".zdlmDetection").hide();$(".zdlmError").hide();$(".zdlmNotSupported").hide();break;case zdlm.States.installed:$(".zdlmInstalling").hide();$(".zdlmInstalled").show();$(".zdlmInstall").hide();$(".zdlmDetection").hide();$(".zdlmError").hide();$(".zdlmNotSupported").hide();break;case zdlm.States.installing:$(".zdlmInstalling").show();$(".zdlmInstalled").hide();$(".zdlmInstall").hide();$(".zdlmDetection").hide();$(".zdlmError").hide();$(".zdlmNotSupported").hide();break;case zdlm.States.error:$(".zdlmInstalling").hide();$(".zdlmInstalled").hide();$(".zdlmInstall").hide();$(".zdlmDetection").hide();$(".zdlmError").show();$(".zdlmNotSupported").hide();break;case zdlm.States.notsupported:$(".zdlmInstalling").hide();$(".zdlmInstalled").hide();$(".zdlmInstall").hide();$(".zdlmDetection").hide();$(".zdlmError").hide();$(".zdlmNotSupported").show();break;default:$(".zdlmInstalling").hide();$(".zdlmInstalled").hide();$(".zdlmInstall").hide();$(".zdlmDetection").show();$(".zdlmError").hide();$(".zdlmNotSupported").hide();break}},install:function(){if(zdlm.win){window.location.href=decodeURIComponent(zdlm.settings.installerPathWin);zdlm.installing()}else{zdlm.update(zdlm.States.notsupported)}},launch:function(){if(zdlm.settings.protocol){window.location.href=zdlm.settings.protocol+$.base64Encode(encodeURI(window.location.href));zdlm.launched=true}else{zdlm.update(zdlm.States.error)}},clearInstallTimer:function(){if("undefined"!=typeof(zdlm.settings.initParams.install)){delete (zdlm.settings.initParams.install)}if(window.installTimer){window.clearInterval(window.installTimer)}},bindButtons:function(){if(zdlm.settings.errorUrl){$(".zdlmError a").attr("href",zdlm.settings.errorUrl);$(".zdlmError a").attr("target","_top")}else{$(".zdlmError a").click(function(){window.location.reload(true)});$(".zdlmError a").dblclick(function(){window.location.reload(true)})}$(".zdlmNotSupported a").click(function(){window.location.reload(true)});$(".zdlmNotSupported a").dblclick(function(){window.location.reload(true)});$(".zdlmInstalling a").attr("href",decodeURIComponent(zdlm.settings.installerPathWin));$(".zdlmInstalling a").attr("target","_top");$(".zdlmInstalling a").click(function(){if(zdlm.win){zdlm.installing()}else{zdlm.update(zdlm.States.notsupported)}});$(".zdlmInstalling a").dblclick(function(){if(zdlm.win){zdlm.installing()}else{zdlm.update(zdlm.States.notsupported)}});$(".zdlmInstalled a").attr("href",zdlm.settings.protocol+$.base64Encode(encodeURI(window.location.href)));$(".zdlmInstalled a").attr("target","_top");$(".zdlmInstall a").attr("href",decodeURIComponent(zdlm.settings.installerPathWin));$(".zdlmInstall a").attr("target","_top");$(".zdlmInstall a").click(function(){if(zdlm.win){zdlm.installing()}else{zdlm.update(zdlm.States.notsupported)}});$(".zdlmInstall a").dblclick(function(){if(zdlm.win){zdlm.installing()}else{zdlm.update(zdlm.States.notsupported)}})},createHost:function(){if($("div#"+zdlm.settings.parentElement).size()<1){$("body").append('<div id="'+zdlm.settings.parentElement+'" style="width:'+zdlm.settings.width+";height:"+zdlm.settings.height+';"></div>')}else{$("div#"+zdlm.settings.parentElement).width(zdlm.settings.width).height(zdlm.settings.height).html("")}},create:function(a){zdlm.createHost();zdlm.bindButtons();if("object"==typeof(a)){jQuery.extend(true,zdlm.settings,{events:{onLoad:zdlm.onSLLoad,onError:zdlm.onSLError}},a)}zdlm.createObject()},reload:function(){zdlm.createObject()},ready:function(){if(zdlm.state==zdlm.States.loaded){return true}else{return false}},installing:function(){zdlm.clearInstallTimer();var a={install:true};jQuery.extend(true,zdlm.settings.initParams,a);zdlm.update(zdlm.States.installing);window.installTimer=window.setInterval("zdlm.reload();",zdlm.settings.installTimerDelay)},update:function(b,a){if(b&&zdlm.States[b]){if((b==zdlm.States.unloaded||b==zdlm.States.loaded)&&("undefined"!=typeof(zdlm.settings.initParams.install))){b=zdlm.States.installing}if(b!=zdlm.state){zdlm.state=b;switch(zdlm.state){case zdlm.States.installed:zdlm.clearInstallTimer();if(zdlm.settings.autoLaunch&&!zdlm.launched){window.setTimeout("zdlm.launch();",1000)}break;case zdlm.States.error:if(a){throw new Error(a)}break}if(zdlm.settings.callback&&typeof zdlm.settings.callback=="function"){zdlm.settings.callback(b)}}zdlm.links(b)}return zdlm.state},onSLLoad:function(b,a,c){if(b.object.IsLoaded){zdlm.update(zdlm.States.loaded)}},onSLError:function(c,a){zdlm.update(zdlm.States.error);var b="";if(c!=null&&c!=0){b=c.getHost().Source}var g=a.ErrorType;var d=a.ErrorCode;if(g=="ImageError"||g=="MediaError"){return}var f="Unhandled Error in Silverlight Application "+b+" \n";f+="Code: "+d+" \n";f+="Category: "+g+" \n";f+="Message: "+a.ErrorMessage+" \n";if(g=="ParserError"){f+="File: "+a.xamlFile+" \n";f+="Line: "+a.lineNumber+" \n";f+="Position: "+a.charPosition+" \n"}else{if(g=="RuntimeError"){if(a.lineNumber!=0){f+="Line: "+a.lineNumber+" \n";f+="Position: "+a.charPosition+" \n"}f+="MethodName: "+a.methodName+" \n"}}throw new Error(f)},serializeInitParams:function(c){var a=new Array();if("object"==typeof(c)){for(var b in c){a.push(""+b+"="+c[b])}}return a.join(",")},createObject:function(){if(Silverlight){if(Silverlight.isInstalled(zdlm.settings.version)){try{Silverlight.createObjectEx({source:decodeURIComponent(zdlm.settings.source),parentElement:document.getElementById(zdlm.settings.parentElement),id:zdlm.settings.id,properties:{width:zdlm.settings.width,height:zdlm.settings.height,background:zdlm.settings.background,windowless:zdlm.settings.windowless,allowHtmlPopupWindow:zdlm.settings.allowHtmlPopupWindow,enableHtmlAccess:zdlm.settings.enableHtmlAccess,enableNavigation:zdlm.settings.enableNavigation,autoUpgrade:zdlm.settings.autoUpgrade,version:zdlm.settings.version,alt:zdlm.settings.alt},events:zdlm.settings.events,initParams:zdlm.serializeInitParams(zdlm.settings.initParams),context:zdlm.settings.context});return true}catch(a){zdlm.update(zdlm.States.error)}}else{zdlm.update(zdlm.States.unloaded)}}else{zdlm.update(zdlm.States.unloaded)}return false}};$(document).ready(function(){if("object"==typeof(zdlm)&&zdlm.settings.create){zdlm.create()}});function zdlmUpdateState(b,a){zdlmState=null;for(zdlmState in zdlm.States){if(b==zdlm.States[zdlmState]){break}}zdlm.update(zdlmState,a)}function zdlmLaunch(){if(zdlm.ready()){zdlm.launch()}};